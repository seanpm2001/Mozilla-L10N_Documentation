<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Localization at Mozilla - Internal Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="products/android-l10n/index.html"><strong aria-hidden="true">2.</strong> Android-l10n</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="products/android-l10n/adding_projects.html"><strong aria-hidden="true">2.1.</strong> Adding projects</a></li><li class="chapter-item expanded "><a href="products/android-l10n/updating_locales.html"><strong aria-hidden="true">2.2.</strong> Updating locales</a></li><li class="chapter-item expanded "><a href="products/android-l10n/review_android_strings.html"><strong aria-hidden="true">2.3.</strong> Reviewing new strings</a></li><li class="chapter-item expanded "><a href="products/android-l10n/removing_projects.html"><strong aria-hidden="true">2.4.</strong> Removing projects</a></li></ol></li><li class="chapter-item expanded "><a href="products/firefox_desktop/index.html"><strong aria-hidden="true">3.</strong> Firefox Desktop</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="products/firefox_desktop/adding_pontoon.html"><strong aria-hidden="true">3.1.</strong> Add to Pontoon</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/adding_nightly.html"><strong aria-hidden="true">3.2.</strong> Nightly builds</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/adding_release.html"><strong aria-hidden="true">3.3.</strong> Beta/Release builds</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/setup_searchplugins.html"><strong aria-hidden="true">3.4.</strong> Searchplugins</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/removing_locales.html"><strong aria-hidden="true">3.5.</strong> Removing locales</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/review.html"><strong aria-hidden="true">3.6.</strong> Review strings</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/fluent_migrations.html"><strong aria-hidden="true">3.7.</strong> Fluent migrations</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/build_system.html"><strong aria-hidden="true">3.8.</strong> Build system</a></li><li class="chapter-item expanded "><a href="products/firefox_desktop/firefox_l10n_faqs.html"><strong aria-hidden="true">3.9.</strong> L10N FAQs</a></li></ol></li><li class="chapter-item expanded "><a href="localization/index.html"><strong aria-hidden="true">4.</strong> Localization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="localization/making_string_changes.html"><strong aria-hidden="true">4.1.</strong> Change existing strings</a></li><li class="chapter-item expanded "><a href="localization/dev_best_practices.html"><strong aria-hidden="true">4.2.</strong> Best practices for developers</a></li><li class="chapter-item expanded "><a href="localization/globalization_best_practices.html"><strong aria-hidden="true">4.3.</strong> Globalization best practices for product managers</a></li></ol></li><li class="chapter-item expanded "><a href="products/iOS_products/index.html"><strong aria-hidden="true">5.</strong> iOS Products</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="products/iOS_products/updating_locales.html"><strong aria-hidden="true">5.1.</strong> Updating locales</a></li><li class="chapter-item expanded "><a href="products/iOS_products/review_iOSstrings.html"><strong aria-hidden="true">5.2.</strong> Reviewing new strings</a></li></ol></li><li class="chapter-item expanded "><a href="products/other/index.html"><strong aria-hidden="true">6.</strong> Other Projects</a></li><li class="chapter-item expanded "><a href="tools/pontoon/index.html"><strong aria-hidden="true">7.</strong> Pontoon</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tools/pontoon/adding_new_project.html"><strong aria-hidden="true">7.1.</strong> New project</a></li><li class="chapter-item expanded "><a href="tools/pontoon/renaming_a_project.html"><strong aria-hidden="true">7.2.</strong> Renaming a project</a></li><li class="chapter-item expanded "><a href="tools/pontoon/adding_new_short_term_project.html"><strong aria-hidden="true">7.3.</strong> New short-term project</a></li><li class="chapter-item expanded "><a href="tools/pontoon/adding_new_locale.html"><strong aria-hidden="true">7.4.</strong> New locale</a></li><li class="chapter-item expanded "><a href="tools/pontoon/managing_pretranslation.html"><strong aria-hidden="true">7.5.</strong> Pretranslation</a></li><li class="chapter-item expanded "><a href="tools/pontoon/sending_notifications.html"><strong aria-hidden="true">7.6.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="tools/pontoon/renaming_a_file.html"><strong aria-hidden="true">7.7.</strong> Renaming a localization file</a></li><li class="chapter-item expanded "><a href="tools/pontoon/deactivating_users.html"><strong aria-hidden="true">7.8.</strong> Deactivating users</a></li><li class="chapter-item expanded "><a href="tools/pontoon/removing_users.html"><strong aria-hidden="true">7.9.</strong> Removing users</a></li><li class="chapter-item expanded "><a href="tools/pontoon/adding_new_terminology.html"><strong aria-hidden="true">7.10.</strong> New terminology</a></li></ol></li><li class="chapter-item expanded "><a href="tools/mercurial/index.html"><strong aria-hidden="true">8.</strong> Mercurial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tools/mercurial/setting_mercurial_environment.html"><strong aria-hidden="true">8.1.</strong> Set up the environment</a></li><li class="chapter-item expanded "><a href="tools/mercurial/creating_mercurial_patch.html"><strong aria-hidden="true">8.2.</strong> Create a patch</a></li><li class="chapter-item expanded "><a href="tools/mercurial/useful_mercurial_commands.html"><strong aria-hidden="true">8.3.</strong> Useful Mercurial commands</a></li></ol></li><li class="chapter-item expanded "><a href="misc/index.html"><strong aria-hidden="true">9.</strong> Other docs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="misc/creating_new_repository.html"><strong aria-hidden="true">9.1.</strong> New l10n repository</a></li><li class="chapter-item expanded "><a href="misc/working_w_l10n_agency.html"><strong aria-hidden="true">9.2.</strong> How to work with a Localization Agency</a></li><li class="chapter-item expanded "><a href="misc/documentation_styleguide.html"><strong aria-hidden="true">9.3.</strong> Documentation styleguide</a></li><li class="chapter-item expanded "><a href="misc/stock_emails.html"><strong aria-hidden="true">9.4.</strong> Stock emails</a></li><li class="chapter-item expanded "><a href="misc/terminology_export.html"><strong aria-hidden="true">9.5.</strong> Exporting terminology</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Localization at Mozilla - Internal Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="l10n-drivers-documentation"><a class="header" href="#l10n-drivers-documentation">L10n-drivers Documentation</a></h1>
<p>This repository includes several documents describing how to perform internal tasks within the <a href="https://wiki.mozilla.org/L10n:Mozilla_Team">l10n-drivers team</a> at Mozilla.</p>
<p>Topics covered:</p>
<ul>
<li>How to <a href="products/firefox_desktop/review.html">review strings</a> for Firefox desktop.</li>
<li>Manage <a href="products/other/">other projects</a> (Firefox Monitor, VPN Client).</li>
<li>Perform common and advanced tasks on <a href="tools/pontoon/">Pontoon</a> like adding new locale, and creating a new project.</li>
<li>Other <a href="misc/">miscellaneous documents</a> related to localization tasks.</li>
</ul>
<h2 id="how-to-read-these-documents"><a class="header" href="#how-to-read-these-documents">How to read these documents</a></h2>
<p>You will need a Unix-like environment (Linux, macOS) to run most of the tools. Across the entire documentation, commands to run in a terminal are described like this:</p>
<pre><code class="language-BASH">$ composer update
</code></pre>
<p><code>$</code> is not part of the command, it just indicates the terminal prompt. The command to type or copy and paste is simply <code>composer update</code>.</p>
<h2 id="updating-the-documentation"><a class="header" href="#updating-the-documentation">Updating the documentation</a></h2>
<p>Please see the <a href="https://github.com/mozilla-l10n/documentation/blob/main/README.md">README file in our GitHub repository</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l10n-and-android-l10n"><a class="header" href="#l10n-and-android-l10n">L10n and android-l10n</a></h1>
<p>Some documentation specific for common tasks regarding android-l10n and l10n:</p>
<ul>
<li><a href="products/android-l10n/adding_projects.html">Adding projects</a>.</li>
<li><a href="products/android-l10n/updating_locales.html">Updating locales</a>.</li>
<li><a href="products/android-l10n/review_android_strings.html">Reviewing strings</a>.</li>
<li><a href="products/android-l10n/removing_projects.html">Removing projects</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-project-to-android-l10n"><a class="header" href="#adding-a-new-project-to-android-l10n">Adding a new project to android-l10n</a></h1>
<p>Follow the steps below to add new projects to <a href="https://github.com/mozilla-l10n/android-l10n">android-l10n</a>. You will have to coordinate with android-l10n developers and a technical Localization EPM throughout the process.</p>
<h2 id="setting-up-the-project-in-source-and-l10n-repositories"><a class="header" href="#setting-up-the-project-in-source-and-l10n-repositories">Setting up the project in source and l10n repositories</a></h2>
<p>Before anything happens, check that the new project is properly localizable by following the directions in <a href="https://github.com/mozilla-l10n/documentation/blob/main/src/tools/pontoon/adding_new_project.md#adding-a-new-project-on-pontoon">this section</a>. Once the new project exists in its corresponding source repo and is properly localizable, it can then be added to the <code>android-l10n</code> repository.</p>
<p>Android developers need to create a TOML file in their code repository and under its corresponding project folder (example for Focus <a href="https://github.com/mozilla-mobile/firefox-android/blob/main/focus-android/l10n.toml">here</a>), as well as as the file containing the source strings in <code>res/values/strings.xml</code> (example with Focus <a href="https://github.com/mozilla-mobile/firefox-android/blob/c718159480512abf370abcfd5aaf54b1d81074d3/focus-android/app/src/main/res/values/strings.xml">here</a>). The <code>firefox-android</code> repository contains all <a href="https://github.com/mozilla-mobile/firefox-android/tree/main">current android projects</a>.</p>
<p>The TOML file should be pre-populated with a list of locales. When a new project is announced, the mobile PM typically reaches out to localizers on existing communication channels, so they can opt in their locale. If the Android project shares strings with <code>android-components</code>, then you need to first make sure the locale code is already listed under its corresponding <a href="https://github.com/mozilla-mobile/firefox-android/blob/main/android-components/l10n.toml">TOML file</a>. If not, it will need to be added there as well.</p>
<p>The <code>firefox-android</code> repository currently uses a <a href="https://github.com/mozilla-mobile/firefox-android/blob/main/.github/workflows/import-l10n.yml">single workflow</a> (GitHub action) to import strings for all projects from <code>android-l10n</code>. Sync with mobile developers to make sure that the code to import strings for this project has been added.</p>
<p>On the <code>android-l10n</code> repository side, you will need to set up <a href="https://github.com/mozilla-l10n/android-l10n/tree/main/.github/workflows">automation</a> to import strings from the code repository. This automation will be responsible for creating all needed files in the repository. You may need to sync up with a technical localization EPM to set this up.</p>
<p>Once automation is in place, it will extract new English strings from the code repository. It should also be possible to invoke automation <a href="https://github.com/mozilla-l10n/android-l10n/actions">manually</a>.</p>
<h2 id="add-the-project-in-pontoon"><a class="header" href="#add-the-project-in-pontoon">Add the project in Pontoon</a></h2>
<p>Once all of this is done and merged, you can now enable the new project in Pontoon. Instructions for adding new projects can be found <a href="https://github.com/mozilla-l10n/documentation/blob/main/src/tools/pontoon/adding_new_project.md#create-the-project">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="updating-locales-for-specific-projects"><a class="header" href="#updating-locales-for-specific-projects">Updating locales for specific projects</a></h1>
<p>These are instructions in order to update locales to Android mobile products living within the <a href="https://github.com/mozilla-l10n/android-l10n/">android-l10n project</a>.</p>
<h2 id="edit-the-l10ntoml-files"><a class="header" href="#edit-the-l10ntoml-files">Edit the l10n.toml file(s)</a></h2>
<p>All Android products live within the <a href="https://github.com/mozilla-l10n/android-l10n/">android-l10n repository</a>. Depending on the product that requires a locale to be added or removed, the corresponding <code>l10n.toml</code> file will have to be edited by updating the list of locale codes in it.</p>
<p>The <code>l10n.toml</code> files live in their corresponding project folder, located here for:</p>
<ul>
<li><a href="https://github.com/mozilla-l10n/android-l10n/blob/master/mozilla-mobile/fenix/l10n.toml">Fenix</a></li>
<li><a href="https://github.com/mozilla-l10n/android-l10n/blob/master/mozilla-mobile/android-components/l10n.toml">Android Components</a></li>
<li><a href="https://github.com/mozilla-l10n/android-l10n/blob/master/mozilla-mobile/focus-android/l10n.toml">Focus for Android</a></li>
</ul>
<p>Each l10n.toml file typically looks like this:</p>
<pre><code>basepath = &quot;.&quot;

locales = [
    &quot;an&quot;,
    &quot;ar&quot;,
    &quot;as&quot;,
    &quot;ast&quot;,
    &quot;az&quot;,
...
]

[env]

[[paths]]
  reference = &quot;app/src/main/res/values/strings.xml&quot;
  l10n = &quot;app/src/main/res/values-{android_locale}/strings.xml&quot;
</code></pre>
<p>Identify the <code>locales</code> section, add or update the desired locale code in this list, making sure that the list is in <strong>alphabetical order</strong>.</p>
<p>Save your edited file, then commit and push from your local clone to the <code>android-l10n</code> repository.</p>
<p>Note that:</p>
<ul>
<li>All products share strings with Android Components, so you will also have to edit the Android Components <code>l10n.toml</code> file as well if it’s a brand new locale.</li>
<li>In case of removal of a locale, files need to be manually removed from the repository.</li>
</ul>
<h2 id="updating-locales-in-pontoon"><a class="header" href="#updating-locales-in-pontoon">Updating locales in Pontoon</a></h2>
<p>Once the patch has landed, the locale has to be added - or removed - in Pontoon as well. The steps to follow can be found in the existing <a href="products/android-l10n/../../tools/pontoon/adding_new_locale.html">Pontoon documentation here</a>.</p>
<p>One thing to note is that, once you merge the pull request (PR) adding or removing locales in the l10n repository, automation will send that updated list over to the <a href="https://github.com/mozilla-mobile/firefox-android">code repository</a>. However use caution, as the next string quarantine PRs you receive might try to undo your changes (example of Fenix <code>l10n.toml</code> <a href="https://github.com/mozilla-mobile/firefox-android/blob/main/fenix/l10n.toml">here</a>, and more information about string quarantine PRs <a href="products/android-l10n/review_android_strings.html">here</a>).</p>
<p>You can know the status of l10n imports by checking the list of <a href="https://github.com/mozilla-mobile/firefox-android/pulls?q=is%3Apr+is%3Aclosed+Import+translations+">closed pull requests</a> in <code>firefox-android</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reviewing-strings-for-a-new-release-of-mozilla-android-products"><a class="header" href="#reviewing-strings-for-a-new-release-of-mozilla-android-products">Reviewing strings for a new release of Mozilla Android products</a></h1>
<p>Usually, a new release of our Android products requires updates to strings. Mobile developers will land strings in the code repository throughout the release cycle, and pull requests will be opened by GitHub automation in the <a href="https://github.com/mozilla-l10n/android-l10n">android-l10n</a> repository to expose these strings for localization in Pontoon.</p>
<p>The pull requests, tagged as <code>l10n-bot</code>, are then reviewed by an l10n-driver - most often by the PM in charge of the project.</p>
<p>Let’s go over some of the steps needed over time in order to review strings correctly for a new release.</p>
<h2 id="reviewing-the-pr"><a class="header" href="#reviewing-the-pr">Reviewing the PR</a></h2>
<p>Let's consider Firefox for Android as an example - in fact, these apply to other Android products as well, and they also follow the same train schedule. During the <a href="https://docs.google.com/spreadsheets/d/1hER_w7pOsWSjeBaUqMd_9ClYCCGlwc4jaFYpcBvFE8g/edit#gid=1960046531">Android l10n cycle</a>, automation will create pull requests, in order to land new strings for the upcoming release.</p>
<p>Let’s consider a past PR <a href="https://github.com/mozilla-l10n/android-l10n/pull/606/files">here</a>. <code>values/strings.xml</code> is the file containing all needed string updates.</p>
<h3 id="acceptable-changes"><a class="header" href="#acceptable-changes">Acceptable changes</a></h3>
<p>The first <a href="https://github.com/mozilla-l10n/android-l10n/pull/606/files#diff-b8d7151f11faa90ad8cfbb96437f96d05602954aa79c1145cb3232f6a5eb6d38R701">string change</a> adds attributes: <code>moz:RemovedIn=&quot;111&quot; tools:ignore=&quot;UnusedResources&quot;</code> to an existing string. You can ignore this kind of changes, as they will not affect localization. They are a reminder for mobile developers that they will be safely able to delete a string once it has finished riding the Nightly/Beta/Release train, and is no longer needed in an upcoming version. More details <a href="https://github.com/mozilla-mobile/fenix/wiki/Removing-strings">here</a>.</p>
<p>Changes to comments are irrelevant in terms of string updates, so they’re also OK.</p>
<p>The general review of strings, such as <a href="https://github.com/mozilla-l10n/android-l10n/pull/606/files#diff-b8d7151f11faa90ad8cfbb96437f96d05602954aa79c1145cb3232f6a5eb6d38R704">this one</a>, is similar to the review process used in other Mozilla products.</p>
<p>Things to look out for:</p>
<ul>
<li>Unclear strings and missing localization comments: the best way to identify them is to translate the strings, only having the string and comment as context (not the entire file, or the associated bug). For example: is the word used both a noun and a verb in English? Is the ID clear enough to give context (e.g. <code>buttonLabel</code>)?</li>
<li>String changes without new IDs. IDs in XML files are stored in the <code>name</code> attribute; for example, the ID of <a href="https://github.com/mozilla-l10n/android-l10n/pull/391/files#diff-b8d7151f11faa90ad8cfbb96437f96d05602954aa79c1145cb3232f6a5eb6d38R223">this string</a> is <code>browser_menu_customize_home</code>. This type of issue, together with misused characters, is reported by Checks running automatically on pull requests.</li>
<li>Duplicated strings.</li>
<li>Other general <a href="https://mozilla-l10n.github.io/documentation/localization/dev_best_practices.html">localization issues</a>.</li>
</ul>
<p>In case of issues, you can comment and CC the developer who introduced the string(s). This can be done directly in the corresponding <code>mozilla-l10n</code> GitHub PR where your review has taken place.</p>
<h2 id="wrapping-up-your-work"><a class="header" href="#wrapping-up-your-work">Wrapping up your work</a></h2>
<p>So you’ve reviewed the strings during the cycle, and the PR looks good - this means you can now merge the PR so the strings get exposed in Pontoon.</p>
<p>Pontoon (<a href="https://pontoon.mozilla.org/projects/firefox-for-android/">here for Firefox for Android</a> and <a href="https://pontoon.mozilla.org/projects/focus-for-android/">here for Focus for Android</a>) should get the new strings automatically after a few minutes, but it’s always a good idea to double check just in case.</p>
<p>One last thing is to not forget to update the l10n completion deadline under Pontoon resources for each product.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="removing-projects-from-android-l10n"><a class="header" href="#removing-projects-from-android-l10n">Removing projects from android-l10n</a></h1>
<p>Follow the steps below to safely remove projects from <a href="https://github.com/mozilla-l10n/android-l10n">android-l10n</a>.</p>
<h2 id="remove-import-automation-from-firefox-android"><a class="header" href="#remove-import-automation-from-firefox-android">Remove import automation from firefox-android</a></h2>
<p>The <code>firefox-android</code> repository currently uses a <a href="https://github.com/mozilla-mobile/firefox-android/blob/main/.github/workflows/import-l10n.yml">single workflow</a> (GitHub action) to import strings for all projects from <code>android-l10n</code>. Sync with mobile developers to make sure that the code to import strings for this project has been removed.</p>
<h2 id="disable-the-project-in-pontoon"><a class="header" href="#disable-the-project-in-pontoon">Disable the project in Pontoon</a></h2>
<p>In order to disable a project in Pontoon, log in to admin view of the project (e.g. <a href="https://pontoon.mozilla.org/admin/projects/firefox-for-android/">Firefox for Android</a>, <a href="https://pontoon.mozilla.org/admin/projects/focus-for-android/">Focus for Android</a>, etc.) and scroll to the bottom of the page. Click the <code>Disabled</code> checkbox on the left and then <code>Save Project</code>.
The project will no longer be shown to localizers and will stop syncing between Pontoon and the GitHub <code>android-l10n</code> repository. This allows safe removal of the project from the repo and avoids any possible conflicts between files.</p>
<h2 id="remove-android-l10n-files"><a class="header" href="#remove-android-l10n-files">Remove android-l10n files</a></h2>
<ul>
<li>Remove <a href="https://github.com/mozilla-l10n/android-l10n/tree/main/.github/workflows">GitHub actions</a> associated to the project.</li>
<li>If available, remove TOML files associated to the project in the root of the repository (e.g. <code>focus.toml</code> for <code>Focus for Android</code>).</li>
<li>Remove the entire project folder.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l10n-and-firefox-desktop"><a class="header" href="#l10n-and-firefox-desktop">L10n and Firefox desktop</a></h1>
<p>Some documentation specific for common tasks regarding Firefox desktop and l10n:</p>
<ul>
<li><a href="products/firefox_desktop/../../tools/mercurial/setting_mercurial_environment.html">Set up the environment</a>.</li>
<li><a href="products/firefox_desktop/adding_pontoon.html">Adding a locale to Pontoon</a>.</li>
<li><a href="products/firefox_desktop/adding_nightly.html">Adding a locale to Nightly builds</a>.</li>
<li><a href="products/firefox_desktop/adding_release.html">Adding a locale to Beta and Release builds</a>.</li>
<li><a href="products/firefox_desktop/setup_searchplugins.html">Set up searchplugins</a>.</li>
<li><a href="products/firefox_desktop/removing_locales.html">Removing a locale</a>.</li>
<li><a href="products/firefox_desktop/fluent_migrations.html">Running Fluent migrations</a>.</li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html">FAQs for Firefox and L10N</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-locale-to-pontoon"><a class="header" href="#adding-a-new-locale-to-pontoon">Adding a new locale to Pontoon</a></h1>
<ul>
<li>If the locale is not <a href="https://pontoon.mozilla.org/teams/">available</a> in Pontoon yet, <a href="products/firefox_desktop/../../tools/pontoon/adding_new_locale.html">consult this document</a> for instructions on how to add it.</li>
<li>File a bug to create a new Mercurial repository in <a href="https://hg.mozilla.org/l10n-central/">l10n-central</a> using <a href="https://mzl.la/3VxIZgs">this bug template</a> (replace <code>%LOCALE_CODE%</code> with the actual locale code).</li>
<li>Push at least one change to the repository, otherwise Pontoon will not pick it up during sync. The safest change is to initialize the <code>toolkit/chrome/global/intl.properties</code> file with the correct values (<a href="https://hg.mozilla.org/l10n-central/ppl/rev/b3fd0faf59b0b45b2cf30c01d85157beee2a0bd0">example</a>).</li>
</ul>
<p>Once the repository is available and contains at least one commit, the locale can be added to the Firefox project in Pontoon.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-locale-to-nightly-builds"><a class="header" href="#adding-a-new-locale-to-nightly-builds">Adding a new locale to Nightly builds</a></h1>
<ul>
<li><a href="products/firefox_desktop/adding_nightly.html#prerequisites">Prerequisites</a></li>
<li><a href="products/firefox_desktop/adding_nightly.html#create-a-tracking-github-issue-and-set-up-bugs-to-add-the-new-locale">Create a tracking GitHub issue and set up bugs to add the new locale</a></li>
<li><a href="products/firefox_desktop/adding_nightly.html#verify-content-in-l10n-repository">Verify content in l10n repository</a></li>
<li><a href="products/firefox_desktop/adding_nightly.html#add-new-locale-to-build-configuration">Add new locale to build configuration</a></li>
<li><a href="products/firefox_desktop/adding_nightly.html#verify-product-details-configuration">Verify product-details configuration</a></li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>Locales will be added to Nightly builds only after reaching at least 30% overall completion in Pontoon. For details on the requirements to move to Beta/Release, see <a href="products/firefox_desktop/adding_release.html#prerequisites">this document</a>.</p>
<h2 id="create-a-tracking-github-issue-and-set-up-bugs-to-add-the-new-locale"><a class="header" href="#create-a-tracking-github-issue-and-set-up-bugs-to-add-the-new-locale">Create a tracking GitHub issue and set up bugs to add the new locale</a></h2>
<p>This <a href="https://github.com/orgs/mozilla-l10n/projects/3/views/1">GitHub project</a> is used to track locales added to or removed from Firefox. The <code>Queue - WIP</code> column includes all locales currently in Nightly, once they move to Release a new column is added for the specific Firefox version in which they shipped (e.g. <code>Firefox 91</code>).</p>
<p>As a first step, file an issue using the <a href="https://github.com/mozilla-l10n/pm-projects/issues/new/choose">New Locale for Firefox Desktop template</a>. Replace <code>%LOCALE_NAME% (%LOCALE_CODE%)</code> with the locale name and code in the title field, e.g. <code>Lao (lo)</code>, and add the issue to the <code>Queue - WIP</code> column in the <a href="https://github.com/orgs/mozilla-l10n/projects/3/views/1">GitHub project</a>.</p>
<p>Then file a new tracking bug using this <a href="https://mzl.la/3vwVtub">bug template</a>. Replace <code>%LOCALE_NAME%</code> with the locale name, e.g. <code>Lao</code>, and <code>%LOCALE_CODE%</code> with the locale code, e.g. <code>lo</code>. Pay attention to update the <code>alias</code> field as well, and CC the locale manager if they already have a Bugzilla account. Once the bug is filed, update the link in the GitHub issue.</p>
<p>Note that the tracking bug is filed under <code>Mozilla Localizations :: Other</code>, as creating the Bugzilla component is a step that will be performed when the locale is ready to move to Beta/Release. If the component for this locale is already available, the bug should to be moved directly there.</p>
<p>To make it easier to track dependencies, also add the bug used to create the l10n-central repository (see <a href="products/firefox_desktop/adding_pontoon.html">Adding a new locale to Pontoon</a>) as a dependency (<code>Depends on:</code> field) of the tracking bug.</p>
<h2 id="verify-content-in-l10n-repository"><a class="header" href="#verify-content-in-l10n-repository">Verify content in l10n repository</a></h2>
<p>Before enabling the build, it’s a good idea to perform some basic checks:</p>
<ul>
<li>Check <code>toolkit/global/intl.properties</code> (<a href="https://hg.mozilla.org/mozilla-central/file/default/toolkit/locales/en-US/chrome/global/intl.properties">en-US version</a>) for evident mistakes.</li>
</ul>
<h2 id="add-new-locale-to-build-configuration"><a class="header" href="#add-new-locale-to-build-configuration">Add new locale to build configuration</a></h2>
<p>First of all make sure that your environment is <a href="products/firefox_desktop/../../tools/mercurial/setting_mercurial_environment.html">correctly set up</a>, update your local mozilla-unified clone and make sure it’s on the <code>central</code> bookmark:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/mozilla-unified
$ hg pull -u
$ hg up central
</code></pre>
<p>File a bug using <a href="https://mzl.la/3QcddVk">this template</a>, replacing the locale name and code placeholders, and update the link in the GitHub tracking issue.</p>
<p>The first file to modify is <code>browser/locales/all-locales</code>, open it with your text editor of choice (in this example, Visual Studio Code).</p>
<pre><code class="language-BASH">$ code browser/locales/all-locales
</code></pre>
<p>And add the new locale to the list. With Visual Studio Code, you can open the <em>Command Palette</em> and select <em>Sort Line Ascending</em> to make sure that the list is in <strong>alphabetical order</strong>.</p>
<p>The second file to modify is <code>browser/locales/l10n.toml</code>. This is the beginning of the file:</p>
<pre><code># This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

basepath = &quot;../..&quot;

locales = [
    &quot;ach&quot;,
    &quot;af&quot;,
    &quot;an&quot;,
    &quot;ar&quot;,
    &quot;as&quot;,
...
</code></pre>
<p>Identify the <code>locales</code> section, and add the new locale code between double quotes, followed by a comma. As before, you can use the editor to make sure the list is in alphabetical order (make sure to select only the lines with actual locale codes before pressing running the command).</p>
<p>After you’ve finished editing the files, check the status of the repository, and the diff.</p>
<pre><code class="language-BASH">$ hg status
M browser/locales/all-locales
M browser/locales/l10n.toml

$ hg diff
diff --git a/browser/locales/all-locales b/browser/locales/all-locales
--- a/browser/locales/all-locales
+++ b/browser/locales/all-locales
@@ -51,17 +51,16 @@ ja
 kn
 ko
 lij
+lo
 lt
 ltg
 lv

 diff --git a/browser/locales/l10n.toml b/browser/locales/l10n.toml
 --- a/browser/locales/l10n.toml
 +++ b/browser/locales/l10n.toml
 @@ -59,17 +59,16 @@ locales = [
      &quot;kn&quot;,
      &quot;ko&quot;,
      &quot;lij&quot;,
 +    &quot;lo&quot;,
      &quot;lt&quot;,
      &quot;ltg&quot;,
      &quot;lv&quot;,
</code></pre>
<p><code>M</code> in <code>hg status</code> indicates that the file has been modified, <code>+</code> in <code>hg diff</code> that the line has been added. Follow the instructions available in <a href="products/firefox_desktop/../../tools/mercurial/creating_mercurial_patch.html">this document</a> to create a patch, submit it for review, and land it.</p>
<h2 id="verify-product-details-configuration"><a class="header" href="#verify-product-details-configuration">Verify product-details configuration</a></h2>
<p>Once a locale is added to Nightly builds, <code>product-details</code> will pick up automatically the new build. In order for the new build to be listed on <a href="https://www.mozilla.org/firefox/nightly/all/">mozilla.org</a>, the language name needs to be available in <a href="https://github.com/mozilla-releng/product-details/blob/production/public/1.0/languages.json">languages.json</a>. If missing:</p>
<ul>
<li>Open a pull request against the <code>production</code> branch of <a href="https://github.com/mozilla-releng/product-details">product-details</a> (<a href="https://github.com/mozilla-releng/product-details/pull/4">example</a>), and update the GitHub tracking issue accordingly.</li>
<li>The language name needs to use Unicode code points in the format <code>\uXXXX</code> for non ASCII characters.</li>
</ul>
<p>The easiest way to convert the language name from UTF-8 is to use Python's JSON module. For example, to convert Tibetan (<code>བོད་སྐད་</code>):</p>
<pre><code>$ python -c 'import json; print(json.dumps(&quot;བོད་སྐད་&quot;))'
&quot;\u0f56\u0f7c\u0f51\u0f0b\u0f66\u0f90\u0f51\u0f0b&quot;
</code></pre>
<p>The final entry in <code>product-details</code> would look like this (<code>bo</code> is the locale code for Tibetan):</p>
<pre><code>&quot;bo&quot;: {
    &quot;English&quot;: &quot;Tibetan&quot;,
    &quot;native&quot;: &quot;\u0f56\u0f7c\u0f51\u0f0b\u0f66\u0f90\u0f51\u0f0b&quot;
},
</code></pre>
<p>Updates to <code>product-details</code> are pushed to production every time a new Beta or Release build is released. In case of urgency, updates can be triggered manually by Release Engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-locale-to-beta-and-release-builds"><a class="header" href="#adding-a-new-locale-to-beta-and-release-builds">Adding a new locale to Beta and Release builds</a></h1>
<h2 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h2>
<p>The majority of the technical work has already been completed when setting up <a href="products/firefox_desktop/adding_nightly.html">Nightly builds</a>.</p>
<p>There are a few important prerequisites before adding a new locale to Beta and Release.</p>
<p>For the localization community:</p>
<ul>
<li>Localization should have reached a high level of completion, especially for user facing parts of the UI:
<ul>
<li>All <a href="https://mozilla-l10n.github.io/localizer-documentation/tools/pontoon/search_filters.html#tags">Tags</a> with high priority (4 and 5 stars) should be at 100% (or very close).</li>
<li>Lower priority Tags should be at least above 30%.</li>
</ul>
</li>
<li>Localization team has demonstrated a consistent effort, being able to keep up for at least a couple of cycles with the incoming flow of new strings.
<ul>
<li>There must be more than one active translator on the project, to ensure that the content has been peer reviewed.</li>
</ul>
</li>
<li>There is a relevant number of users on the Nightly channel testing the localization. This number varies based on the language, for minority languages 10-20 users is an excellent result. Also, a trend showing growth is important as well.</li>
</ul>
<p>For the localization PM:</p>
<ul>
<li>Builds have been tested on different operating systems without identifying critical issues.</li>
<li><a href="products/firefox_desktop/setup_searchplugins.html">Searchplugins are set up</a>.</li>
</ul>
<p>To track this work, you need to file a bug in Firefox::Build Config (like <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1359321">this example</a>), blocking the original tracking bug for the locale (<code>fx-l10n-LOCALE</code>).</p>
<h2 id="create-a-bugzilla-component"><a class="header" href="#create-a-bugzilla-component">Create a Bugzilla component</a></h2>
<p>Before filing a new bug, the localization team needs to provide the translation for <code>%LOCALE_NAME% Localization</code>, as the component description includes both English and translated versions.</p>
<p>Once that information is available:</p>
<ul>
<li>File a new bug following <a href="https://mzl.la/3jzjaza">this template</a>. Replace <code>%LOCALE_NAME%</code> with the locale name (e.g. <code>Lao</code>), <code>%LOCALE_CODE%</code> with the locale code (e.g. <code>lo</code>), and <code>%LOCALIZED_DESCRIPTION%</code> with the translation provided by the team. For example, for Lao the whole description will result in <code>Lao Localization (ການແປພາສາລາວ)</code>.</li>
<li>Once the component is available, update the <a href="https://github.com/orgs/mozilla-l10n/projects/3/views/1">GitHub tracking issue</a> with the link to this bug, and move all existing bugs from <code>Other</code> to this new component.</li>
</ul>
<h2 id="set-up-searchplugins"><a class="header" href="#set-up-searchplugins">Set up searchplugins</a></h2>
<p>Check the <a href="products/firefox_desktop/setup_searchplugins.html">Set up searchplugins</a> document for detailed instructions on how to set up searchplugins for new locales.</p>
<h2 id="verify-language-name"><a class="header" href="#verify-language-name">Verify language name</a></h2>
<p>The language name associated to the locale code is displayed in a few places in Firefox interface (language settings for web content, contextual menu for dictionaries). The language name needs to be defined in:</p>
<ul>
<li><a href="https://searchfox.org/mozilla-central/source/toolkit/locales/en-US/toolkit/intl/languageNames.ftl">languageNames.ftl</a>: ID with structure <code>language-name-LOCALECODE = (name of the language in English)</code>. Note that the locale code can only be a 2/3 letter code, locales like <code>ca-valencia</code> are not valid.</li>
<li><a href="https://searchfox.org/mozilla-central/source/python/mozbuild/mozbuild/action/langpack_localeNames.json">langpack_localeNames.json</a>: add the locale code with the <code>native</code> name, add <code>english</code> only if the English name differs from the native name. This list is used to generate language pack names and descriptions.</li>
<li><a href="https://searchfox.org/mozilla-central/source/toolkit/components/mozintl/mozIntl.sys.mjs">mozIntl.jsm</a>:
<ul>
<li>Add the locale code in the <code>availableLocaleDisplayNames</code> constant, <code>language</code> <a href="https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/mozintl/mozIntl.jsm#451">set</a>.</li>
<li>Add the localized language name in the <code>nativeLocaleNames</code> <a href="https://searchfox.org/mozilla-central/rev/b3933df6e119bd6caf5d9e5868670348ec26dee3/toolkit/components/mozintl/mozIntl.jsm#650">map</a>. The localized language name should also be stored in <a href="https://github.com/mozilla-l10n/firefox-languages/blob/master/output/languages_curated.json">this repository</a>.</li>
</ul>
</li>
<li><a href="https://searchfox.org/mozilla-central/source/intl/locale/language.properties">language.properties</a>: add a value in the form <code>LOCALECODE.accept = true</code>. This is needed to list the language in the language settings dialog for web content.</li>
</ul>
<p>This is an <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1807794">example of a bug</a> created to add this information. Don’t forget to update the GitHub tracking issue for the locale with a link to this bug.</p>
<h2 id="add-locale-to-build-configuration"><a class="header" href="#add-locale-to-build-configuration">Add locale to build configuration</a></h2>
<p>First of all make sure that your environment is <a href="products/firefox_desktop/../../tools/mercurial/setting_mercurial_environment.html">correctly set up</a>, update your local mozilla-unified clone and make sure it’s on the <code>central</code> bookmark:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/mozilla-unified
$ hg pull -u
$ hg up central
</code></pre>
<p>This is an <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1716987">example of a recent bug</a> used to track the build changes.</p>
<p>The file to modify is in <code>browser/locales/shipped-locales</code>, open it with your text editor of choice (in this example, Visual Studio Code).</p>
<pre><code class="language-BASH">$ code browser/locales/shipped-locales
</code></pre>
<p>And add the new locale to the list. With Visual Studio Code, you can open the <em>Command Palette</em> and select <em>Sort Line Ascending</em> to make sure that the list is in <strong>alphabetical order</strong>.</p>
<p>After you’ve finished editing the file, check the status of the repository, and the diff. Let’s consider for example the task of adding Urdu (ur).</p>
<pre><code class="language-BASH">$ hg status
M browser/locales/shipped-locales

$ hg diff
--- a/browser/locales/shipped-locales
+++ b/browser/locales/shipped-locales
@@ -83,14 +84,13 @@ son
 te
 th
 tr
 uk
+ur
 uz
 vi
 xh
 zh-CN
</code></pre>
<p><code>M</code> in <code>hg status</code> indicates that the file has been modified, <code>+</code> in <code>hg diff</code> that the line has been added. Follow the instructions available in <a href="products/firefox_desktop/../../tools/mercurial/creating_mercurial_patch.html">this document</a> to create a patch, submit it for review, and land it.</p>
<p>You also need to set the <code>relnote-firefox</code> flag to <code>?</code> in the bug, the suggested comment is <code>Suggested for release notes: &quot;Locale added: LANGUAGE_NAME (LOCALE_CODE)&quot;</code>.</p>
<h2 id="update-language-pack-settings-on-amo"><a class="header" href="#update-language-pack-settings-on-amo">Update language pack settings on AMO</a></h2>
<p>The language pack for the new locale will be uploaded automatically by release automation on <em>addons.mozilla.org</em> (starting with the Beta version). A few follow-up manual steps are needed:</p>
<ul>
<li>The <code>Mozilla</code> account needs to be added as author for the language pack.</li>
<li>The locale needs to be defined in <a href="https://github.com/mozilla/addons-frontend/blob/master/src/amo/languages.js">this JavaScript file</a>.</li>
</ul>
<p>For the first step, an email needs to be sent to AMO administrators (amo-admins(at)mozilla.com).</p>
<p>These steps will make the language pack available in both the <a href="https://addons.mozilla.org/firefox/language-tools/">Language Tools</a> page and the API used by Firefox to add new languages from preferences.</p>
<h2 id="close-github-tracking-issue"><a class="header" href="#close-github-tracking-issue">Close GitHub tracking issue</a></h2>
<p>Once the locale ships to release:</p>
<ul>
<li>Create a new column for the Firefox version, e.g. <code>Firefox 91</code>, in the <a href="https://github.com/orgs/mozilla-l10n/projects/3/views/1">GitHub project</a>.</li>
<li>Close the tracking issue and move it from <code>Queue - WIP</code> to this new column.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-up-searchplugins-and-protocol-handlers"><a class="header" href="#set-up-searchplugins-and-protocol-handlers">Set up searchplugins and protocol handlers</a></h1>
<ul>
<li><a href="products/firefox_desktop/setup_searchplugins.html#set-up-searchplugins">Set up searchplugins</a>
<ul>
<li><a href="products/firefox_desktop/setup_searchplugins.html#tips-for-icons-and-wikipedia">Tips for icons and Wikipedia</a>
<ul>
<li><a href="products/firefox_desktop/setup_searchplugins.html#icons">Icons</a></li>
<li><a href="products/firefox_desktop/setup_searchplugins.html#wikipedia">Wikipedia</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="products/firefox_desktop/setup_searchplugins.html#set-up-protocol-handlers">Set up protocol handlers</a></li>
</ul>
<h2 id="set-up-searchplugins-1"><a class="header" href="#set-up-searchplugins-1">Set up searchplugins</a></h2>
<p>Searchplugins configuration has become too complex and it’s constantly evolving, because of that a <a href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Firefox&amp;component=Search">bug needs to be filed</a> to let the Search Team set up new locales. This section is meant as an overall reference, with link to external documentation.</p>
<p>Given the complexity and external dependencies, it’s become common practice to set up searchplugins at a later phase, when the locale is ready to move from Nightly to Beta, and let Nightly rely on default settings.</p>
<p>Starting with Firefox 68, the <a href="https://developer.mozilla.org/en-US/docs/Web/OpenSearch">XML OpenSearch</a> format was dropped for built-in searchplugins, switching to <a href="https://searchfox.org/mozilla-central/source/browser/components/search/extensions">WebExtensions</a>. Each searchplugin has its own folder, with:</p>
<ul>
<li>An icon, which can be either in PNG format (<code>favicon.png</code>) or ICO (<code>favicon.ico</code>).</li>
<li>A WebExtension manifest (<code>manifest.json</code>). If the searchplugin supports only one locale, the manifest includes the localized name (repeated twice) and description (<a href="https://searchfox.org/mozilla-central/rev/a78233c11a6baf2c308fbed17eb16c6e57b6a2ac/browser/components/search/extensions/leo_ende_de/manifest.json">leo-ende example</a>).</li>
</ul>
<pre><code class="language-JSON">{
  &quot;name&quot;: &quot;LEO Eng-Deu&quot;,
   &quot;description&quot;: &quot;Deutsch-Englisch Wörterbuch von LEO&quot;,
  [...]
  &quot;chrome_settings_overrides&quot;: {
    &quot;search_provider&quot;: {
      &quot;name&quot;: &quot;LEO Eng-Deu&quot;,
      [...]
    }
  }
}
</code></pre>
<ul>
<li>A <code>_locales</code> folder if the searchplugins supports multiple locales. In this case, the manifest will only include placeholders for name and description, and they will be localized in a subfolder for the locale itself (<a href="https://searchfox.org/mozilla-central/rev/a78233c11a6baf2c308fbed17eb16c6e57b6a2ac/browser/components/search/extensions/wikipedia/_locales/it/messages.json">Wikipedia example</a>).</li>
</ul>
<pre><code class="language-JSON">  &quot;extensionName&quot;: {
    &quot;message&quot;: &quot;Wikipedia (it)&quot;
  },
  &quot;extensionDescription&quot;: {
    &quot;message&quot;: &quot;Wikipedia, l'enciclopedia libera&quot;
  },
</code></pre>
<p>Search configuration is stored in <a href="https://firefox.settings.services.mozilla.com/v1/buckets/main/collections/search-config/records">Remote Settings</a>. The system, including the schema for <code>search-config.json</code>, is documented in <a href="https://firefox-source-docs.mozilla.org/toolkit/search/index.html">Firefox Documentation - Search Service</a>.</p>
<p>When <a href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Firefox&amp;component=Search">filing a new bug</a>, make sure to provide the following information:</p>
<ul>
<li>The list of searchplugins to use for the locale.</li>
<li>If a new searchplugin needs to be added: name, description, icon, search parameters. The best way to make sure all information is included is to use existing searchplugins as reference.</li>
</ul>
<h3 id="tips-for-icons-and-wikipedia"><a class="header" href="#tips-for-icons-and-wikipedia">Tips for icons and Wikipedia</a></h3>
<h4 id="icons"><a class="header" href="#icons">Icons</a></h4>
<p>These are some useful tips to deal with icons for brand new searchplugins:</p>
<ul>
<li>If the image is a PNG, make sure to optimize it before encoding it to <code>base64</code> (for example using <a href="https://tinypng.com/">tinypng.com</a>).</li>
<li>You can create an <code>.ico</code> file starting from separate 16px and 32px PNG icons. Create a 32px image in <a href="https://www.gimp.org/">Gimp</a>, add each icon to a separate layer, and export the file as <code>.ico</code> (make sure to select the option to compress each of the layers).</li>
<li>You can use online services (like <a href="http://freeonlinetools24.com/base64-image">this one</a>) to quickly encode an image to <code>base64</code>.</li>
<li>You can test the image in the browser (copy and paste the data URI in the address bar). You will still have to download it to check that everything looks good, since only one image will be displayed for multilayer <code>.ico</code> files, and transparent files are displayed in a misleading way in Firefox preview.</li>
</ul>
<h4 id="wikipedia"><a class="header" href="#wikipedia">Wikipedia</a></h4>
<p><strong>URLs:</strong> Make sure to update all URLs. If the URL for English starts with <code>en.wikipedia.</code>, for <code>ur</code> it should start with <code>ur.wikipedia.</code> (check if the domain actually exists).</p>
<p><strong>Search template:</strong> There’s one special URL to keep in mind, in English it’s https://en.wikipedia.org/wiki/Special:Search
It’s particular because the last part changes according to the locale, just try replacing the domain first from <code>en.</code> to <code>ur.</code>: https://ur.wikipedia.org/wiki/Special:Search
You’ll notice that it redirects to <code>https://ur.wikipedia.org/wiki/خاص:تلاش</code> and that’s the URL you need to use in the webextension.</p>
<p>You can’t copy the full URL from the address bar since it will encode UTF-8 characters, e.g. <code>https://ur.wikipedia.org/wiki/%D8%AE%D8%A7%D8%B5:%D8%AA%D9%84%D8%A7%D8%B4</code>, so it’s faster to just copy only part of the URL and fix the rest by hand.</p>
<p><strong>Description:</strong> You will need localizers to provide the translation for <code>Wikipedia, the Free Encyclopedia</code>.</p>
<p><strong>Name:</strong> In the localization file there’s an attribute called <code>extensionName</code>. For English is:</p>
<pre><code class="language-JSON">&quot;extensionName&quot;: {
  &quot;message&quot;: &quot;Wikipedia (en)&quot;
},
</code></pre>
<p>To get the localized name, visit https://gn.wikipedia.org and press <code>CTRL+U</code> to view the source code of the page. At the beginning you will find a line looking like this:</p>
<pre><code class="language-HTML">&lt;link rel=&quot;search&quot; type=&quot;application/opensearchdescription+xml&quot; href=&quot;/w/opensearch_desc.php&quot; title=&quot;ویکیپیڈیا (ur)&quot;/&gt;
</code></pre>
<p>The <em>Name</em> to use in your localization is <code>ویکیپیڈیا (ur)</code>. Copying and pasting RTL languages is particularly tricky.</p>
<h2 id="set-up-protocol-handlers"><a class="header" href="#set-up-protocol-handlers">Set up protocol handlers</a></h2>
<p>Starting with Firefox 98, the configuration for protocol handlers is <a href="https://searchfox.org/mozilla-central/source/uriloader/exthandler/HandlerList.sys.mjs">centralized in mozilla-central</a>. For most new locales, the default configuration should be acceptable.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="removing-a-locale-from-firefox-desktop"><a class="header" href="#removing-a-locale-from-firefox-desktop">Removing a locale from Firefox desktop</a></h1>
<p>Removing a locale from Firefox builds should be the last step in a long series of passages. A locale is removed when:</p>
<ul>
<li>There’s no visible activity in Pontoon for at least a year.</li>
<li>The translation level of Firefox is dropping, causing a good portion of the user interface to appear in English.</li>
<li>Outreach to existing community and locale leaders doesn’t produce results.</li>
<li>Attempts to find new localizers, via social networks and other tools (e.g. snippets), doesn’t find any potential contributors.</li>
</ul>
<h2 id="removing-a-locale-from-nightly"><a class="header" href="#removing-a-locale-from-nightly">Removing a locale from Nightly</a></h2>
<p>If a locale is only shipping in Nightly, it’s enough to remove the locale from build configuration.</p>
<p>The process is identical to the one use to <a href="products/firefox_desktop/adding_nightly.html#add-new-locale-to-build-configuration">add a new locale</a>, just removing the locale code from <code>browser/locales/all-locales</code> and <code>browser/locales/l10n.toml</code>.</p>
<p>Locale also needs to be removed from <a href="https://github.com/mozilla-releng/ship-it/blob/master/README-l10n.md">Ship It</a>.</p>
<h2 id="removing-a-locale-from-beta-and-release"><a class="header" href="#removing-a-locale-from-beta-and-release">Removing a locale from Beta and Release</a></h2>
<p>Removing a locale already shipping in official builds (Beta, Release) is a much more complex process. These are the steps:</p>
<ul>
<li><a href="products/firefox_desktop/removing_locales.html#check-usage-statistics">Check usage statistics</a>.</li>
<li><a href="products/firefox_desktop/removing_locales.html#redirect-existing-users-to-another-locale">Redirect existing users to another locale</a>.</li>
<li><a href="products/firefox_desktop/removing_locales.html#remove-locale-from-beta-builds">Remove locale from Beta builds</a>.</li>
</ul>
<p>Mercurial repositories and Bugzilla components are not removed when dropping a locale.</p>
<p>Given the number of teams and processes involved, a <strong>tracking bug should be filed</strong> (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1304743">example</a>).</p>
<h3 id="check-usage-statistics"><a class="header" href="#check-usage-statistics">Check usage statistics</a></h3>
<p>Existing users for this locale need to be moved to another language, otherwise they would remain forever on an obsolete build. The first step is to determine the current usage statistics on Telemetry using a <a href="https://sql.telemetry.mozilla.org/queries/4237">query similar to this one</a>.</p>
<p>If the locale has a significant userbase (in the hundreds of users), you need to determine the best locale to fall back to. Possible sources of information are:</p>
<ul>
<li>Wikipedia page for the language to determine where it’s spoken, and if there are other languages commonly spoken in the area.</li>
<li>Telemetry (<a href="https://sql.telemetry.mozilla.org/queries/77772">example for France</a>) for the language distribution in these countries.</li>
</ul>
<p>You also need to verify with Business Development if there are <strong>contractual obligations regarding search engines</strong>.</p>
<p>For example, Belarusian was recently removed from builds:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Belarusian_language">Belarusian</a> is the official language of Belarus. The Wikipedia page also has information about the number of people speaking both Russian and Belarusian in the region.</li>
<li>Russian is an official language of Belarus.</li>
<li>Russia has a low percentage of <a href="https://en.wikipedia.org/wiki/List_of_countries_by_English-speaking_population">population speaking English</a>.</li>
</ul>
<p>For these reasons, Russian was selected as the best fall back language for Belarusian. Unfortunately, sources might not always point into the same direction, in that case en-US might be the only viable option.</p>
<h3 id="redirect-existing-users-to-another-locale"><a class="header" href="#redirect-existing-users-to-another-locale">Redirect existing users to another locale</a></h3>
<p>Once identified the language to fall back to, a bug needs to be <a href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Release%20Engineering&amp;component=Releases">filed in Release Engineering::Releases</a> to redirect users via update snippets. An example of such bug is <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1304747">available here</a>.</p>
<h3 id="remove-locale-from-beta-builds"><a class="header" href="#remove-locale-from-beta-builds">Remove locale from Beta builds</a></h3>
<p>The process is identical to the one use to <a href="products/firefox_desktop/adding_release.html#add-locale-to-build-configuration">add a new locale</a>, just removing the locale code from <code>browser/locales/shipped-locales</code> in Beta. The change will ride the train to Release at the end of the cycle.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reviewing-strings-in-firefox-desktop"><a class="header" href="#reviewing-strings-in-firefox-desktop">Reviewing strings in Firefox desktop</a></h1>
<ul>
<li><a href="products/firefox_desktop/review.html#review-landed-strings">Review landed strings</a>
<ul>
<li><a href="products/firefox_desktop/review.html#review-strings-landing-in-mozilla-central">Review strings landing in mozilla-central</a></li>
<li><a href="products/firefox_desktop/review.html#review-strings-landing-in-gecko-strings-quarantine">Review strings landing in gecko-strings-quarantine</a></li>
<li><a href="products/firefox_desktop/review.html#run-compare-locales-against-gecko-strings">Run compare-locales against gecko-strings</a></li>
<li><a href="products/firefox_desktop/review.html#run-compare-locales-against-a-localization-repository">Run compare-locales against a localization repository</a></li>
<li><a href="products/firefox_desktop/review.html#push-reviewed-strings-to-gecko-strings">Push reviewed strings to gecko-strings</a></li>
</ul>
</li>
</ul>
<h2 id="review-landed-strings"><a class="header" href="#review-landed-strings">Review landed strings</a></h2>
<p>Starting from Firefox 57, all versions of Firefox desktop ship by localizing a single repository containing the reference English strings, called <a href="https://hg.mozilla.org/l10n/gecko-strings">gecko-strings</a>. It is generated from strings landing in the code repository for each branch (e.g. mozilla-central and comm-central for Nightly, mozilla-beta and comm-beta for Beta, etc.), and it’s exposed to localization tools like Pontoon.</p>
<p>There is a second repository, <a href="https://hg.mozilla.org/l10n/gecko-strings-quarantine/">gecko-strings-quarantine</a>, used as a buffer to avoid exposing poor strings to the larger audience of localizers.</p>
<p>The localizations for all channels can be found in <a href="https://hg.mozilla.org/l10n-central/">l10n-central</a>, with a single repository for each locale.</p>
<p>The review process consists of three parts:</p>
<ul>
<li>Review strings landing in <code>mozilla-central</code>. Currently <code>comm-central</code> doesn’t undergo a similar review process.</li>
<li>Review strings landing in <code>gecko-strings-quarantine</code>. The quarantine repository is updated twice a day via automation in <a href="https://firefox-source-docs.mozilla.org/taskcluster/kinds.html#l10n-cross-channel">Task Cluster</a>.</li>
<li>Push reviewed strings to <code>gecko-strings</code>, and start the localization process.</li>
</ul>
<h3 id="review-strings-landing-in-mozilla-central"><a class="header" href="#review-strings-landing-in-mozilla-central">Review strings landing in mozilla-central</a></h3>
<p>You can get the list of changesets touching localized strings in the last 2 days from <a href="https://hg.mozilla.org/mozilla-central/log?rev=keyword(%22locales/en-US%22)+and+pushdate(%22-2%22)">mozilla-central</a>. Adjust the <code>pushdate</code> part if you want to see more or less days.</p>
<p>There are some unrelated changesets, like en-US dictionary updates, but the majority of landings are relevant and need to be checked for localization issues.</p>
<p>You need to open each changeset, and identify changed files that are relevant for localization (.properties, .dtd, .ini).</p>
<p>Things to look out for:</p>
<ul>
<li>Unclear strings and missing localization comments: the best way to identify them is to translate the strings, only having the string and comment as context (not the entire file, or the bug). For example: is the word used both a noun and a verb in English? Is the ID clear enough to give context (e.g. <code>buttonLabel</code>)?</li>
<li>String changes without new IDs.</li>
<li>Duplicated strings.</li>
<li><a href="https://mozilla-l10n.github.io/documentation/localization/dev_best_practices.html">Localization issues</a>, like misused plural forms, unclear comments, etc.</li>
</ul>
<p>In case of issues, you have two options:</p>
<ul>
<li>Ask sheriffs (via bug or <a href="https://chat.mozilla.org/#/room/#sheriffs:mozilla.org">Matrix in #sheriffs</a>) to back out the patch.</li>
<li>Ask clarifications in the bug, and decide if it’s worth to stop exposing new strings until the issue is fixed.</li>
</ul>
<h3 id="review-strings-landing-in-gecko-strings-quarantine"><a class="header" href="#review-strings-landing-in-gecko-strings-quarantine">Review strings landing in gecko-strings-quarantine</a></h3>
<p>The next step is to spot check changes landed in <a href="https://hg.mozilla.org/l10n/gecko-strings-quarantine/shortlog">gecko-strings-quarantine</a>. Here are some things to look out for:</p>
<ul>
<li>Check if a changeset is removing strings. This should happen only when a string landed in Nightly and was removed during the same cycle, or at the beginning of a release cycle when a group of strings becomes unused in all shipping versions.</li>
</ul>
<p><strong>IMPORTANT:</strong> Patches including Fluent migrations need to be kept in quarantine, and can only be pushed to <code>gecko-strings</code> following the process described in <a href="products/firefox_desktop/../firefox_desktop/fluent_migrations.html">this document</a>.</p>
<h3 id="run-compare-locales-against-gecko-strings"><a class="header" href="#run-compare-locales-against-gecko-strings">Run compare-locales against gecko-strings</a></h3>
<p>A good next step to check for issues is to run <a href="https://pypi.org/project/compare-locales/">compare-locales</a> against the <code>gecko-strings</code> repository.</p>
<p>First of all make sure that your environment is <a href="products/firefox_desktop/../../tools/mercurial/setting_mercurial_environment.html">correctly set up</a>, and update your local <code>mozilla-unified</code> clone.</p>
<p><code>compare-locales</code> needs to be installed on your system. You can either install a specific release, or clone the <a href="https://hg.mozilla.org/l10n/compare-locales/">hg repository</a> and install it via <code>pip install -e .</code>. You can check that <code>compare-locales</code> is running correctly by checking its version:</p>
<pre><code>$ compare-locales --version
compare-locales 8.1
</code></pre>
<p>Let’s assume that:</p>
<ul>
<li><a href="https://hg.mozilla.org/l10n/gecko-strings-quarantine">gecko-strings-quarantine</a> is cloned in <code>~/l10n/gecko-strings-quarantine</code>.</li>
<li><a href="https://hg.mozilla.org/mozilla-unified">mozilla-unified</a> is cloned in <code>~/src/mozilla-unified</code>, and you checked out the version corresponding to the converted changeset.</li>
</ul>
<p>Then run</p>
<pre><code>$ compare-locales --unified --full ~/src/mozilla-unified/browser/locales/l10n.toml ~/l10n gecko-strings-quarantine
</code></pre>
<p>When running these, you should see no errors or warnings. When running them against the central revisions, you should see no missing or changed strings, while having obsolete strings is expected. When running against beta or release revisions, expect to have changed strings, but again, no missing strings.</p>
<p>Note: when running compare-locales against a non-existing locale code, use the <code>--full</code> command line argument to get all strings in submodules. In particular for gecko-strings, you need that, otherwise you only get the strings in the <code>browser</code> directory.</p>
<h3 id="run-compare-locales-against-a-localization-repository"><a class="header" href="#run-compare-locales-against-a-localization-repository">Run compare-locales against a localization repository</a></h3>
<p>A good next step to check for issues is to run compare-locales against a localization repository frequently updated (Italian and French are good examples).</p>
<ul>
<li><a href="https://hg.mozilla.org/l10n-central/it">l10n-central/it</a> is cloned in <code>~/l10n/it</code>.</li>
</ul>
<p>To run compare-locales against <code>mozilla-unified</code> and Italian you can run:</p>
<pre><code>$ compare-locales --unified ~/src/mozilla-unified/browser/locales/l10n.toml ~/l10n it
</code></pre>
<p>To run compare-locales against <code>gecko-strings-quarantine</code> and Italian you can run:</p>
<pre><code>$ compare-locales --unified ~/l10n/gecko-strings-quarantine/_configs/browser.toml ~/l10n it
</code></pre>
<p>Both are really long commands, so it’s convenient to create Bash aliases in <code>~/.bash_profile</code> for them, e.g.</p>
<pre><code>cmp_moz=&quot;compare-locales --unified ~/src/mozilla-unified/browser/locales/l10n.toml ~/l10n it&quot;
cmp_mozx=&quot;compare-locales --unified ~/l10n/gecko-strings-quarantine/_configs/browser.toml ~/l10n it&quot;
</code></pre>
<p>Let’s start with the output of <code>compare-locales</code> against <code>gecko-strings-quarantine</code>: most of the time, it should only report missing strings. There will be obsolete strings only if a string was removed, which is a rare event in cross-channel.</p>
<p>For example, this is the output for a fully localized locale.</p>
<pre><code>$ compare-locales --unified ~/l10n/gecko-strings-quarantine/_configs/browser.toml ~/l10n it
it:
changed: 9914
changed_w: 52351
keys: 1383
unchanged: 883
unchanged_w: 1085
91% of entries changed
</code></pre>
<p>Check the results for duplicated strings and errors. For example, if a new error shows up for a missing variable, it’s likely that a string changed without a new ID and introduced new variables.</p>
<p>The output of <code>compare-locales</code> against <code>mozilla-unified</code> is going to contain a lot of noise, since it includes all strings that are obsolete for <code>mozilla-central</code>, but are still needed for other branches. If you’re interested in only seeing missing strings, i.e. strings that need to be added to the l10n repository, you can <code>grep</code> the results by piping the output to <code>egrep '^\s*\+'</code>.</p>
<pre><code>$ compare-locales --unified ~/src/mozilla-unified/browser/locales/l10n.toml ~/l10n it | egrep '^\s*\+'
</code></pre>
<h3 id="push-reviewed-strings-to-gecko-strings"><a class="header" href="#push-reviewed-strings-to-gecko-strings">Push reviewed strings to gecko-strings</a></h3>
<p>If there are no issues in <code>gecko-strings-quarantine</code> and no pending <a href="products/firefox_desktop/../firefox_desktop/fluent_migrations.html">Fluent migrations</a>, the next step is to push changes to <code>gecko-strings</code> and expose content to tools.</p>
<p>Before pushing, <a href="https://github.com/flodolo/scripts/blob/main/mozilla_l10n/gecko_strings/gecko-quarantine-diff.py">this script</a> can be used to compare the tip of the two repositories (it requires a local clone of <code>gecko-strings-quarantine</code>).</p>
<p>One time setup: after you cloned <code>gecko-strings-quarantine</code> on your system, you need to edit its <code>.hg/hgrc</code> file, and add <code>gecko-strings</code> as path. While you only need <code>https</code> for pulling the quarantine repository, you need <code>ssh</code> in order to push updates to <code>gecko-strings</code>.</p>
<p>The content of <code>~/l10n/gecko-strings-quarantine/.hg/hgrc</code> should be similar to this:</p>
<pre><code>[paths]
default = https://hg.mozilla.org/l10n/gecko-strings-quarantine
gecko-strings = ssh://hg.mozilla.org/l10n/gecko-strings
</code></pre>
<p>To push the current <code>default</code> to <code>gecko-strings</code>, from the <code>gecko-strings-quarantine</code> folder simply run:</p>
<pre><code>$ hg push -r default gecko-strings
</code></pre>
<p>Instead of <code>default</code>, you can also push a specific changeset, e.g.</p>
<pre><code>$ hg push -r 4c05bc050007 gecko-strings
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fluent-migrations"><a class="header" href="#fluent-migrations">Fluent migrations</a></h1>
<p><a href="https://firefox-source-docs.mozilla.org/l10n/migrations/index.html">Fluent migrations</a> are used to migrate existing translations from legacy formats (DTD, properties) to Fluent, or existing Fluent messages to new messages or different FTL files.</p>
<p>At the core of each migration there is a Python file, called <strong>migration recipe</strong>, that instructs the system on how to port existing translations to Fluent. Typically, a patch migrating content to Fluent will:</p>
<ul>
<li>Add new Fluent strings or files.</li>
<li>Remove obsolete strings.</li>
<li>Include a migration recipe.</li>
</ul>
<p>Once such patch lands in <code>mozilla-central</code>, it will be converted as part of the cross-channel generation, and pushed to a quarantine repository (<code>gecko-strings-quarantine</code>). At this point, this new content is not visible yet in <a href="https://pontoon.mozilla.org/">Pontoon</a>.</p>
<p>The goal of migrations is to port existing translations to the new format without forcing community to retranslate them. For that to happen, migrations need to be performed before the new strings are pushed to the official <code>gecko-strings</code> repository, and become available in Pontoon.</p>
<p>This means that patches including migrations should only be pushed from the quarantine repository to <code>gecko-strings</code> following the steps described in this document.</p>
<h2 id="running-fluent-migrations"><a class="header" href="#running-fluent-migrations">Running Fluent migrations</a></h2>
<p>This section of the document describes in detail which operations need to be performed in order to run migrations on over 150 Mercurial repositories for Firefox.</p>
<h3 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites</a></h3>
<p>Several access rights are required:</p>
<ul>
<li>Write access to <a href="https://hg.mozilla.org/l10n-central">l10n-central</a>, i.e. SSH access with <code>active_scm_l10n</code> rights. It’s possible to check your <em>Access Groups</em> in <a href="https://people.mozilla.org/e#nav-access-groups">your profile on people.mozilla.org</a>.</li>
<li>Admin access to <a href="https://pontoon.mozilla.org/">Pontoon</a>.</li>
<li>An account on Heroku with access to <a href="https://dashboard.heroku.com/apps/mozilla-pontoon/resources">Pontoon apps</a>.</li>
</ul>
<p>In order to run migrations:</p>
<ul>
<li>Install the <a href="https://pypi.org/project/fluent.migrate/">fluent.migrate</a> Python package.</li>
<li>Clone all <a href="https://hg.mozilla.org/l10n-central">l10n-central</a> repositories.</li>
<li>Clone <a href="https://hg.mozilla.org/l10n/gecko-strings-quarantine/">gecko-strings-quarantine</a> and <a href="https://hg.mozilla.org/l10n/gecko-strings">gecko-strings</a>.</li>
</ul>
<p>A set of scripts to automate cloning and updating of the l10n-central repositories is <a href="https://github.com/flodolo/scripts/tree/master/mozilla_l10n/clone_hgmo">available here</a>.</p>
<h3 id="ensure-there-are-no-blocking-issues-in-gecko-strings-quarantine"><a class="header" href="#ensure-there-are-no-blocking-issues-in-gecko-strings-quarantine">Ensure there are no blocking issues in gecko-strings-quarantine</a></h3>
<p>As part of migrations, content needs to be pushed from the quarantine repository to <code>gecko-strings</code>. Since content can’t be pushed selectively, any pending issue needs to be solved before starting the process (eventually backing out problematic changes). For more information about the review process, see <a href="products/firefox_desktop/review.html">this document</a>.</p>
<h3 id="stop-sync-in-pontoon"><a class="header" href="#stop-sync-in-pontoon">Stop sync in Pontoon</a></h3>
<p>Before starting the migration process, sync needs to be suspended for Firefox from the <a href="https://pontoon.mozilla.org/admin/projects/firefox/">admin panel</a> by selecting the checkbox <code>SYNC DISABLED</code> at the bottom of the page, then clicking <code>SAVE PROJECT</code>.</p>
<p>This is needed for several reasons:</p>
<ul>
<li>It removes the chance of conflicts in the l10n repository between the running migration and Pontoon committing changes for other projects.</li>
<li>The migrated strings need to be added in the same cycle as the new strings for the source language (<code>en-US</code>). If they’re added before, Pontoon will ignore them, creating a misalignment between internal database and l10n repositories. If they’re added after, these strings will be displayed as missing in Pontoon, and some locales might try to translate them while it’s not needed.</li>
</ul>
<p>The last step here is to make sure that the current sync process has completed:</p>
<ul>
<li>Check the <a href="https://pontoon.mozilla.org/sync/log/">Sync Logs</a> page, click on the last one, and make sure that there are no projects with <code>---</code> in the <code>DURATION</code> field.</li>
</ul>
<h3 id="test-the-migrations-locally"><a class="header" href="#test-the-migrations-locally">Test the migrations locally</a></h3>
<p>A series of tools and helpers to run migrations is available in <a href="https://github.com/flodolo/fluent-migrations">this repository</a>:</p>
<ul>
<li>Clone the repository locally and follow the instructions available in the <a href="https://github.com/flodolo/fluent-migrations/blob/master/README.md">README</a> to set the configuration file.</li>
<li>Add the new migration recipes in the <code>recipes</code> folder. The script will look for any Python file starting with <code>bug_</code> in that folder, so it’s possible to run multiple migrations in one pass. More information about the folder’s structure are available in the repository’s README.</li>
</ul>
<p>At this point, while each migration has been tested as part of the review before landing, it’s always good to run the migration against one locale, e.g. <code>it</code>:</p>
<ul>
<li>Update the locale’s repository, check the results of <code>compare-locales</code>. Assuming l10n repositories are cloned in <code>~/migrations/locales</code>, and the quarantine repository in <code>~/migrations/gecko-strings-quarantine</code>, the command to run is <code>compare-locales ~/migrations/gecko-strings-quarantine/_configs/browser.toml ~/migrations/locales it</code>. Save the output in order to compare it with the results after the migration.</li>
<li>Run the migration, without pushing, only for <code>it</code>: <code>./scripts/migrate it wet-run</code>. Then run compare-locales again, and check if the results are as expected: migrated strings should not appear as missing anymore, and there should be no errors.</li>
<li>If everything looks as expected, re-run the script adding the push option <code>./scripts/migrate it wet-run push</code>.</li>
</ul>
<h3 id="push-updates-to-gecko-strings"><a class="header" href="#push-updates-to-gecko-strings">Push updates to gecko-strings</a></h3>
<p>Before <a href="products/firefox_desktop/review.html#push-reviewed-strings-to-gecko-strings">pushing updates</a> to the official <a href="https://hg.mozilla.org/l10n/gecko-strings">gecko-strings repository</a>, make sure that:</p>
<ul>
<li>The new strings and migrations are available in the <a href="https://hg.mozilla.org/l10n/gecko-strings-quarantine">quarantine repository</a>.</li>
<li>There are <a href="products/firefox_desktop/fluent_migrations.html#ensure-there-are-no-blocking-issues-in-gecko-strings-quarantine">no pending issues</a> that prevent the current content to be exposed in Pontoon.</li>
<li>The migration has been tested locally and works as expected.</li>
</ul>
<p>Once the new strings are pushed to <code>gecko-strings</code>, there’s no easy way to roll back, and the procedure needs to be completed before re-enabling sync in Pontoon. The alternative is forcing all locales to retranslate this content, and losing the entire benefit of migrations.</p>
<p>Pontoon relies on a <a href="https://hg.mozilla.org/users/m_owca.info/firefox-central/">different repository</a>, that is generated every 20 minutes based on the content of <code>gecko-strings</code>. That’s why it’s useful to run this update before starting the actual migrations.</p>
<h3 id="run-migrations"><a class="header" href="#run-migrations">Run migrations</a></h3>
<p>To run the migration on all repositories, use <code>./scripts/migrate wet-run push</code> in the same environment used for testing. For each repository, this will:</p>
<ul>
<li>Pull changes.</li>
<li>Run the migration and commit changes.</li>
<li>Push changes to the remote.</li>
</ul>
<p>The duration of this step depends on the number of migrations and the speed of the Internet connection, but it should take about 20-30 minutes.</p>
<p>While migrations run, it’s important to look out for errors in the console, even if the standard output is quite noisy:</p>
<ul>
<li>Python errors with a stack trace are unlikely at this stage of the development, since it means that the code encountered a scenario that it’s unable to manage. If something is broken in the <code>fluent.migrate</code> package, or there are issues with Python dependencies, the migration should stop at the very beginning.</li>
<li>For Mercurial, one potential error scenario is a push that would create a new head in the remote repository (<code>abort: push creates new remote head</code>, followed by a changeset ID). The script automatically pulls from the remote repository before running migrations, and Pontoon’s sync is disabled, so that shouldn’t happen, unless a previous migration failed to push to remote and left unsynced local commits. In this case, the easiest solution is to clone the repository for this locale from scratch, and run the migration only for that specific locale.</li>
</ul>
<h3 id="re-enable-sync-in-pontoon"><a class="header" href="#re-enable-sync-in-pontoon">Re-enable Sync in Pontoon</a></h3>
<p>Once the actual migration is complete, the next step is to re-enable sync in Pontoon. Before starting, make sure that the <a href="https://hg.mozilla.org/users/m_owca.info/firefox-central/">Pontoon repository</a> has a commit with the new strings.</p>
<ul>
<li>Access the <a href="https://pontoon.mozilla.org/admin/projects/firefox/">admin panel for Firefox</a>, click the <code>SYNC</code> button at the bottom, then deselect <code>SYNC DISABLED</code> and click <code>SAVE PROJECT</code>.</li>
<li>Clicking the <code>SYNC</code> button will spawn a new sync process just for Firefox. Check the <a href="https://pontoon.mozilla.org/sync/log/">Sync Logs</a> page to see when it’s finished. Depending on the amount of changes, this can require from 15 to over 30 minutes. It’s also possible to monitor the status in Papertrail, accessible from the <a href="https://dashboard.heroku.com/apps/mozilla-pontoon/resources">Resources</a> page in Heroku, and filter the log using the string <code>app/worker</code>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="build-system-details-for-firefox-desktop"><a class="header" href="#build-system-details-for-firefox-desktop">Build system details for Firefox desktop</a></h1>
<ul>
<li><a href="products/firefox_desktop/build_system.html#overview">Overview</a></li>
<li><a href="products/firefox_desktop/build_system.html#timeline-and-deadlines">Timeline and deadlines</a>
<ul>
<li><a href="products/firefox_desktop/build_system.html#updating-release">Updating release</a></li>
</ul>
</li>
</ul>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Thanks to <a href="https://firefox-source-docs.mozilla.org/l10n/crosschannel/index.html">cross-channel</a>, we ship all versions of Firefox from a <a href="https://hg.mozilla.org/l10n-central/">single localization repository</a>, but each channel uses a different snapshot in time of that repository.</p>
<p>A job, called <code>l10n-bumper</code>, runs on Taskcluster every hour, and stores information on the l10n changesets to use for each build in a file called <code>l10n-changesets.json</code>:</p>
<ul>
<li>For Nightly (<code>mozilla-central</code>), <a href="https://hg.mozilla.org/mozilla-central/file/default/browser/locales/l10n-changesets.json">l10n-changesets.json</a> always uses the revision <code>default</code>, and it’s only updated when changing the locales available in the build.</li>
<li>Beta builds (<code>mozilla-beta</code>) still use the tip of the l10n repository, but the actual hash is stored in <a href="https://hg.mozilla.org/releases/mozilla-beta/file/default/browser/locales/l10n-changesets.json">l10n-changesets.json</a> instead of <code>default</code>.</li>
<li>Before Release Candidate week, the <code>l10n-bumper</code> is <a href="https://github.com/mozilla/build-relengdocs/blob/master/procedures/release-duty/merge-duty/merge_duty.rst#turn-off-beta-l10n-bumper-on-rc-day">manually stopped</a> on <code>mozilla-beta</code>. Since the configuration change lands only on <code>mozilla-beta</code>, the <code>l10n-bumper</code> will automatically restart at the beginning of the next cycle, when the standard configuration is uplifted from <code>mozilla-central</code>.</li>
<li>When the Beta code is merged to Release, <a href="https://hg.mozilla.org/releases/mozilla-release/file/default/browser/locales/l10n-changesets.json">l10n-changesets.json</a> moves together with the rest of the code to <code>mozilla-release</code>. That means that Release builds will use the same changesets as the last beta with the same version number, and any further change <a href="products/firefox_desktop/build_system.html#updating-release">requires code uplifts</a>.</li>
</ul>
<h2 id="timeline-and-deadlines"><a class="header" href="#timeline-and-deadlines">Timeline and deadlines</a></h2>
<p>This is how Beta looks like in a 4 weeks release cycle, with relevant milestones.</p>
<p><img src="products/firefox_desktop/../../assets/images/build_system/beta_cycle.png" alt="Beta cycle" /></p>
<p>On Monday, 8 days before the release, the <code>l10n-bumper</code> will stop updating <code>l10n-changesets.json</code> on <code>mozilla-beta</code>.</p>
<p>Once the code merges from Beta to Release, any changeset update would require a manual uplift to <code>mozilla-release</code> and a new Release Candidate (RC) build.</p>
<p><img src="products/firefox_desktop/../../assets/images/build_system/all_channels_timeline.png" alt="Timeline of all channels, 2 cycles" /></p>
<h3 id="updating-release"><a class="header" href="#updating-release">Updating release</a></h3>
<p>When the code moves from <code>mozilla-beta</code> to <code>mozilla-release</code>, <code>l10n-changesets.json</code> is frozen, as <code>l10n-bumper</code> is not configured to run against the release branch.</p>
<p>In case of severe issues affecting one or more locales, it’s still possible to manually update the shipping changesets. A patch needs to be provided for <code>l10n-changesets.json</code> in <code>mozilla-release</code> branch and approved for uplift by Release Drivers (see for example <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1513259">this bug</a> and <a href="https://hg.mozilla.org/releases/mozilla-release/rev/308fd26a204e">associated patch</a>). Note that a dot release is needed in order to ship the updated version to users. <a href="https://github.com/flodolo/scripts/blob/master/mozilla_l10n/validate_fx_changesets_uplift/fx_release_changesets.py">This script</a> can be used to validate the updated JSON.</p>
<p>The same process applies to ESR versions, as long as the associated esr repository is included in the <a href="https://hg.mozilla.org/mozilla-unified/file/tip/python/l10n/mozxchannel/__init__.py">current version of cross-channel</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firefox-l10n-faqs"><a class="header" href="#firefox-l10n-faqs">Firefox L10N FAQs</a></h1>
<p>This document includes a series of frequently asked questions regarding Firefox and localization, mostly targeted at developers, but useful for product managers and engineering program managers as well.</p>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#general">General</a>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#who-can-i-contact-if-i-have-more-questions">Who can I contact if I have more questions?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#should-i-enable-my-feature-only-for-english-or-ship-it-in-english-for-everyone">Should I enable my feature only for English, or ship it in English for everyone?</a></li>
</ul>
</li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#builds-and-distribution">Builds and distribution</a>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-can-users-get-localized-builds">How can users get localized builds?</a></li>
</ul>
</li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#schedule-and-release-cycle">Schedule and release cycle</a>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#i-landed-strings-in-mozilla-central-when-are-they-going-to-be-localized">I landed strings in mozilla-central, when are they going to be localized?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-uplift-a-patch-to-beta-or-release">Can I uplift a patch to Beta or Release?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#i-need-to-add-new-strings-for-version-x-when-is-the-deadline">I need to add new strings for version X: when is the deadline?</a></li>
</ul>
</li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#development">Development</a>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#where-can-i-find-guidelines-for-developers">Where can I find guidelines for developers?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-can-i-get-my-strings-localized">How can I get my strings localized?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#where-can-i-find-the-localized-strings">Where can I find the localized strings?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-land-content-without-exposing-it-for-localization">Can I land content without exposing it for localization?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-get-content-translated-only-in-selected-languages">Can I get content translated only in selected languages?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-restore-an-old-string">Can I restore an old string?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#should-i-remove-obsolete-or-unused-strings">Should I remove obsolete or unused strings?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-can-i-test-a-different-locale">How can I test a different locale?</a></li>
</ul>
</li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#translation-completion-and-community">Translation completion and community</a>
<ul>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#is-my-feature-going-to-be-localized-in-language-x-before-launch">Is my feature going to be localized in language X before launch?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-do-i-communicate-with-localizers-about-my-feature-or-patch">How do I communicate with localizers about my feature or patch?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#i-see-pending-suggestions-in-pontoon-how-can-i-get-them-approved">I see pending suggestions in Pontoon, how can I get them approved?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-can-i-check-if-my-feature-is-localized">How can I check if my feature is localized?</a></li>
<li><a href="products/firefox_desktop/firefox_l10n_faqs.html#how-can-i-see-all-translations-available-for-a-specific-string">How can I see all translations available for a specific string?</a></li>
</ul>
</li>
</ul>
<h2 id="general"><a class="header" href="#general">General</a></h2>
<h3 id="who-can-i-contact-if-i-have-more-questions"><a class="header" href="#who-can-i-contact-if-i-have-more-questions">Who can I contact if I have more questions?</a></h3>
<p>A Program Manager (L10N PM) is assigned to any Mozilla project that is localized through community. You can find this information in <a href="https://pontoon.mozilla.org/projects/firefox/">Pontoon</a> for any project in the header section, and more information about the localization team is available in the Confluence page dedicated to <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation">Localization</a> (available to Mozilla staff only).</p>
<h3 id="should-i-enable-my-feature-only-for-english-or-ship-it-in-english-for-everyone"><a class="header" href="#should-i-enable-my-feature-only-for-english-or-ship-it-in-english-for-everyone">Should I enable my feature only for English, or ship it in English for everyone?</a></h3>
<p>Shipping a feature only for en-US is not great, since it creates confusion for users: features are described in SUMO articles or publicized in blog posts, but not available for more than 60% of Firefox user base.</p>
<p>Shipping a feature in English for everyone is not a good option either: as an English speaker, imagine starting your browser and finding a window in Chinese.</p>
<p>In the end, both options are a product decision, and the localization team can help assess the impact on users and community. How to ship a feature only to en-US users depends on several factors (technology, information available at the time the feature is loaded, etc.), and the best approach is to get in touch with the <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation">engineering part of the Localization team</a> (aka “tech team”).</p>
<h2 id="builds-and-distribution"><a class="header" href="#builds-and-distribution">Builds and distribution</a></h2>
<h3 id="how-can-users-get-localized-builds"><a class="header" href="#how-can-users-get-localized-builds">How can users get localized builds?</a></h3>
<p>Unlike mobile products, where we ship multilingual builds by default and users can simply switch language from the app or OS settings (e.g. for iOS), for Firefox there are several ways to get a localized build, independently from the platform:</p>
<ul>
<li>From mozilla.org it’s possible to download a localized build that includes a specific language (e.g. French) — for all versions of Firefox (Nightly, Developer Edition, Beta, Release, ESR). These are frequently referenced to as <em>repacks</em>, because this type of build is generated by unpacking the en-US build, injecting localized strings, and repackaging everything in a shippable format for each platform. For some locales, these builds also include a dictionary for spell checking, depending on the availability of a dictionary with <a href="https://wiki.mozilla.org/L10n:Dictionaries">suitable license</a>.</li>
<li>On Beta, Release, and ESR users can also <a href="https://support.mozilla.org/en-US/kb/use-firefox-another-language">switch Firefox to another language from Settings</a>, e.g. they download a build in English and then switch to French. Under the hood, this downloads and installs a <em>language pack</em> from addons.mozilla.org (AMO) for the requested language, and also installs dictionaries if they’re available for that locale.
<ul>
<li>Language packs are a specific type of extension that only includes localized strings, no additional code. They’re generated by the build system and uploaded to AMO via automation. Note that only official Mozilla language packs can be hosted on AMO.</li>
<li>The list of dictionaries is manually curated and stored in <a href="https://firefox.settings.services.mozilla.com/v1/buckets/main/collections/language-dictionaries/records">remote-settings</a>.</li>
</ul>
</li>
<li>On Release and ESR, users can also <a href="https://addons.mozilla.org/firefox/language-tools/">manually download language packs</a> from AMO and set the preferred locale manually in <code>about:config</code>.</li>
</ul>
<p>While it’s important to note that there’s no real multilingual package for Firefox — builds always include one locale, and more can be added using language packs — there are also platform specific distribution systems that work around this limit:</p>
<ul>
<li>MSIX (Windows)</li>
<li>Flatpak (Linux)</li>
<li>Snap (Ubuntu Linux)</li>
</ul>
<p>All available language packs are distributed as part of the package, but only a subset is installed based on the OS locale settings. All of these systems then rely on the the preference <code>intl.locale.requested</code> set to an empty string to <a href="https://firefox-source-docs.mozilla.org/intl/locale.html#requested-locales">automatically match</a> the OS language.</p>
<p>These approaches allow to ship one package and support multiple languages, but there are known limitations (e.g. dictionaries are not included, and language packs cannot translate some parts of the UI).</p>
<h2 id="schedule-and-release-cycle"><a class="header" href="#schedule-and-release-cycle">Schedule and release cycle</a></h2>
<h3 id="i-landed-strings-in-mozilla-central-when-are-they-going-to-be-localized"><a class="header" href="#i-landed-strings-in-mozilla-central-when-are-they-going-to-be-localized">I landed strings in mozilla-central, when are they going to be localized?</a></h3>
<p>New string changes are exported twice a day from mozilla-central into a repository called <code>gecko-strings-quarantine</code>, a unified repository that includes strings for all shipping versions of Firefox (nightly, beta, release). This repository is used as a buffer to avoid exposing potential issues to all locales working on Firefox.</p>
<p>Typically once or twice a week, the content of the quarantine repository is pushed to the official repository, called <code>gecko-strings</code>, used by <a href="https://pontoon.mozilla.org/projects/firefox/">Pontoon</a> as source reference. At this point, strings can be localized by community.</p>
<h3 id="can-i-uplift-a-patch-to-beta-or-release"><a class="header" href="#can-i-uplift-a-patch-to-beta-or-release">Can I uplift a patch to Beta or Release?</a></h3>
<p>While Nightly is always open for new strings, Beta and Release are string frozen, meaning that patches with new strings are normally not allowed to land.</p>
<p>Uplifts need to be evaluated case by case, but in general they should be avoided in the context of a 4-weeks release cycle. Possible alternatives are uplifting ad-hoc patches without string changes, or exposing the feature/change only to English users.</p>
<p>One more thing to consider is the timing of the uplift. The second part of the Beta cycle is completely frozen, meaning that we can’t take any updates to localization and ship it in that version. Anything uplifted close to the deadline, or after, will ship untranslated. For more details about the Beta timeline for l10n, see the <a href="products/firefox_desktop/build_system.html#timeline-and-deadlines">Build system document</a>.</p>
<h3 id="i-need-to-add-new-strings-for-version-x-when-is-the-deadline"><a class="header" href="#i-need-to-add-new-strings-for-version-x-when-is-the-deadline">I need to add new strings for version X: when is the deadline?</a></h3>
<p>If version X is in Nightly, i.e. currently developed in mozilla-central, there is time to land until merge day, when the code moves from mozilla-central to mozilla-beta. Technically, the string freeze date is on the Friday before merge day, to account for possible back-outs, l10n reviews needed, etc.</p>
<p>The sooner you land content in mozilla-central, the higher will be the chances that the content will be localized in several languages before reaching release.</p>
<p>A webapp is <a href="https://fx-trains.herokuapp.com/release/">available here</a> with all the deadlines, including string freeze start, for current and future versions of Firefox (use the <code>«</code> and <code>»</code> near the title to change version).</p>
<h2 id="development"><a class="header" href="#development">Development</a></h2>
<h3 id="where-can-i-find-guidelines-for-developers"><a class="header" href="#where-can-i-find-guidelines-for-developers">Where can I find guidelines for developers?</a></h3>
<p>A document including plenty of best practices is <a href="products/firefox_desktop/../../localization/dev_best_practices.html">available here</a>, while specific information around Fluent is available <a href="https://firefox-source-docs.mozilla.org/l10n/fluent/review.html">in this document</a>. In case of doubts, reach out to the Firefox L10N PM or localization team for clarifications.</p>
<h3 id="how-can-i-get-my-strings-localized"><a class="header" href="#how-can-i-get-my-strings-localized">How can I get my strings localized?</a></h3>
<p>Strings need to be added to localization files in known locations within the mozilla-central tree. For all the technical details about these paths and the supported formats, see <a href="https://firefox-source-docs.mozilla.org/build/buildsystem/locales.html#exposing-strings">this document</a>.</p>
<p>Once strings land in mozilla-central, they will be exposed for localization in Pontoon within a few days.</p>
<h3 id="where-can-i-find-the-localized-strings"><a class="header" href="#where-can-i-find-the-localized-strings">Where can I find the localized strings?</a></h3>
<p>All shipping versions of Firefox are built from a single Mercurial repository for each locale (<code>l10n-central</code>). Repositories are available <a href="https://hg.mozilla.org/l10n-central/">here</a>.</p>
<h3 id="can-i-land-content-without-exposing-it-for-localization"><a class="header" href="#can-i-land-content-without-exposing-it-for-localization">Can I land content without exposing it for localization?</a></h3>
<p>If your content is not stable, or you want to iterate quickly over it before exposing it for localization, it’s possible to land a string file outside of the known paths, and access it from the code.</p>
<p>For Fluent, you can follow examples like <a href="https://hg.mozilla.org/mozilla-central/rev/e3bc9f1bde6e">this patch</a>, where the FTL file is stored outside of the localizable paths, and loaded as “preview”.</p>
<p>If you follow this approach, make sure to have a bug on file — or an explicit task in your roadmap — to expose this file to localization with sufficient lead time for translation before the targeted release.</p>
<h3 id="can-i-get-content-translated-only-in-selected-languages"><a class="header" href="#can-i-get-content-translated-only-in-selected-languages">Can I get content translated only in selected languages?</a></h3>
<p>No, the existing infrastructure only allows to expose strings to all locales. If a feature is exposed for localization, it will get localized in all supported languages.</p>
<h3 id="can-i-restore-an-old-string"><a class="header" href="#can-i-restore-an-old-string">Can I restore an old string?</a></h3>
<p>It’s always possible to restore an old string that was removed from code, as long as the text remains the same, and the string is used exactly in the same context.</p>
<p>It might also be possible to uplift the patch if the string is still available in the <a href="https://hg.mozilla.org/l10n/gecko-strings">gecko-string repository</a>. <code>gecko-strings</code> is a repository with a <a href="https://firefox-source-docs.mozilla.org/l10n/crosschannel/index.html">superset</a> of strings from all <a href="https://hg.mozilla.org/mozilla-unified/file/tip/python/l10n/mozxchannel/__init__.py#l31">supported versions</a> of Firefox: nightly, beta, release, ESR.</p>
<p>Consider this example:</p>
<ul>
<li>The original string landed in Firefox 85, and was removed later in Firefox 92.</li>
<li>The list of support versions in cross-channel includes: ESR91, 92, 93, 94.</li>
<li>The string is restored in Firefox 94.</li>
</ul>
<p>The string will still be available in <code>gecko-strings</code> until ESR91 becomes unsupported, since the string was removed after that release (in Firefox 92). This patch could be uplifted without creating any issue to localization (it would be a <em>no-op</em>).</p>
<p>If the string is not available anymore, this is effectively a new string, and must be <a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-uplift-a-patch-to-beta-or-release">treated as such</a>.</p>
<h3 id="should-i-remove-obsolete-or-unused-strings"><a class="header" href="#should-i-remove-obsolete-or-unused-strings">Should I remove obsolete or unused strings?</a></h3>
<p>Strings that are unused, or become obsolete as a consequence of code changes, should always be removed from the <code>en-US</code> files. Tools like Pontoon will remove them from localized files once these strings are not used in any supported version of Firefox (see the <a href="products/firefox_desktop/firefox_l10n_faqs.html#can-i-restore-an-old-string">previous question</a> for more details).</p>
<p>It might seem useful to keep them around — we could use them again later and it would spare localizers some time — but there’s no guarantee that the new context and usage will be exactly the same. Removing them also prevents new locales, or locales that fell behind over time, from working on translations that will never be used.</p>
<h3 id="how-can-i-test-a-different-locale"><a class="header" href="#how-can-i-test-a-different-locale">How can I test a different locale?</a></h3>
<p>The answer depends on the version you want to test.</p>
<p>Official builds:</p>
<ul>
<li>On Beta and Release, you can switch the UI language directly from Firefox settings. You can also download localized builds <a href="http://www.mozilla.org/firefox/all">from mozilla.org</a>.</li>
<li>On Nightly and Developer Edition this feature is disabled, since language packs are not reliable. You can still manually install language packs for the version you’re using directly from FTP (<a href="http://ftp.mozilla.org/pub/firefox/nightly/latest-mozilla-central-l10n/linux-x86_64/xpi/">Nightly</a>, <a href="http://archive.mozilla.org/pub/devedition/releases/77.0b2/win64/xpi/">DevEdition</a> changing the build in the URL), then enable the language switcher by setting <code>intl.multilingual.enabled</code> to <code>True</code> in about:config.</li>
</ul>
<p>Local builds:</p>
<ul>
<li>If you’re using Fluent, you can test your feature for localizability issues, like layout constraints or hardcoded content, using <a href="https://firefox-source-docs.mozilla.org/l10n/fluent/tutorial.html#pseudolocalization">pseudolocales</a>.</li>
<li>If you’re building locally, you can try installing the latest language pack for Nightly (it might not work as expected if you’re adding new strings, or break after an update). Language packs are stored on FTP inside the <code>linux-x86_64/xpi/</code> folder for daily builds, or <a href="http://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central-l10n/linux-x86_64/xpi/">latest-mozilla-central-l10n</a>.</li>
<li>You can <a href="https://firefox-source-docs.mozilla.org/build/buildsystem/locales.html#instructions-for-single-locale-repacks-for-developers">build directly in a different locale</a> (no support for artifact builds).</li>
<li>It’s possible to add specific l10n repacks to a <a href="https://wiki.mozilla.org/ReleaseEngineering/TryServer#Scheduling_jobs_with_Treeherder">Try Server</a> push. For example, to add French: select <em>Add new Jobs</em>, then select the <code>fr</code> locale in <code>L10n-Rpk</code>. Once the job is completed, builds will be available as artifacts under <code>L10n (BsX)</code>, where <code>X</code> changes depending on the locale.</li>
</ul>
<h2 id="translation-completion-and-community"><a class="header" href="#translation-completion-and-community">Translation completion and community</a></h2>
<h3 id="is-my-feature-going-to-be-localized-in-language-x-before-launch"><a class="header" href="#is-my-feature-going-to-be-localized-in-language-x-before-launch">Is my feature going to be localized in language X before launch?</a></h3>
<p>Each community will localize new content at different times: some locales will have a complete localization within hours, while others might take weeks or months. Our continuous localization infrastructure allows us to release Firefox with incomplete translations falling back on a backup locale in case of missing strings or errors.</p>
<p>Given that localization is managed by community volunteers, there is no SLA or guarantee that a product will be completely localized before launch. For more information, see <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation">this page on Confluence</a> (available to Mozilla staff only).</p>
<h3 id="how-do-i-communicate-with-localizers-about-my-feature-or-patch"><a class="header" href="#how-do-i-communicate-with-localizers-about-my-feature-or-patch">How do I communicate with localizers about my feature or patch?</a></h3>
<p>If there is some specific information that you want to convey to localizers, like testing instructions or particular issues to look out for, get in touch with the <a href="products/firefox_desktop/firefox_l10n_faqs.html#who-can-i-contact-if-i-have-more-questions">L10N PM for Firefox</a>. They will help you identify the best channel and way to relay this information.</p>
<h3 id="i-see-pending-suggestions-in-pontoon-how-can-i-get-them-approved"><a class="header" href="#i-see-pending-suggestions-in-pontoon-how-can-i-get-them-approved">I see pending suggestions in Pontoon, how can I get them approved?</a></h3>
<p>Standard users in Pontoon can only provide suggestions: these translations are visible in Pontoon, but don’t get committed to repositories or ship in products.</p>
<p>For each locale there are translators and managers that can review these suggestions, and eventually approve them. The timing depends on each locale’s workflow.</p>
<h3 id="how-can-i-check-if-my-feature-is-localized"><a class="header" href="#how-can-i-check-if-my-feature-is-localized">How can I check if my feature is localized?</a></h3>
<p>There’s no easy way to see this information in Pontoon. If all the strings are stored in a single file, only used for that feature, or you have a detailed list of all the strings used, it’s possible to extract this data manually. Get in touch with the <a href="products/firefox_desktop/firefox_l10n_faqs.html#who-can-i-contact-if-i-have-more-questions">Firefox L10N PM</a> for more information.</p>
<h3 id="how-can-i-see-all-translations-available-for-a-specific-string"><a class="header" href="#how-can-i-see-all-translations-available-for-a-specific-string">How can I see all translations available for a specific string?</a></h3>
<p>Pontoon doesn’t allow to see all translations for a specific string, but you can use <a href="https://transvision.mozfr.org/">Transvision</a> for it:</p>
<ul>
<li>Search for the string (by ID or text), making sure that <code>Firefox</code> is selected as repository.</li>
<li>In the results, click on the green <code>all locales</code> tag close a string to see all available translations. Results are also available via API (linked at the bottom of the page).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="localization"><a class="header" href="#localization">Localization</a></h1>
<ul>
<li><a href="localization/making_string_changes.html">Making changes to existing strings</a></li>
<li><a href="localization/dev_best_practices.html">Localization best practices for developers</a></li>
<li><a href="localization/dev_best_practices.html">Globalization best practices for product managers</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="making-changes-to-existing-strings"><a class="header" href="#making-changes-to-existing-strings">Making changes to existing strings</a></h1>
<h2 id="string-identifiers"><a class="header" href="#string-identifiers">String identifiers</a></h2>
<p>In most localization formats, a translation unit consists of a unique identifier (ID, often <em>string ID</em> or <em>message ID</em>) associated to a segment of text. For example, in the following Fluent snippet, the text <code>Cancel</code> is stored in a message with ID <code>cancel-button</code>.</p>
<pre><code>cancel-button = Cancel
</code></pre>
<p>The same concept applies to legacy formats like DTD or properties, or XML in Android.</p>
<pre><code class="language-XML">    # DTD
    &lt;!ENTITY cancelButton &quot;Cancel&quot;&gt;

    # Android XML
    &lt;string name=&quot;cancel_button&quot;&gt;Cancel&lt;/string&gt;
</code></pre>
<h2 id="general-guidelines"><a class="header" href="#general-guidelines">General guidelines</a></h2>
<p>These are the general guidelines to follow when updating existing strings already exposed for localization:</p>
<ul>
<li>If you are changing a string such that its <strong>meaning has changed</strong>, you must update the string ID.</li>
<li>In case of Fluent, you need to update the string ID also when <strong>the morphology of the message changes</strong>, i.e. attributes are added or removed.</li>
<li>If your changes are relevant only for English — for example, to correct a typographical error or to make capitalization consistent — then there is generally no need to update the string ID.</li>
</ul>
<p>There is a gray area between needing a new ID or not. In some cases, it will be necessary to look at all the existing translations to determine if a new ID would be beneficial. You should always reach out to the l10n team in case of doubt.</p>
<p>As for which new ID to use, versioning – adding a number, e.g. <code>cancel-button2</code> – should be only used as a last resource when better IDs are not available.</p>
<p>When updating IDs, make sure to also update references to the old ID in both existing code and comments.</p>
<h2 id="why-is-it-necessary-to-use-new-ids"><a class="header" href="#why-is-it-necessary-to-use-new-ids">Why is it necessary to use new IDs?</a></h2>
<p>This is very specific to how localization works at Mozilla, and mostly depends on two key elements:</p>
<ul>
<li>String IDs (and not their values) are used to identify strings throughout the entire localization toolchain.</li>
<li>Translations stored in Version Control Systems – Mercurial or GitHub depending on the project – are treated as the <strong>source of truth</strong>.</li>
</ul>
<p>Changing the message ID will invalidate existing translations, the new message will be reported as missing (new) in all tools, and localizers will have to retranslate it. This is the only reliable method to ensure that localizers update existing localizations, and run-time stops using obsolete translations.</p>
<h3 id="generic-localized-product"><a class="header" href="#generic-localized-product">Generic localized product</a></h3>
<p>Let’s consider the simplest scenario for a localized product, using a single repository for storing both the source locale (en-US) and other localizations.</p>
<pre><code>password-notification = Please enter your master password
</code></pre>
<p>This message needs to be updated to <code>Please enter your primary password</code>. This is the type of change that we want to be reflected in all locales, so we create a new string, with a different ID:</p>
<pre><code>primary-password-notification = Please enter your primary password
</code></pre>
<p>The localization toolchain considers this a brand new string and notifies localizers that it requires translation. Pontoon leverages the prior translation, so that the localizer only has to translate the diff (e.g., “Please enter your password” would be leveraged, the localizer would only need to add “primary”). The downside, however, is that it requires more work for developers to update references in code.</p>
<p><img src="localization/../assets/images/localization/string_changes_simple_start.png" alt="Generic product: starting point with existing string" /></p>
<p>The picture above shows a snapshot of the situation before the string change:</p>
<ul>
<li>Both source strings (en-US) and localizations are stored in a single repository. For simplicity, only two locales are displayed (French and Italian).</li>
<li>The string with its translations is also stored in our internal localization tool, <a href="https://pontoon.mozilla.org/">Pontoon</a>.</li>
<li>The build system is using the content stored in the localization repository to build localized versions of the product. At run-time, code is going to query the string with ID <code>password-notification</code>, and show the available translation or fall back to English if that’s missing (the fallback logic and its complexity heavily depends on the product).</li>
</ul>
<p>Note that this is still a simplification of a real-life product:</p>
<ul>
<li>The <code>en-US</code> content would be exported periodically from the product’s code repository.</li>
<li>Both localization and code repositories would be used to build and deploy.</li>
<li>Pontoon only reads the source locale, but can both read and write localizations.</li>
</ul>
<p>What happens if we change the message without using a new string ID?</p>
<pre><code>password-notification = Please enter your primary password
</code></pre>
<p><img src="localization/../assets/images/localization/string_changes_simple_change.png" alt="Generic product: change without new ID" /></p>
<p>At this point:</p>
<ul>
<li>The en-US product will start using the new message (in red) right away.</li>
<li>Pontoon will read the updated message, but won’t invalidate existing translations (in green) or notify localizers. Remember that there are cases, e.g. fixing typos, where this is a desired behavior.</li>
<li>The l10n repository will keep storing older translations (in green), although they are likely obsolete at this point.</li>
<li>Both run-time and build system won’t know anything about the different versions of this string, they won’t be able to differentiate values that were updated from those that are obsolete and use that information for the fallback logic.</li>
</ul>
<p>As explained before, at Mozilla the VCS is the source of truth, and it can be accessed directly by localizers, or by tools other than Pontoon. As a consequence, as you can see from the picture, the sync between Pontoon and l10n repositories needs to be bidirectional: new translations are written by Pontoon in the l10n repository, but Pontoon also reads changes made to the repository. The latter is quite common in Firefox, for example when we run <a href="localization/../products/firefox_desktop/fluent_migrations.html">Fluent migrations</a>.</p>
<p>In this scenario, the only way to ensure that obsolete translations are ignored by the entire toolchain is to change string IDs. The alternative would be gating access to the repository, allowing only translation via Pontoon, and automatically remove all obsolete translations as soon as the source locale changes. It’s worth noting that this approach might prevent us from shipping localization updates for a previous version of the product (in the example, one where <em>master password</em> is still in use).</p>
<h3 id="firefox"><a class="header" href="#firefox">Firefox</a></h3>
<p>Things become a lot more complicated for Firefox:</p>
<ul>
<li>Each localization is stored in a separate Mercurial repository.</li>
<li>The <code>en-US</code> locale is stored in the code repository (e.g. <code>mozilla-central</code>). That locale is used by the build system to build the US English version of Firefox, but it’s not used as source by the localization toolchain. In fact, in order to ship all versions of Firefox (Nightly, Beta, Developer Edition, Release, ESR) from a single l10n repository, we rely on a special <a href="https://firefox-source-docs.mozilla.org/l10n/crosschannel/index.html">cross-channel repository</a> called <code>gecko-strings</code>, which includes all strings for all shipping versions of Firefox.</li>
</ul>
<p>This is the scenario before the string change. Once again, although it already looks very busy, it’s a simplified high level view of the actual system.</p>
<p><img src="localization/../assets/images/localization/string_changes_firefox_start.png" alt="Firefox: starting point with existing string" /></p>
<p>And this is what happens if a string is changed without new ID:</p>
<p><img src="localization/../assets/images/localization/string_changes_firefox_change.png" alt="Firefox: change without new ID" /></p>
<ul>
<li>The string is changed in <code>mozilla-central</code>, and the en-US Nightly build will start using it. This change is reflected in <code>gecko-strings</code>, but doesn’t impact other builds (e.g. beta), because that’s not used by the build system.</li>
<li>As for the generic product, Pontoon reads the updated change, but doesn’t notify localizers or invalidate existing translations.</li>
</ul>
<p>In this scenario, simply removing existing translations from VCS isn’t possible, because we still need them to ship in older builds.</p>
<p>Let’s take it a step further, and assume that we can detect the change, notify localizers in Pontoon, and Italian updates its translation (in purple).</p>
<p><img src="localization/../assets/images/localization/string_changes_firefox_l10nchange.png" alt="Firefox: change without new ID, reflected in Italian localization" /></p>
<p>As you can see, this would result in shipping the updated version of the string in all builds, including ones where <em>master password</em> is still used.</p>
<h3 id="thats-not-how-it-work-in-other-companies-or-products"><a class="header" href="#thats-not-how-it-work-in-other-companies-or-products">That’s not how it work in other companies or products</a></h3>
<p>True, Mozilla’s approach to localization is unique, as much as our Mission to ensure openness. Most companies, for example, can treat their internal localization tool as source of truth, gate access, and use VCS only as a write-only storage. In that case, they can directly remove obsolete translations from VCS, or keep track safely of strings that need to be reviewed following changes to the source language. They also can enforce schedules and timelines, since localization is managed by either staff or vendors, while at Mozilla is managed by a community of volunteers.</p>
<p>Adopting this type of approach at Mozilla would require a drastic change of paradigm, including closing down access to repositories, and a significant investment in updating the existing toolchain.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="localization-best-practices-for-developers"><a class="header" href="#localization-best-practices-for-developers">Localization best practices for developers</a></h1>
<ul>
<li><a href="localization/dev_best_practices.html#note-on-localizers">Note on localizers</a></li>
<li><a href="localization/dev_best_practices.html#localization-files">Localization files</a>
<ul>
<li><a href="localization/dev_best_practices.html#string-identifiers-ids">String identifiers (IDs)</a></li>
<li><a href="localization/dev_best_practices.html#add-localization-notes">Add localization notes</a>
<ul>
<li><a href="localization/dev_best_practices.html#fluent-files">Fluent files</a></li>
<li><a href="localization/dev_best_practices.html#properties-files">Properties files</a></li>
<li><a href="localization/dev_best_practices.html#dtd-files">DTD files</a></li>
<li><a href="localization/dev_best_practices.html#json-webextension">JSON (webextension)</a></li>
<li><a href="localization/dev_best_practices.html#xml-android">XML (Android)</a></li>
<li><a href="localization/dev_best_practices.html#xliff-ios-qt">XLIFF (iOS, qt)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="localization/dev_best_practices.html#land-good-quality-strings">Land good quality strings</a></li>
<li><a href="localization/dev_best_practices.html#make-strings-properly-localizable">Make strings properly localizable</a>
<ul>
<li><a href="localization/dev_best_practices.html#create-flexible-content">Create flexible content</a>
<ul>
<li><a href="localization/dev_best_practices.html#date-time-and-unit-formatting">Date, time and unit formatting</a></li>
<li><a href="localization/dev_best_practices.html#splitting-and-composing-sentences">Splitting and composing sentences</a></li>
<li><a href="localization/dev_best_practices.html#word-order">Word order</a></li>
<li><a href="localization/dev_best_practices.html#case-and-inflections">Case and inflections</a></li>
</ul>
</li>
<li><a href="localization/dev_best_practices.html#use-proper-plural-forms">Use proper plural forms</a></li>
<li><a href="localization/dev_best_practices.html#use-ordered-variables-in-string-with-multiple-variables">Use ordered variables in string with multiple variables</a></li>
<li><a href="localization/dev_best_practices.html#avoid-concatenations-use-placeholders-instead">Avoid concatenations, use placeholders instead</a></li>
<li><a href="localization/dev_best_practices.html#dont-reuse-strings-in-different-contexts">Don’t reuse strings in different contexts</a></li>
<li><a href="localization/dev_best_practices.html#avoid-unnecessary-complexity-in-strings">Avoid unnecessary complexity in strings</a></li>
<li><a href="localization/dev_best_practices.html#dont-hardcode-characters">Don’t hardcode characters</a></li>
<li><a href="localization/dev_best_practices.html#remove-unused-strings">Remove unused strings</a></li>
</ul>
</li>
<li><a href="localization/dev_best_practices.html#create-localizable-ui">Create localizable UI</a>
<ul>
<li><a href="localization/dev_best_practices.html#css-issues">CSS issues</a></li>
<li><a href="localization/dev_best_practices.html#design-for-at-least-30">Design for at least +30%</a></li>
<li><a href="localization/dev_best_practices.html#design-to-avoid-breaking-words">Design to avoid breaking words</a></li>
</ul>
</li>
<li><a href="localization/dev_best_practices.html#test-localizability">Test localizability</a></li>
</ul>
<p>This document provides best practices for developers to create localizable code, and describes how to avoid some common localizability mistakes. Some additional guidelines specific for Fluent in Firefox are also available in <a href="https://firefox-source-docs.mozilla.org/l10n/fluent/review.html">this page</a>, and there is a <a href="localization/../products/firefox_desktop/firefox_l10n_faqs.html">collection of FAQs specific for Firefox localization</a>.</p>
<p>Specific channels dedicated to localization are available on Matrix, in case you have more questions:</p>
<ul>
<li><a href="https://chat.mozilla.org/#/room/#l10n-community:mozilla.org">#l10n-community</a> is used by localizers, and it’s a good place to ask for questions about specific languages.</li>
<li><a href="https://chat.mozilla.org/#/room/#l10n-dev:mozilla.org">#l10n-dev</a> can be used for more technical questions.</li>
<li><a href="https://chat.mozilla.org/#/room/#i18n:mozilla.org">#i18n</a> is the channel of the Internationalization (i18n) team.</li>
</ul>
<h2 id="note-on-localizers"><a class="header" href="#note-on-localizers">Note on localizers</a></h2>
<p>Mozilla localizers are volunteers with very diverse technical skills and backgrounds: some of them rely exclusively on translation tools and have a linguistic education, others prefer to work directly with text editors and don’t have problems interacting with version control systems (VCS) or reading code.</p>
<p>It’s important to consider this when adding strings, and especially localization comments for strings that contain references or technical details.</p>
<h2 id="localization-files"><a class="header" href="#localization-files">Localization files</a></h2>
<h3 id="string-identifiers-ids"><a class="header" href="#string-identifiers-ids">String identifiers (IDs)</a></h3>
<p>In most localization formats, a translation unit consists of a unique identifier (ID, often <em>string ID</em> or <em>message ID</em>) associated to a segment of text. The ID chosen for your string, regardless of the file format, should always be descriptive of the message and its role in the interface (button label, title, etc.). Using specific IDs also will discourage other developers from <a href="localization/dev_best_practices.html#dont-reuse-strings-in-different-contexts">reusing strings</a> in different contexts.</p>
<p>In most case, when <strong>updating an existing string</strong> already exposed for localization, a new string ID is necessary (for more details, see <a href="localization/making_string_changes.html">this document</a>):</p>
<ul>
<li>If you are changing a string such that its <strong>meaning has changed</strong>, you must update the string ID.</li>
<li>In case of Fluent, you need to update the string ID also when <strong>the morphology of the message changes</strong>, i.e. attributes are added or removed.</li>
<li>If your changes are relevant only for English — for example, to correct a typographical error or to make capitalization consistent — then there is generally no need to update the string ID.</li>
</ul>
<p>There is a gray area between needing a new ID or not. In some cases, it will be necessary to look at all the existing translations to determine if a new ID would be beneficial. You should always reach out to the l10n team in case of doubt.</p>
<p>If a new ID is needed, adding a progressive number to the existing ID should always be used as a last resort. For example, suppose this string needs to be changed from <code>Event</code> to <code>Add New Event</code>:</p>
<pre><code>new-event-header = Event
</code></pre>
<p><code>add-new-event-header</code> is definitely a better choice for the new string than <code>new-event-header1</code>.</p>
<p>If a string is tied to an accesskey or a tooltip, use string IDs that highlight this relation:</p>
<pre><code>neweventbtn.label = Add event
neweventbtn.accesskey = A
neweventbtn.tooltip = Add a new event
</code></pre>
<p>If you’re adding new strings, check that you’re not duplicating an existing ID. Depending on the parser logic, one of these two translations will be ignored. For some products, e.g. Firefox in <code>mozilla-central</code>, this check might be performed by automation.</p>
<h3 id="add-localization-notes"><a class="header" href="#add-localization-notes">Add localization notes</a></h3>
<p>Localizers often have visibility over one string at a time, without the context of source code. For this reason, it is important to add comments to the localizable files themselves. These comments are generally referred to as <em>localization notes</em>.</p>
<p>Don’t forget to add a localization note when:</p>
<ul>
<li>Part of the string is not supposed to be localized (for example, the name of an HTML attribute in a warning).</li>
<li>String includes variables: always explain what will be the value of these variables at run-time.</li>
<li>English could be ambiguous. For example: <code>bookmark</code> can be a noun or a verb. Using meaningful IDs can also help in these cases.</li>
<li>Strings are used in a specific context. For example accessibility (a11y) strings: in this case space is less important than clarity, since these strings are not displayed in the UI but used by tools like screen readers.</li>
<li>The string contains an adjective, but the noun it refers to is not part of the string. Most languages need to decline adjectives based on number and gender.</li>
</ul>
<p>There is an established format for localization comments: it’s important to follow the format as closely as possible, since there are a number of automated tools that parse these comments for easier access and use by localizers.</p>
<h4 id="fluent-files"><a class="header" href="#fluent-files">Fluent files</a></h4>
<p>Fluent <a href="https://projectfluent.org/fluent/guide/comments.html">supports several types of comments</a> (file, section, individual message).</p>
<pre><code>### File comment

## Section comment

# Standalone comment

# Message comment
my-message = Example
</code></pre>
<p>Strings with variables should have a comment documenting the type of each variable:</p>
<pre><code># This string is used on a new line below the add-on name
# Variables:
#   $name (String) - Add-on author name
cfr-doorhanger-extension-author = by { $name }
</code></pre>
<h4 id="properties-files"><a class="header" href="#properties-files">Properties files</a></h4>
<pre><code># LOCALIZATION NOTE(privacy-text): %S will be replaced at run-time by an
# active link. the string “privacy-link” will be used as text for this link.
privacy-text = By proceeding you agree to the %S.
privacy-link = Privacy Terms
</code></pre>
<p>File-wide comments should use the same format, they should be at the top of the file (after the license header) and just drop the <em>(entity name/key)</em> reference.</p>
<h4 id="dtd-files"><a class="header" href="#dtd-files">DTD files</a></h4>
<pre><code>&lt;!-- LOCALIZATION NOTE: The accessibleLabel is a spoken label that should not
include the word &quot;toolbar&quot; or such, because screen readers already know that
this container is a toolbar. This avoids double-speaking. --&gt;
&lt;!ENTITY navbar.accessibleLabel &quot;Navigation&quot;&gt;
</code></pre>
<h4 id="json-webextension"><a class="header" href="#json-webextension">JSON (webextension)</a></h4>
<pre><code>&quot;disableDataCollection&quot;: {
    &quot;message&quot;: &quot;Disable data collection&quot;,
    &quot;description&quot;: &quot;The label on the toggle that DISABLES sending interaction data to Mozilla.&quot;
}
</code></pre>
<h4 id="xml-android"><a class="header" href="#xml-android">XML (Android)</a></h4>
<pre><code>&lt;!-- The same as 'shortcut_erase_short_label' but more descriptive. The launcher shows this
      instead of the short title when it has enough space. Android recommends a maximum length
      of 25 characters.
      %1$s will be replaced by the app name (e.g. Firefox Focus) --&gt;
&lt;string name=&quot;shortcut_erase_and_open_long_label&quot;&gt;Erase and open %1$s&lt;/string&gt;
</code></pre>
<h4 id="xliff-ios-qt"><a class="header" href="#xliff-ios-qt">XLIFF (iOS, qt)</a></h4>
<pre><code>&lt;trans-unit id=&quot;vpn.controller.active&quot;&gt;
  &lt;source&gt;Secure and private&lt;/source&gt;
  &lt;note&gt;This refers to the user’s internet connection.&lt;/note&gt;
&lt;/trans-unit&gt;
</code></pre>
<h2 id="land-good-quality-strings"><a class="header" href="#land-good-quality-strings">Land good quality strings</a></h2>
<p>Try not to land temporary strings. If you already know that your strings are temporary, they shouldn’t be exposed to the localization process. This would waste everybody’s time and create unnecessary frustration: localizers have to translate strings that are destined to change, developers will need to <a href="localization/making_string_changes.html">use new IDs</a> later to update them.</p>
<p>In case of Fluent and Firefox, it’s possible to save these strings in a file that is not exposed to localization (<a href="https://hg.mozilla.org/mozilla-central/rev/7b4db2f1bf8f">example</a>). This has two benefits:</p>
<ul>
<li>It won’t be necessary to change the code to make it localizable, e.g. to remove hard-coded strings.</li>
<li>When the content is ready, the file can simply be moved and exposed to the localization toolchain.</li>
</ul>
<p>If you’re reviewing a patch, check also strings (and comments) for grammar errors, capitalization or inconsistencies. Each product should have its own set of copy rules. For example, in Firefox typographical quotes (<code>’“”</code>) should be used instead of straight ASCII quotes (<code>'&quot;</code>), and there are automated tests enforcing that.</p>
<p>If you have any doubts about the quality of strings, ask the Content Team to do a copy review of this text. Ideally, all strings landing in code should originate from approved UX wireframes, and copy review should be part of the initial stage of creating these wireframes.</p>
<h2 id="make-strings-properly-localizable"><a class="header" href="#make-strings-properly-localizable">Make strings properly localizable</a></h2>
<h3 id="create-flexible-content"><a class="header" href="#create-flexible-content">Create flexible content</a></h3>
<p>You need to account for different grammar structures in different locales, and add switching mechanisms to present them appropriately. You shouldn’t make assumptions as to what those structures will be. Instead, let locales/localizers decide. When in doubt, ask the localizers.</p>
<h4 id="date-time-and-unit-formatting"><a class="header" href="#date-time-and-unit-formatting">Date, time and unit formatting</a></h4>
<p>For example, you shouldn’t hard code date formats into applications:</p>
<pre><code>%A, %b %e
// resulting in Wednesday, May 20
</code></pre>
<p>This is fine in English, but in Italian it results in “Mercoledì, Mag 20”, which sounds unnatural. Every time you use this kind of structure, you should have a localizable string behind it, and let localizers decide the best order for their language.</p>
<p>Another example is localizing percentages or units. Some locales use a space between the number and the <code>%</code> symbol, some don’t, and some use a non-breaking space.</p>
<p>Fluent <a href="https://projectfluent.org/fluent/guide/functions.html">provides built-in functions</a> (<code>DATETIME()</code> and <code>NUMBER()</code>) to deal flexibly with both date and number formatting.</p>
<h4 id="splitting-and-composing-sentences"><a class="header" href="#splitting-and-composing-sentences">Splitting and composing sentences</a></h4>
<p>Splitting sentences into several keys often inadvertently presumes a grammar, a sentence structure, and such composite strings are unnecessarily difficult to translate.</p>
<p>For example, in English all the following begin with the same clause:</p>
<ul>
<li><code>The URL of this feed is invalid</code></li>
<li><code>The URL of this feed cannot be reached</code></li>
<li><code>The URL of this feed cannot be parsed</code></li>
</ul>
<p>It might be tempting to save time by presenting this as <code>The URL of this feed %S</code> and then replace the variable at run-time. However, linguistically these are different types of sentences and will be handled differently in other languages. This is usually not a case of translator choice but obligatory in the language. For example, in Gaelic these sentences must be translated as:</p>
<ul>
<li><code>Tha URL an inbhir seo mì-dhligheach</code></li>
<li><code>Cha ruig sinn URL an inbhir seo</code></li>
<li><code>Cha ghabh URL an inbhir seo a pharsadh</code></li>
</ul>
<p>Unless there are significant savings of translation volume involved, it is usually easier and quicker for translators to handle these as fixed strings rather than composed strings, especially considering the time needed for locating, checking and potentially fixing composed strings.</p>
<h4 id="word-order"><a class="header" href="#word-order">Word order</a></h4>
<p>If a string contains a variable, always add a placeholder to the string to allow the localizer to change the word order if necessary. For example, it might seem fine in English to present the string <code>[username] says:</code> to localizers simply as <code>says:</code> but this will cause issues in many other languages, as the agent of an action often will not come in front of the verb. For example in Irish/Gaelic the correct order is <code>be [username] at saying:</code>. If a placeholder is present, this can be correctly localized as <code>Tá %s ag rádh:</code>, but that’s impossible without it.</p>
<p>Similarly, if the UI string is <code>Flash Version</code>, do not simply present the translator with <code>Version</code> for translation. Present the whole string or, if there is a significant need for a placeholder, use a placeholder. The word <em>Version</em> may have to go before or after <code>Flash</code> and one or both may need to be inflected.</p>
<h4 id="case-and-inflections"><a class="header" href="#case-and-inflections">Case and inflections</a></h4>
<p>Many languages have features like noun classes (i.e. nouns belonging to different categories and treated differently by the grammar), case and inflections (changes are made to a word to indicate differences in meaning or use) and so on. In modern English, such features are rare and are mainly restricted to plural <code>-s</code> and verb forms (e.g. <code>go &gt; went</code> is a form of inflection).</p>
<p>Here are a few examples from other languages:</p>
<ul>
<li>Gender in German: nouns can be either masculine, feminine or neuter. The most obvious impact is that the definite article, which in English is always <code>the</code>, can either be <code>der, die</code> or <code>das</code>. To complicate matters, if the grammatical context changes, the article will change: <code>Der Text</code> (“the text”) changes to <code>Wollen Sie den Text speichern?</code> (“Do you want to save the text?”), because <em>text</em> is nominative (subject) in the first sentence, and accusative (direct object) in the second.</li>
<li>Suffixes in Basque: where English tends to use expressions such as “to the” or “from the”, Basque adds an ending to a word to express the same concept. For example <code>From the menu</code> in Basque is <code>Menutik</code> (suffix <code>-tik</code>) and <code>To the printers</code> is <code>Inprimagailuei</code> (suffix <code>-ei</code>).</li>
</ul>
<p>Using placeholders for something like “the text” or “the file” works well in English but is likely to cause problems for localizers if the placeholders cannot be inflected.</p>
<h3 id="use-proper-plural-forms"><a class="header" href="#use-proper-plural-forms">Use proper plural forms</a></h3>
<p>Firefox supports proper plural forms in Fluent and Properties (not DTDs). As a native English speaker, you might find it natural to use two strings to solve plurals:</p>
<pre><code>delete-cookie = Delete cookie
delete-cookies = Delete cookies
</code></pre>
<p>But plural forms are a lot more complex in other languages, requiring up to six different forms (see <a href="https://unicode-org.github.io/cldr-staging/charts/latest/supplemental/language_plural_rules.html">CLDR page</a>).</p>
<p>Using Fluent, this string would look like this:</p>
<pre><code>delete-cookies = { $count -&gt;
  [one] Delete cookie
 *[other] Delete cookies
}
</code></pre>
<p>This also allows localizers to expose the number of items, in case it’s necessary:</p>
<pre><code>delete-cookies = { $count -&gt;
  [one] Delete one cookie
 *[other] Delete { $count } cookies
}
</code></pre>
<p>Or to target a specific number (value) instead of a plural category. For example, the category <code>one</code> in French covers also <code>0</code>, unlike English and most western languages where <code>0</code> is covered by <code>other</code> (like <code>2</code>).</p>
<pre><code>delete-cookies = { $count -&gt;
  [1] Delete this cookie
 *[other] Delete { $count } cookies
}
</code></pre>
<p>In Properties (forms are separated with a semicolon, see <a href="https://searchfox.org/mozilla-central/rev/c8ea016b87997574e1ca9127a4c370032aa6ee79/intl/locale/PluralForm.jsm">code</a>):</p>
<pre><code># LOCALIZATION NOTE (delete-cookies): Semi-colon list of plural forms.
# See: http://developer.mozilla.org/en/docs/Localization_and_Plurals
# #1 is the number of cookies to delete
# example:
delete-cookies = Delete #1 cookie;Delete #1 cookies
</code></pre>
<p><strong>Important:</strong> always include the localization note with this format if you use a plural form in Firefox. This comment is used by tools to identify strings with plural forms.</p>
<p>For some formats, <strong>plural forms are not supported</strong>, for a limitation in either the format itself (DTD, JSON) or in our toolchain (XLIFF, XML). In these cases, you should try to use plural neuter forms: instead of <code>%S files were copied</code>, use <code>Copied files: %S</code>.</p>
<h3 id="use-ordered-variables-in-string-with-multiple-variables"><a class="header" href="#use-ordered-variables-in-string-with-multiple-variables">Use ordered variables in string with multiple variables</a></h3>
<p>Consider this string:</p>
<pre><code>generalSiteIdentity = This website is owned by %S. This has been verified by %S.
</code></pre>
<p>First thing: always add a localization comment explaining what these variables mean, even if it seems obvious. Using multiple <code>%S</code> gives the impression that the order of variables is fixed, while it actually isn’t.</p>
<pre><code># LOCALIZATION NOTE(generalSiteIdentity): %1$S is the owner of the current website,
# %2$S is the name of the Certification Authority signing the certificate.
generalSiteIdentity=This website is owned by %1$S. This has been verified by %2$S.
</code></pre>
<p>This problem doesn’t exist in Fluent, where <a href="https://projectfluent.org/fluent/guide/variables.html">variables are named</a>.</p>
<pre><code># Variables:
#   $owner (String) - Owner of the current website
#   $ca (String) - Name of the Certification Authority signing the certificate
general-site-identity = This website is owned by { $owner }. This has been verified by { $ca }.
</code></pre>
<h3 id="avoid-concatenations-use-placeholders-instead"><a class="header" href="#avoid-concatenations-use-placeholders-instead">Avoid concatenations, use placeholders instead</a></h3>
<p>Consider these strings:</p>
<pre><code>tos-text = By proceeding you agree to the
tos-link = Terms of Service
</code></pre>
<p>Most developers would consider this a good solution and display the concatenation of <code>tos-text+tos-link</code>, with an active link on the second part. It has the benefit of hiding HTML tags, and not requiring the use of <code>innerHTML</code> to inject the result in the UI.</p>
<p>Unfortunately, this won’t work, as you need at least a third string to place after the link. Without that some languages won’t be able to create a natural sounding sentence.</p>
<p>A much more flexible solution would be:</p>
<pre><code># LOCALIZATION NOTE (tos-text): %S will be replaced at run-time
# by an active link. String with ID “tos-link” will be used as text
# for this link.
tos-text = By proceeding you agree to the %S
tos-link = Terms of Service
</code></pre>
<p>And then replace <code>%S</code> at run-time with the second string. Note also the localization comment and make sure it is clear to the localizer which placeholder string will appear in place of the placeholder as this may affect translation and/or inflection. For example, <code>By proceeding you agree to the Terms of Service</code> will result in the Slovenian translation <code>Z nadaljevanjem sprejemate pogoje uporabe</code>. But in another grammatical context, <code>Terms of Service</code> may require a different inflection, for example <code>pogojev uporabe</code> or <code>pogoji uporabe</code>. So if the localizer is left unsure as to which string goes into which placeholder, this may lead to bad translations.</p>
<p>In Fluent it can be even more straightforward, without need of replacements:</p>
<pre><code># DOM implementation
tos-text = By proceeding you agree to the &lt;a data-l10n-name=&quot;tos&quot;&gt;Terms of Service&lt;/a&gt;
# React implementation
tos-text = By proceeding you agree to the &lt;a&gt;Terms of Service&lt;/a&gt;
</code></pre>
<h3 id="dont-reuse-strings-in-different-contexts"><a class="header" href="#dont-reuse-strings-in-different-contexts">Don’t reuse strings in different contexts</a></h3>
<p>This is particularly important for mobile, where different context often means different font and available space for the string. For example, if you’re adding a new menu item in Settings on Android, don’t use the same string for the menu item and the following screen header.</p>
<p>Another example: some locales use nouns for titles, and verbs for actions (for example button labels). Sometimes they coincide with English, but they rarely do in other languages. Take <code>Bookmark</code>: it can be both a noun and a verb in English. A developer could be tempted to reuse the same string “Bookmark” in the button to add a bookmark, and in the header for the next dialog. This won’t work in several languages.</p>
<h3 id="avoid-unnecessary-complexity-in-strings"><a class="header" href="#avoid-unnecessary-complexity-in-strings">Avoid unnecessary complexity in strings</a></h3>
<p>Consider this string:</p>
<pre><code>privacy-link = &lt;p&gt;By proceeding you agree to the &lt;a href=&quot;https://www.mozilla.org/privacy&quot; class=&quot;external&quot;&gt;Privacy Terms&lt;/a&gt;.&lt;/p&gt;
</code></pre>
<p>In this case, you shouldn’t put the URL inside the localization string, unless you need it to be localizable. If you change the URL, you’re going to need a new string ID; the same goes for the anchor’s attributes, or the paragraph markup. Instead, you should use the following approach:</p>
<p>In Fluent:</p>
<pre><code># DOM implementation
privacy-link = By proceeding you agree to the &lt;a data-l10n-name=&quot;privacy&quot;&gt;Privacy Terms&lt;/a&gt;
# React implementation
privacy-link = By proceeding you agree to the &lt;a&gt;Privacy Terms&lt;/a&gt;
</code></pre>
<p>In properties:</p>
<pre><code># LOCALIZATION NOTE(privacy-link): %s will be replaced at run-time
# by an active link. String with ID “privacy-link-text” will be used as text
# for this link.
privacy-link = By proceeding you agree to the %S.
privacy-link-text = Privacy Terms
</code></pre>
<p>And then replace <code>%S</code> at run-time with the mark-up and link text.</p>
<h3 id="dont-hardcode-characters"><a class="header" href="#dont-hardcode-characters">Don’t hardcode characters</a></h3>
<p>Typically hardcoding happens for white spaces, commas, or other separators (<code>:</code>, <code>|</code>). Sometimes this is even done implicitly, by relying on new lines converted to a single white space in HTML.</p>
<p>If you need a trailing white space in a string, use the Unicode character <code>\u0020</code> in Properties, or <code>{ &quot; &quot; }</code> in Fluent. But this is usually a bad sign, because it means you’re concatenating it to another string.</p>
<h3 id="remove-unused-strings"><a class="header" href="#remove-unused-strings">Remove unused strings</a></h3>
<p>If you’re removing features, don’t leave around unused strings in the localization files.</p>
<h2 id="create-localizable-ui"><a class="header" href="#create-localizable-ui">Create localizable UI</a></h2>
<h3 id="css-issues"><a class="header" href="#css-issues">CSS issues</a></h3>
<p>Some CSS text/font properties may cause problems with text legibility when applied to certain scripts. For example, avoid using Italic for <a href="https://en.wikipedia.org/wiki/CJK_characters">CJK locales</a> — Chinese (Simplified and Traditional), Japanese, and Korean.</p>
<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/text-transform"><code>text-transform</code></a> property is not reliable for some locales; for example, <code>text-transform: uppercase</code> won’t work with languages such as Irish/Gaelic or Turkish (<code>İi</code> vs <code>Iı</code>). <code>App Size</code> in English may be capitalized via <code>text-transform: uppercase</code> to <code>APP SIZE</code> but in Gaelic this would change <code>Meud na h-aplacaid</code> to <code>MEUD NA H-APLACAID</code>, which violates the locales orthographic rules, as it ought to be <code>MEUD NA hAPLACAID</code>. In some cases, it can even lead to a different meaning. Consider the following examples in Irish:</p>
<ul>
<li><code>Athair</code> = Father</li>
<li><code>Nathair</code> = Snake</li>
<li><code>Ár nAthair</code> = Our Father</li>
<li><code>Ár Nathair</code> = Our Snake</li>
<li><code>ÁR NATHAIR</code> = OUR SNAKE</li>
<li><code>ÁR nATHAIR</code> = OUR FATHER</li>
</ul>
<p>In general, localizers should make the decision about capitalization. If you want to display <code>WARNING</code> uppercase, add a string directly with that capitalization, and explain it in the localization note. This is particularly important for web content, where the CSS implementation depends on the browser in use. Even within Firefox, the correct behavior depends on having the correct <code>lang</code> attribute associated to the text or document.</p>
<h3 id="design-for-at-least-30"><a class="header" href="#design-for-at-least-30">Design for at least +30%</a></h3>
<p>Bear in mind that English strings will likely be shorter than their international equivalents, so you need to leave some space in your UI to allow for this. Some examples:</p>
<ul>
<li><code>OK</code> in English becomes <code>Ceart ma-thà</code> in Gaelic.</li>
<li><code>Save document?</code> in English becomes <code>A bheil thu airson an sgrìobhainn a shàbhaladh</code> in Gaelic.</li>
</ul>
<p>Another good example is <em>Yes/No</em>. There are two types of languages, those that have <em>Yes/No</em> as a single word, and those that don’t and work on mirroring the verb. For example, a <code>Do you want to open the page?</code> &gt; <code>Yes/No</code> dialog works in English, but in Celtic languages (and several others) the equivalent answer is <code>Want/Not want</code>.</p>
<p>W3C has a good <a href="http://www.w3.org/International/articles/article-text-size">guide</a> on the length ratios a developer should be prepared for.</p>
<h3 id="design-to-avoid-breaking-words"><a class="header" href="#design-to-avoid-breaking-words">Design to avoid breaking words</a></h3>
<p>Not only do strings become longer (as above), individual words can be much longer than you expect in some languages. This could lead to strings overflowing, particularly if a design contains elements with small widths or uses a large font. For example: <code>Account recovery key</code> in English becomes <code>Kontowiederherstellungsschlüssel</code> in German.</p>
<p>You should avoid using CSS styling like <code>word-break</code> to automatically add line-breaks to these words, as the output will result in text that appears incorrect and unnatural to a local audience as in the examples below. In the first example, <code>word-break</code> is applied to a title with a large font applied, causing a word to break at the very last letter. In the second example, you can see a layout that does not account for unexpectedly long words where <code>word-break</code> causes issues for German.</p>
<p>Example 1
<img src="localization/../assets/images/localization/word_break_example_1.png" alt="word break example 1" /></p>
<p>Example 2
<img src="localization/../assets/images/localization/word_break_example_2.png" alt="word break example 2" /></p>
<h2 id="test-localizability"><a class="header" href="#test-localizability">Test localizability</a></h2>
<p>As a developer, you should always test your patches not just for code errors, but also for localizability issues in case they involve string or UI changes. The best way to test localizability in Firefox is to use Fluent and then enable <a href="https://firefox-source-docs.mozilla.org/l10n/fluent/tutorial.html#pseudolocalization">pseudolocalization</a>. Other localization systems should have equivalent tools to help testing for localizability issues.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="globalization-best-practices-for-product-managers"><a class="header" href="#globalization-best-practices-for-product-managers">Globalization best practices for product managers</a></h1>
<ul>
<li><a href="localization/globalization_best_practices.html#planning">Planning</a>
<ul>
<li><a href="localization/globalization_best_practices.html#localization-cant-be-an-afterthought">Localization can’t be an afterthought</a></li>
<li><a href="localization/globalization_best_practices.html#which-content-needs-to-be-localized">Which content needs to be localized?</a></li>
<li><a href="localization/globalization_best_practices.html#account-for-localization-in-your-schedule">Account for localization in your schedule</a></li>
<li><a href="localization/globalization_best_practices.html#new-feature--new-product">New feature ≠ new product</a></li>
</ul>
</li>
<li><a href="localization/globalization_best_practices.html#setting-up-for-success">Setting up for success</a>
<ul>
<li><a href="localization/globalization_best_practices.html#provide-context">Provide context</a></li>
<li><a href="localization/globalization_best_practices.html#localization-and-volunteers-are-rarely-the-bottleneck">Localization and volunteers are rarely the bottleneck</a></li>
<li><a href="localization/globalization_best_practices.html#working-in-the-open-by-default">Working in the open by default</a></li>
<li><a href="localization/globalization_best_practices.html#region--language">Region ≠ language</a></li>
<li><a href="localization/globalization_best_practices.html#feature-and-brand-names">Feature and brand names</a></li>
<li><a href="localization/globalization_best_practices.html#requesting-a-change-for-existing-translations">Requesting a change for existing translations</a>
<ul>
<li><a href="localization/globalization_best_practices.html#community">Community</a></li>
<li><a href="localization/globalization_best_practices.html#evaluating-feedback-and-alternatives">Evaluating feedback and alternatives</a></li>
<li><a href="localization/globalization_best_practices.html#how-to-request-a-change">How to request a change</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This document aims to describe a few of the common pitfalls when it comes to localizing products or websites, and it targets a less technical audience than <a href="localization/dev_best_practices.html">Localization best practices for developers</a>.</p>
<p>The following content is also accessible to Mozilla staff (not public):</p>
<ul>
<li>For more detailed information about how we currently ship localized products, you can check out <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11046419/Overview+and+distribution+of+localized+products">this Confluence page</a>.</li>
<li>To understand how different content types are translated at Mozilla, you can check the <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation#Standard-localization-services-by-content-type">main Localization page on Confluence</a>.</li>
</ul>
<h2 id="planning"><a class="header" href="#planning">Planning</a></h2>
<h3 id="localization-cant-be-an-afterthought"><a class="header" href="#localization-cant-be-an-afterthought">Localization can’t be an afterthought</a></h3>
<p>If you plan to ship a product in more than one language, <strong>localization should be part of the initial planning</strong>. In some cases, adding localization late in the cycle might be costly, as it could require going back to the drawing board for UX or content, or setting up additional infrastructure to ship a localized version of the product.</p>
<p>There are areas that represent non-obvious challenges when it comes to localization (physical addresses, phone number parsing and formatting, currency selection to name a few). If your application touches one of these aspects, the amount of work might not be trivial, and it will be too late to fix things.</p>
<h3 id="which-content-needs-to-be-localized"><a class="header" href="#which-content-needs-to-be-localized">Which content needs to be localized?</a></h3>
<p>Try to <strong>think of all the assets that will be created</strong> as part of the product, and how many will require localization. For example, shipping a localized mobile app isn’t just about localizing the app itself:</p>
<ul>
<li>Marketing content: is there promotional material that needs to be localized as part of launch or major update?</li>
<li>Legal docs: are there new legal documents, or updates to existing ones, required for this project?</li>
<li>App Store listings: is the project going to be published in online stores (Apple, Google, Microsoft)? Text requires localization, and images might need to be localized.</li>
</ul>
<p>Stores are becoming common also for Desktop apps, so this applies to more and more products.</p>
<p>If you create <strong>imagery</strong> as part of these assets, make sure that they’re either fully localizable, or they’re sufficiently abstract (no text, no parts of actual product UI with text). Also, be mindful when adding pictures of people, make sure that the selection is inclusive and fits the target audience.</p>
<h3 id="account-for-localization-in-your-schedule"><a class="header" href="#account-for-localization-in-your-schedule">Account for localization in your schedule</a></h3>
<p>There are a few key moments in the schedule for a localized product:</p>
<ul>
<li><strong>Active development:</strong> localization can start during this phase, and work in parallel with development (<em>continuous localization</em>). At this point, Nightly builds or automated screenshots should be already available to test localization in-context. While some churn in content can be expected at this stage, developers should still try to <a href="localization/dev_best_practices.html#land-good-quality-strings">avoid landing temporary content or placeholders</a>.</li>
<li><strong>Content freeze</strong>: even with <em>continuous localization</em>, there must be a moment in the cycle when the content gets frozen, and stops receiving updates. This time after content freeze can be dedicated to complete and test localization.</li>
<li><strong>QA:</strong> Does QA need to test localized versions of the product? If so, this could only happen after the product has been localized.</li>
</ul>
<p>The time needed to complete localization will depend on the size of content. When working with volunteers, it’s also important to understand that there’s no guarantee that localization will be completed by the end of the cycle:</p>
<ul>
<li>The localization implementation should be able to gracefully deal with incomplete localizations, i.e. <strong>implement a robust fallback system</strong>. For example, if a translation is missing for French, the app should keep working and display English content (i.e. the “source” content) only for that specific string.  <br />
Ideally, there should be a full chain of fallback locales, instead of just a pair: for example, for a minority language spoken in Mexico, a fallback chain that looks like language -&gt; es-MX -&gt; es-ES -&gt; en-US provides a much better experience for users.</li>
<li>Being able to <strong>quickly ship localization updates</strong> after the initial release is a major benefit, both for increasing localization coverage and fixing bugs.</li>
</ul>
<p><img src="localization/../assets/images/localization/schedule_l10n.png" alt="l10n schedule" /></p>
<h3 id="new-feature--new-product"><a class="header" href="#new-feature--new-product">New feature ≠ new product</a></h3>
<p>If a product is already localized, the new feature will inherit the same infrastructure, processes, and limitations of the main product (check this internal <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11046419/Overview+and+distribution+of+localized+products">Confluence page</a> for more details on some of Mozilla products).</p>
<p>For example, if you’re adding a new feature in Firefox:</p>
<ul>
<li>It will be localized by volunteers.</li>
<li>Strings will be automatically exposed for localization once they land in Nightly.</li>
<li>It will follow the rapid release cycle, with content frozen once it moves to Beta.</li>
</ul>
<p>While possible, supporting a completely different workflow for a single feature requires time and work, and might not be cost or resource effective.</p>
<h2 id="setting-up-for-success"><a class="header" href="#setting-up-for-success">Setting up for success</a></h2>
<h3 id="provide-context"><a class="header" href="#provide-context">Provide context</a></h3>
<p>It doesn’t really matter if translation is performed by volunteers or by an external agency: <strong>without context, they don’t have the tools to succeed</strong>.</p>
<p>Providing context means, for example, explaining why a specific wording or term was chosen. What was the original intent? That reasoning would help localizers come up with the best option.</p>
<p>On a more technical level, providing context means explaining:</p>
<ul>
<li>Where is the string used, and are there technical limitations (e.g. limited space)? This typically happens through <a href="localization/dev_best_practices.html#add-localization-notes">localization comments</a>.</li>
<li>How can a feature be tested, or how can localized text be verified in context? <strong>Screenshots</strong> generated as part of automated tests go a long way in helping with this, as they don’t have any technical entry barrier, and require less time for localizers.</li>
</ul>
<h3 id="localization-and-volunteers-are-rarely-the-bottleneck"><a class="header" href="#localization-and-volunteers-are-rarely-the-bottleneck">Localization and volunteers are rarely the bottleneck</a></h3>
<p>Using an external agency might feel like a good choice to ensure translations are done in time, especially when other parts of the project are late.</p>
<p>There are a few negatives to keep in mind:</p>
<ul>
<li>Translation delivery might happen quickly, but the content needs to be fed back into the existing infrastructure. Does that infrastructure support an external vendor?</li>
<li>The agency might not have sufficient context or experience with the Mozilla ecosystem, and their work might not fit into the existing translations — or even our values.</li>
<li>Fixing errors in translations might take a longer time to resolve, as the issue needs to be reported back in external tools, verified by translators, and then the fix imported back in the product.</li>
</ul>
<h3 id="working-in-the-open-by-default"><a class="header" href="#working-in-the-open-by-default">Working in the open by default</a></h3>
<p>As mentioned above, localizers need context. This context is provided through open communications, while translations will be stored in tools and repositories that are publicly visible.</p>
<p>If the intent is to make a marketing splash with a new feature, keep this aspect in mind. There are ways to mitigate this, hiding some part of the information (e.g. launch dates) or sending 1:1 communications, but it can’t be a completely opaque process.</p>
<h3 id="region--language"><a class="header" href="#region--language">Region ≠ language</a></h3>
<p>It’s a <strong>common mistake to think of languages and regions as interchangeable</strong> (France = French). The easiest way to understand why that doesn’t work is thinking about a language like Spanish:</p>
<ul>
<li>It’s certainly spoken in Spain, but it’s the official language of several countries in South and Central America, and widely spoken in others (e.g. in the United States). Every regional variant will have different internationalization preferences (e.g. currency, or date formatting), but they might also use different expressions that could sound awkward to another demographic.</li>
<li>By focusing only on Spanish for a product launch in Spain, you might be providing a less enjoyable experience for other users in the same region (Catalan, French, and speakers of other minority languages). This concept applies to most larger countries.</li>
</ul>
<p>If you’re interested in knowing more about this topic, for example language distribution in a specific country, data from external research is available.</p>
<h3 id="feature-and-brand-names"><a class="header" href="#feature-and-brand-names">Feature and brand names</a></h3>
<p>Feature names are a particularly challenging aspect of localization, as often they use (or allude to) actual meaningful words in English.</p>
<p>The most important thing to establish early is a <strong>clear policy for translation</strong>: can the feature name be translated or transliterated, completely or partially, or should it stay in English?</p>
<p>Changing a feature name afterwards is confusing for users, so it’s important to establish a clear policy from the start, and understand that we shouldn’t change it afterwards. Imagine, as a user, to find a new feature in Firefox, and that name changes a couple of versions later. Confusing, isn't it? That happened for Firefox Account and Sync in the past, because we failed to satisfy the first requirement (or changed policy after years).</p>
<p>If the feature name can be localized, we need to provide as much context as possible on the choice, i.e. why that specific name was chosen for English.</p>
<p>We also need to give time to localizers to come up with a good choice. After all, the same process likely required a significant amount of time for English.</p>
<h3 id="requesting-a-change-for-existing-translations"><a class="header" href="#requesting-a-change-for-existing-translations">Requesting a change for existing translations</a></h3>
<p>As a product manager, you might receive feedback that a specific translation is not optimal and should be changed, or that English should be used instead of a translated term.</p>
<p>This section aims to provide more context about our work with the community, highlight aspects to keep in mind when evaluating this type of feedback, and describe how to effectively request a change.</p>
<h4 id="community"><a class="header" href="#community">Community</a></h4>
<p>As detailed in <a href="https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation#Standard-localization-services-by-content-type">this Confluence page</a>, all Mozilla products are localized by a community of volunteers.</p>
<p>Our community members invest hundreds of hours translating the entire Mozilla ecosystem, and often do more than just translation: grass-root marketing, support, brand evangelism, QA, and more. We built a relationship based on cooperation over the years, and that includes trusting them with making good choices when it comes to translating specific feature names.</p>
<p>With the help of our community we established a sustainable localization system, which is key for Mozilla’s success and embodies our mission of making the internet truly accessible to all. Thanks to them, we’re often able to support more languages than our competitors.</p>
<h4 id="evaluating-feedback-and-alternatives"><a class="header" href="#evaluating-feedback-and-alternatives">Evaluating feedback and alternatives</a></h4>
<p>The in-house Localization team acts as a <strong>steward of the relationship with our community</strong>. As a rule of thumb, feedback should not be forwarded unfiltered to translators. Feedback should be first evaluated internally:</p>
<ul>
<li><strong>Decide if the proposed change is worth the possible confusion that existing users will feel.</strong> They have already been exposed to the existing translation, and all of a sudden the product will start using a different term, potentially one they don’t understand.</li>
<li><strong>Explain why the new translation is considered more effective than the existing one.</strong> Where possible, support the proposal with data.</li>
</ul>
<p>The in-house Localization team should be the first point of contact. While we don’t have the internal resources to evaluate linguistic feedback for specific locales, we have more context on existing policies around translation, and can help identify all the risks associated with a change.</p>
<p>In an ideal scenario, we should rely on user research to understand how the target audience reacts to both alternatives. Looking at what other companies do can be an effective approach, but it’s important to note that they might target a completely different audience (age, interests, familiarity with English).</p>
<p><strong>Considerations when deciding whether an English term is best:</strong></p>
<ul>
<li><strong>We often have biases, because of age, environment or experience.</strong> Mozilla is an international company where everyone speaks English. Most non-native speakers at Mozilla use their browser, operating system, and even mobile phone in English. As an employee, we might not be a representative sample when it comes to deciding if English is an effective choice.</li>
<li><strong>Consider the product strategy and target audience.</strong> Will we see better results with a more evocative and modern name (as English often is perceived), or a more descriptive translation that is more easily understood? For example, if the goal is to grow the number of users for the product through this feature, is there a risk that they might be pushed back by an English name? Or will they be more attracted?</li>
<li><strong>Depending on the language, switching to an English term might not be a straightforward replacement</strong>, e.g. if the term is used in sentences and with different grammatical roles.</li>
<li><strong>English might have a negative impact on specific languages and cultures.</strong> For example, consider languages using a different <a href="https://en.wikipedia.org/wiki/Bidirectional_text">text direction</a>: in right-to-left languages, the text flows from right to left. An English set of words will force the reader to suddenly jump forward, read the characters left to right, then return to the natural reading flow for the rest of the sentence. While this has become second nature for younger generations, it might not be for all speakers, or even for all regions where the language is spoken.<br/> The English words might also be pronounced in a way that evokes existing words in the local language, giving the feature a negative or even obscene connotation. There are plenty of examples of major international companies rebranding locally to avoid this type of situation.</li>
</ul>
<h4 id="how-to-request-a-change"><a class="header" href="#how-to-request-a-change">How to request a change</a></h4>
<p>The localization program manager in charge of the product can reach out to a specific language community to get more background on existing translations, for example to verify if alternatives were already considered and rejected.</p>
<p>Our team can also create a communication channel between product and localizers to propose a change, but simply imposing a specific choice from the top comes with the risk of alienating our volunteers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="l10n-and-ios-products"><a class="header" href="#l10n-and-ios-products">L10n and iOS Products</a></h1>
<p>Some documentation specific for common tasks regarding iOS products and l10n:</p>
<ul>
<li><a href="products/iOS_products/updating_locales.html">Updating locales</a>.</li>
<li><a href="products/iOS_products/review_iOSstrings.html">Reviewing strings for a new release</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="updating-locales-for-specific-projects-1"><a class="header" href="#updating-locales-for-specific-projects-1">Updating locales for specific projects</a></h1>
<p>These are the instructions to update locales on iOS mobile products, currently living within the <a href="https://github.com/mozilla-l10n/firefoxios-l10n">Firefox for iOS</a>, and in the <a href="https://github.com/mozilla-l10n/focusios-l10n">Focus for iOS</a> projects.</p>
<h2 id="prerequisites-to-adding-a-locale"><a class="header" href="#prerequisites-to-adding-a-locale">Prerequisites to adding a locale</a></h2>
<p>First, you will have to check that the locale is available within the iOS system settings. iOS currently supports two tiers of locales, and a locale must be part of one of these two lists in order to ship on Mozilla products for iOS. Unlike Mozilla products for Android, there’s no locale switcher included in the app, so it’s possible to ship only locales that are supported by iOS.</p>
<p>To tell if a locale is supported or not, take a look on an actual device, under the Language Settings of the most recent iOS version available. Tier one locales are the ones listed under “iPod/iPhone/iPad Language”, and Tier 2 locales appear under “Other Language” (or “Add Language” if there are already some languages under that list). If a locale doesn’t appear in any of these lists, then it is currently not supported by iOS.</p>
<h2 id="updating-locales-in-pontoon-1"><a class="header" href="#updating-locales-in-pontoon-1">Updating locales in Pontoon</a></h2>
<p>Once you’ve determined if the locale can be added you must go to Pontoon to update the list of current locales. If the locale is not <a href="https://pontoon.mozilla.org/teams/">available</a> in Pontoon yet, <a href="products/iOS_products/../../tools/pontoon/adding_new_locale.html">consult this document</a> for instructions on how to add it.</p>
<p>In Pontoon, you can add and remove locales from the admin project page: <a href="https://pontoon.mozilla.org/admin/projects/firefox-for-ios/">here</a> for Firefox for iOS, and <a href="https://pontoon.mozilla.org/admin/projects/focus-for-ios/">here</a> for Focus for iOS. The project will be available after the next <a href="https://pontoon.mozilla.org/sync/log/">Pontoon sync</a>.</p>
<h3 id="adding-locales"><a class="header" href="#adding-locales">Adding locales</a></h3>
<p>Once you have added a new locale in Pontoon, there is nothing more to do in order to get the locale into Nightly builds. This should happen automatically within 24-48 hours. To check that the locale is indeed now set up in the l10n repository, you can check that its correspoding locale folder has been created <a href="https://github.com/mozilla-l10n/firefoxios-l10n">here</a> for Firefox for iOS and <a href="https://github.com/mozilla-l10n/focusios-l10n">here</a> for Focus for iOS.</p>
<p>To check that the locale made in into the code repository, there is a script running (note that this method may not always be 100% reliable): <a href="https://github.com/mozilla-l10n/firefoxios-l10n#locales-in-build">here</a> for Firefox for iOS and <a href="https://github.com/mozilla-l10n/focusios-l10n#locales-in-build">here</a> for Focus for iOS. A more reliable method would be to look for the pull request that imports translations in the code repository, and verify that it created files for that new locale.</p>
<p>The locale will then ride the trains to release. The iOS release calendar follows closely the Android and Firefox desktop calendar, which can be found <a href="https://whattrainisitnow.com/">here</a>.</p>
<h3 id="removing-locales"><a class="header" href="#removing-locales">Removing locales</a></h3>
<p>Once you have removed a new locale from Pontoon, the existing locale folder then needs to be removed from the l10n repository, and all files should also be removed from the code repository.</p>
<p>As a mozilla-l10n code owner, you should be able to delete this folder yourself from the mozilla-l10n repo. This should be done via pull request, so we can keep track of the removal, and in case we'd want to reverse that action.</p>
<p>Then, file an issue on Github (<a href="https://github.com/mozilla-mobile/firefox-ios">here</a> for Firefox for iOS, and <a href="https://github.com/mozilla-mobile/focus-ios">here</a> for Focus for iOS), so that the mobile team can work on removing their corresponding files. Once the issue is filed, and if you don't get any traction after a few days, you can ask for help in the <code>#mobile-xfnl-leads</code> Slack channel.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reviewing-strings-for-a-new-release-of-mozilla-ios-products"><a class="header" href="#reviewing-strings-for-a-new-release-of-mozilla-ios-products">Reviewing strings for a new release of Mozilla iOS products</a></h1>
<p>Usually, a new release of our iOS products means an update to strings. Like for Android products, mobile developers will land strings in their respective code repositories throughout the release cycle, and pull requests will be opened by GitHub automation in the iOS repositories to expose these strings for localization in Pontoon (either under the <a href="https://github.com/mozilla-l10n/firefoxios-l10n">firefoxios-l10n</a> or the <a href="https://github.com/mozilla-l10n/focusios-l10n">focusios-l10n</a> repositories in <code>mozilla-l10n</code>). Automation will try to import strings twice a week (Tuesdays and Thursdays), but it's also possible to manually trigger a string import to the <code>mozilla-l10n</code> repository any time by going to the GitHub <code>Actions</code> section of the l10n repository and then importing strings again by running the string import workflow.</p>
<p>At this point, the PR is reviewed by an l10n-driver - most often by the PM in charge of mobile projects.</p>
<p>Note that there is a linter in place that checks reference strings for common errors. When opening a pull request that touches the <code>en-US</code> folder, a GitHub workflow is used to check errors such as misused quotes or ellipsis, and hard-coded brand names. It's possible to add exceptions in the corresponding JSON file (for example <a href="https://github.com/mozilla-l10n/firefoxios-l10n/blob/main/.github/scripts/linter_config.json">here</a> for Firefox iOS).</p>
<p>Let’s go over some of the steps needed over time in order to review correctly strings for a new release.</p>
<h2 id="reviewing-the-pr-1"><a class="header" href="#reviewing-the-pr-1">Reviewing the PR</a></h2>
<p>Let's consider Firefox for iOS as an example. As a matter of fact, the iOS release cycles follow closely the Android and Firefox desktop calendar, which can be found <a href="https://whattrainisitnow.com">here</a>. During the release cycle, automation will create pull requests as explained in the section above, in order to land strings for the upcoming release.</p>
<p>Let’s consider a past PR, <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192">here</a>.</p>
<p>The first thing you’ll want to do is to check the changes to the <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9cae">/templates folder</a>.</p>
<h3 id="acceptable-changes-1"><a class="header" href="#acceptable-changes-1">Acceptable changes</a></h3>
<p>Changes to attributes like <code>tool-version</code> and <code>build-num</code> are expected, they happen every time you change the version of Xcode. Seeing <code>datatype=&quot;plaintext&quot;</code> move to the end of <code>file original</code> is also acceptable, such as <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/195/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9caeL3529">here</a>.</p>
<p>Note that these will not appear as new strings for localizers and they will not need to retranslate them.</p>
<p>Changes to comments (<code>&lt;note&gt;</code>) are irrelevant in terms of string updates, so they’re also OK.</p>
<h3 id="potentially-problematic-changes"><a class="header" href="#potentially-problematic-changes">Potentially problematic changes</a></h3>
<p>Then you start scrolling down, checking if the new strings make sense: the first one you find is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>.</p>
<p>Things to look out for:</p>
<ul>
<li>Unclear strings and missing localization comments: the best way to identify them is to translate the strings, only having the string and comment as context (not the entire file, or the associated commit where the string landed). For example: is the word used both a noun and a verb in English? Is the ID clear enough to give context (e.g. <code>buttonLabel</code>)?</li>
<li>String changes without new IDs. IDs in XLIFF files are stored in the <code>trans-unit</code> attribute; for example, the ID of <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-6f29eb799be1b575316c0187d69a38fce3c63e27e5a22eb180b338ee177e9caeR3201">this string</a> is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>.</li>
<li>Duplicated strings.</li>
<li>Other general <a href="https://mozilla-l10n.github.io/documentation/localization/dev_best_practices.html">localization issues</a>.</li>
</ul>
<h3 id="quickly-review-other-locales"><a class="header" href="#quickly-review-other-locales">Quickly review other locales</a></h3>
<p>Once you’ve checked <code>templates</code>, you can pick at least one locale and see what changes, as you can see <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192/files#diff-220a1dc4ddc01bbae6a176ba4122aa644042181c78a638b052f45462b758ca6f">for example here</a>. Checking another locale helps to easily spot if there are any file removals that might be deleting entire sections of existing translations.</p>
<p>Any time you are unsure about deletions, pinging an iOS developer is recommended.</p>
<h2 id="reviewing-strings-during-the-cycle"><a class="header" href="#reviewing-strings-during-the-cycle">Reviewing strings during the cycle</a></h2>
<p>You should try to check out the strings landing, and try to localize them in your head: how would you translate them? Would you be able to do it without the app? Is the localization comment clear enough? The section above explains what else to look out for and to keep in mind while your review.</p>
<p>You might also need to identify the commit that added that string, see if there are screenshots, or ask if the iOS team can provide one. The point below explains how to find that commit.</p>
<h3 id="how-to-find-the-code-that-introduced-a-string"><a class="header" href="#how-to-find-the-code-that-introduced-a-string">How to find the code that introduced a string</a></h3>
<p>Let’s consider an example of new strings for Firefox for iOS, with <a href="https://github.com/mozilla-l10n/firefoxios-l10n/pull/192">this past PR</a>.</p>
<p>The ID is <code>CreditCard.DisplayCard.ExpiresLabel.v115</code>, the label <code>Expires</code>.
Imagine there is no localization comment there, you will want to know which GitHub PR introduced this string, and who was the author.</p>
<p>In fact currently, the only strings that can not have localization comments are strings that are located in <code>InfoPlist.strings</code> and <code>Info.plist</code> - see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1277515">Bug 1277515</a> for more details. Otherwise, strings should always have localization comments.</p>
<p>So first you open the <a href="https://github.com/mozilla-mobile/firefox-ios">main repository page</a>.</p>
<p>Then you use the search box at the top, searching for the <a href="https://github.com/search?q=repo%3Amozilla-mobile%2Ffirefox-ios%20CreditCard.DisplayCard.ExpiresLabel.v115&amp;type=code">string ID (or the string)</a>.</p>
<p>Then to the left, filter by <code>Pull Requests</code>. This should bring you to the Pull Request were the string was introduced, as well as the author of the string.</p>
<p>If there are no PRs associated to the string, instead click on the link to the right finishing by <code>/Strings.swift</code>, to open up (in this case) <a href="https://github.com/mozilla-mobile/firefox-ios/blob/4bba2a088f0e5795dca89c10b3194dd97f3c2621/Client/Frontend/Strings.swift#L250">this file</a>. Then use the <code>Blame</code> <a href="https://github.com/mozilla-mobile/firefox-ios/blame/4bba2a088f0e5795dca89c10b3194dd97f3c2621/Client/Frontend/Strings.swift#L250">link on top</a>. On the left, you should (almost always) find the GitHub PR that introduced the string and its author.</p>
<p>You can then CC directly the author of the string in the new strings PR that arrived in the <code>mozilla-l10n</code> repository, and ask for a fix there.</p>
<h2 id="wrapping-up-your-work-1"><a class="header" href="#wrapping-up-your-work-1">Wrapping up your work</a></h2>
<p>So you’ve reviewed the strings, and the PR looks good - this means you can now merge the PR so the strings get exposed in Pontoon.</p>
<p>Pontoon (<a href="https://pontoon.mozilla.org/projects/firefox-for-ios/">here for Firefox for iOS</a> and <a href="https://pontoon.mozilla.org/projects/focus-for-ios/">here for Focus for iOS</a>) should get the new strings automatically after a few minutes, but it’s always a good idea to double check just in case.</p>
<p>One last thing is to not forget to update the l10n completion deadline under Pontoon resources for each product.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="other-projects"><a class="header" href="#other-projects">Other Projects</a></h1>
<ul>
<li><a href="products/other/index.html#firefox-monitor">Firefox Monitor</a></li>
<li><a href="products/other/index.html#mozilla-vpn-client">Mozilla VPN Client</a>
<ul>
<li><a href="products/other/index.html#automation-strings-export">Automation: Strings export</a></li>
<li><a href="products/other/index.html#automation-linting">Automation: Linting</a></li>
</ul>
</li>
</ul>
<h2 id="firefox-monitor"><a class="header" href="#firefox-monitor">Firefox Monitor</a></h2>
<ul>
<li>Repository: <a href="https://github.com/mozilla/blurts-server/">GitHub</a></li>
<li>L10n Repository: <a href="https://github.com/mozilla-l10n/monitor-website-l10n">GitHub</a></li>
<li>L10n format: Fluent</li>
<li>Bug reports: <a href="https://github.com/mozilla/blurts-server/issues">GitHub</a></li>
<li>Dev server: <a href="https://fx-breach-alerts.herokuapp.com/">link</a></li>
<li>Prod server: <a href="https://monitor.firefox.com/">link</a></li>
<li>Other resources: <a href="https://fx-breach-alerts.herokuapp.com/email-l10n">email templates</a></li>
</ul>
<p>To add a new locale to this project it’s enough to add the locale to Pontoon. This will make the locale automatically available on the dev server and commit to the repository.</p>
<p>Localization PM is automatically set as reviewer via <a href="https://github.com/mozilla/blurts-server/blob/main/docs/CODEOWNERS">CODEOWNER</a> for pull requests affecting Fluent files.</p>
<p>For information on the automation, see the <a href="https://github.com/mozilla-l10n/monitor-website-l10n#automation">README</a> in the l10n repository.</p>
<h2 id="mozilla-vpn-client"><a class="header" href="#mozilla-vpn-client">Mozilla VPN Client</a></h2>
<ul>
<li>Repository: <a href="https://github.com/mozilla-mobile/mozilla-vpn-client">GitHub</a></li>
<li>L10n Repository: <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n">GitHub</a></li>
<li>L10n format: XLIFF</li>
<li>Bug reports: <a href="https://github.com/mozilla-mobile/mozilla-vpn-client/issues">GitHub</a></li>
<li>Testing web app: <a href="https://mozilla-mobile.github.io/mozilla-vpn-client/">link</a></li>
</ul>
<p>To add a new locale to this project it’s enough to add the locale to Pontoon. The locale will be added automatically to Nightly builds, but will be available in production builds only after it reaches 70% completion (and dropped automatically if it gets lower).</p>
<p>Builds are created via GitHub automation and available as assets in each run of <a href="https://github.com/mozilla-mobile/mozilla-vpn-client/actions">GitHub Actions</a>. Builds are multilocale, and users can switch language directly from the app settings.</p>
<p>For this project, there are several elements of automation running (linter, <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n#string-updates">string extraction</a>).</p>
<h3 id="automation-strings-export"><a class="header" href="#automation-strings-export">Automation: Strings export</a></h3>
<p>Strings are stored in the original repository either directly in the code or in <a href="https://github.com/mozilla-mobile/mozilla-vpn-client/blob/main/translations/strings.yaml">YAML format</a>.</p>
<p><a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/blob/main/.github/workflows/update.yaml">Automation</a> exports strings from the <code>main</code> branch and all <code>releases</code> branches into a single XLIFF file, and creates a pull request every workday at 7 AM UTC updating all XLIFF files in the repository. The PM in charge is automatically set as reviewer via <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/blob/main/.github/CODEOWNERS">CODEOWNER</a>.</p>
<h3 id="automation-linting"><a class="header" href="#automation-linting">Automation: Linting</a></h3>
<p>There is automation performing <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/blob/main/.github/workflows/update.yaml">basic linting</a> on the localized XLIFF files. Automation runs once a day and checks for:</p>
<ul>
<li>Missing placeables (variable references like <code>%1</code>).</li>
<li>Use of <code>...</code> instead of <code>…</code>.</li>
<li>Pilcrow characters <code>¶</code>.</li>
</ul>
<p>The system supports <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/blob/main/.github/scripts/check_exceptions.json">exceptions</a>, and the linter status is visible in the repository’s <a href="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/blob/main/README.md">README</a></p>
<p><img src="https://github.com/mozilla-l10n/mozilla-vpn-client-l10n/workflows/L10n%20Linter/badge.svg" alt="Linter status" /></p>
<p>There is also a <a href="https://github.com/mozilla-mobile/mozilla-vpn-client/blob/main/.github/l10n/check_l10n_issues.py">linter</a> running in the code repository, checking for common mistakes in strings:</p>
<ul>
<li>Use of straight quotes <code>'</code> or <code>&quot;</code> instead of <code>'</code> or <code>“”</code>.</li>
<li>Use of <code>...</code> instead of <code>…</code>.</li>
<li>Lack of comments when the string has placeables.</li>
<li>Empty strings.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-pontoon"><a class="header" href="#working-with-pontoon">Working with Pontoon</a></h1>
<p>Some documentation specific for common and advanced tasks on Pontoon</p>
<ul>
<li><a href="tools/pontoon/adding_new_project.html">Adding a new project</a>.</li>
<li><a href="tools/pontoon/adding_new_short_term_project.html">Adding a new short-term project</a>.</li>
<li><a href="tools/pontoon/adding_new_locale.html">Adding a new locale</a>.</li>
<li><a href="tools/pontoon/managing_pretranslation.html">Managing pretranslation</a>.</li>
<li><a href="tools/pontoon/sending_notifications.html">Sending notifications</a>.</li>
<li><a href="tools/pontoon/renaming_a_file.html">Renaming a localization file</a>.</li>
<li><a href="tools/pontoon/renaming_a_project.html">Renaming a project</a>.</li>
<li><a href="tools/pontoon/deactivating_users.html">Deactivating users</a>.</li>
<li><a href="tools/pontoon/removing_users.html">Removing users</a>.</li>
<li><a href="tools/pontoon/adding_new_terminology.html">Adding new terminology</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-project-on-pontoon"><a class="header" href="#adding-a-new-project-on-pontoon">Adding a new project on Pontoon</a></h1>
<h2 id="verify-that-the-project-is-properly-localizable"><a class="header" href="#verify-that-the-project-is-properly-localizable">Verify that the project is properly localizable</a></h2>
<p>Project owners can follow the <a href="https://mozilla-pontoon.readthedocs.io/en/latest/user/localizing-your-projects.html">guidelines</a> available in Pontoon Documentation to properly structure files inside the repository. Some things to check:</p>
<ul>
<li>Files should be organized in subfolders, one per locale, and the filename should remain the same across locales. More details on the <a href="https://mozilla-pontoon.readthedocs.io/en/latest/index.html">supported formats</a> and <a href="https://mozilla-pontoon.readthedocs.io/en/latest/user/localizing-your-projects.html#folder-structure">folder structure</a> are available in Pontoon’s documentation.</li>
<li>Pontoon needs write access to the repository (<a href="tools/pontoon/../../misc/creating_new_repository.html#add-collaborators">see this document</a>).</li>
</ul>
<p>It’s important to also check the files for localization issues before exposing them to localizers: unclear strings, lack of localization comments, missing plural forms are some of the things to check.</p>
<h2 id="create-the-project"><a class="header" href="#create-the-project">Create the project</a></h2>
<p>Access Pontoon’s <a href="https://pontoon.mozilla.org/admin/">admin console</a> and click <strong>ADD NEW PROJECT</strong>.</p>
<p>The new project will appear in the <a href="https://pontoon.mozilla.org/projects/">public list of Projects</a> only after the next sync cycle.</p>
<ul>
<li>Name: name of the repository (it will be displayed in Pontoon’s project selector).</li>
<li>Slug: used in URLs, will be generated automatically based on the repository’s name.</li>
<li>Locales:
<ul>
<li>Select at least one locale. To make things faster it’s possible to copy supported locales from an existing project.</li>
<li>The <em>Read-only</em> column can be used to add languages in read-only mode. In this way, their translations will be available to other languages in the LOCALES tab when translating, but it won’t be possible to change or submit translations directly in Pontoon.</li>
<li>You can uncheck the <code>Locales can opt-in</code> checkbox to prevent localizers from requesting this specific project.</li>
</ul>
</li>
<li>Repositories: select the type of repository and URL. Make sure to use SSH to allow write access. For example, if the repository is <code>https://github.com/meandavejustice/min-vid</code>, the URL should be <code>git@github.com:meandavejustice/min-vid.git</code>. You can use the <em>Clone or download</em> button in the repository page on GitHub, making sure that <em>Clone with SSH</em> is selected.</li>
<li>Leave the <code>Branch</code> field empty, unless developers asked to commit translations in a specific branch instead of the default one (usually <code>main</code> or <code>master</code>).</li>
<li>Download prefix or path to TOML file: a URL prefix for downloading localized files. For GitHub repositories, select any localized file on GitHub, click <code>Raw</code> and replace locale code and the following bits in the URL with <code>{locale_code}</code>. For example, if the link is <code>https://raw.githubusercontent.com/bwinton/TabCenter-l10n/master/locales/en-US/addon.properties</code>, the field should be set to <code>https://raw.githubusercontent.com/bwinton/TabCenter-l10n/master/locales/{locale_code}</code>. If you use a project configuration file, you need to provide the path to the raw TOML file on GitHub, e.g. <code>https://raw.githubusercontent.com/mozilla/common-voice/main/l10n.toml</code>.</li>
<li>Public Repository Website: displayed on dashboards. E.g. <code>https://github.com/meandavejustice/min-vid</code>. Pontoon will try to prefill it after you enter Repository URL.</li>
<li>Project info: provide some information about the project to help localizers with context or testing instructions. HTML is supported, so you can add external links. For example:</li>
</ul>
<pre><code class="language-HTML">Localization for the &lt;a href=&quot;https://testpilot.firefox.com/experiments/min-vid&quot;&gt;Min Vid add-on&lt;/a&gt;.
</code></pre>
<ul>
<li>Internal admin notes: use them e.g. for developer contacts and information that other PMs will find useful when covering for you.</li>
<li>Deadline: if available, enter project deadline in the YYYY-MM-DD format.</li>
<li>Priority: select priority level from one of the 5 levels available (Lowest, Low, Normal, High, Highest).</li>
<li>Contact: select the L10n driver in charge of the project, probably yourself.</li>
<li>External Resources: provide links to external resources like l10n preview environment. You need to enter the name and the URL for each resource. You can also pick one of the predefined names: Development site, Production site, Development build, Production build, Screenshots, Language pack.</li>
<li>Visibility: determines who can access the project. Pontoon supports the following visibility types:
<ul>
<li>private (default) - only administrators can access the project.</li>
<li>public - the project is visible for everyone.</li>
</ul>
</li>
<li>Pretranslation: see the <a href="tools/pontoon/managing_pretranslation.html">document dedicated to pretranslation</a>.</li>
</ul>
<p>Click <strong>SAVE PROJECT</strong> at the bottom of the page, then click <strong>SYNC</strong> to run a test sync. In the <a href="https://pontoon.mozilla.org/sync/log/">Sync log</a> you should be able to see if it succeeded or failed. If all went well, the new project will appear in the <a href="https://pontoon.mozilla.org/projects/">public list of Projects</a>.</p>
<p><strong>Important</strong>: once you verify the project works as expected, enable it for the general audience by setting Visibility to Public.</p>
<h3 id="tags"><a class="header" href="#tags">Tags</a></h3>
<p>Tags can be used in a project to logically group resources, assigning them a priority. To enable tags for a project, check <em>Tags enabled</em> and save the project.</p>
<p>For each tag, it’s possible to define:</p>
<ul>
<li><em>Name</em>: it will be displayed in project (e.g. <code>/projects/firefox/tags/</code>) and localization dashboards (e.g. <code>/it/firefox/tags/</code>), but also in search filters.</li>
<li><em>Slug</em>: used in URLs for tag dashboards, e.g. <code>/projects/firefox/tags/devtools/</code>.</li>
<li><em>Priority</em>: like for a project, it’s possible to select a priority level from one of the 5 levels available (Lowest, Low, Normal, High, Highest).</li>
</ul>
<p><img src="tools/pontoon/../../assets/images/pontoon/manage_tags_resources.png" alt="Tags resources" /></p>
<p>Once you’ve created a new tag, you need to save the project in order to be able to manage the resources associated to the tag itself, using the button highlighted in red.</p>
<p>A few tips on using this section:</p>
<ul>
<li>Use the selector on the right (highlighted in orange) to switch between <em>Linked</em> resources, i.e. resources already associated to the tag, and <em>Unlinked</em> resources.</li>
<li>The first checkbox on the left (highlighted in green) allows to select all displayed items. Note: if the search returns multiple pages, only those currently displayed are selected and will be linked if <em>Link resources</em> is clicked.</li>
<li>There is no need to save the project when adding resources to a tag: linked resources are stored in the database as soon as they’re added with the <em>Link resources</em> button.</li>
</ul>
<h3 id="resource-deadline"><a class="header" href="#resource-deadline">Resource deadline</a></h3>
<p>Like for a project, it’s possible to set a deadline for a Resource.</p>
<p>Go to the <a href="https://pontoon.mozilla.org/a/base/resource/">resource section</a> of the admin panel, then type the name of your project (e.g. <code>engagement</code>) and hit <code>Enter</code>. All the resources for your project should appear. Click on the one you want to edit, set the deadline in the <code>Deadline</code> field, then click <code>SAVE</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="renaming-a-project"><a class="header" href="#renaming-a-project">Renaming a project</a></h1>
<p>You need to think carefully on the name when setting up a new project. This is because when a new project is set up, a corresponding slug is automatically generated. Though rare, sometimes a project needs to be renamed because the product name has changed or for some other reasons. To rename it, go to the project Admin page, update the <code>Name</code> field and click the <code>SAVE PROJECT</code> button. This won't cause any interruption for those in the middle of their work in Pontoon. Do send a communication on the name change to the communities.</p>
<p>A slug is the part of a URL that identifies a page in human-readable keywords. It is usually the end part of the URL.
There is no need to change the <code>Slug</code> field to make it match the revised project name. The reasons are:</p>
<ul>
<li>A slug is a unique ID to the project. It doesn’t have to match the project name 100%.</li>
<li>Once a slug is claimed, a future project name can’t reuse it, so there is no chance of two projects sharing the same slug.</li>
<li>Changing the slug could cause confusion to Pontoon users who bookmarked the project with the old URL. They will run into issue when launching the project through the bookmark. They will find the project in Pontoon eventually but this is an avoidable annoyance.</li>
</ul>
<p><strong>Never create a new project</strong> for the purpose of changing the project name. This would lose all attribution for existing translation, metadata like comments, and unreviewed suggestions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-short-term-project-on-pontoon"><a class="header" href="#adding-a-new-short-term-project-on-pontoon">Adding a new short-term project on Pontoon</a></h1>
<p>Short-term projects are things like newsletters, marketing campaigns, surveys… They do not have a repository, and data is instead stored only in Pontoon’s database.</p>
<p>The process to create a short-term project is very similar to that of a regular one.</p>
<h2 id="create-the-project-in-pontoon-stage-instance"><a class="header" href="#create-the-project-in-pontoon-stage-instance">Create the project in Pontoon STAGE instance</a></h2>
<p>First you want to test that everything works using Pontoon staging server.</p>
<p>Access Pontoon’s <a href="https://mozilla-pontoon-staging.herokuapp.com/admin/">admin console</a> on the <strong>stage server</strong> and click <strong>ADD NEW PROJECT</strong>.</p>
<ul>
<li>Name: name of the project (it will be displayed in Pontoon’s project selector).</li>
<li>Slug: used in URLs, will be generated automatically based on the repository’s name.</li>
<li>Locales:
<ul>
<li>Select at least one locale. To make things faster it’s possible to copy supported locales from an existing project.</li>
<li>You can uncheck the <code>Locales can opt-in</code> checkbox to prevent localizers from requesting this specific project.</li>
</ul>
</li>
<li>Data Source: select <code>Database</code> in the list of options. This will hide the <em>Repositories</em> section and show a <em>Strings</em> section instead.</li>
<li>Strings: you can enter the initial set of strings here. Strings must be separated by new lines. If you leave this empty, you’ll be able to enter strings as a batch again after creating the project. Strings must be in <code>en-US</code>, and they will become the entities on that project. A resource named <code>database</code> will automatically be created.</li>
<li>For every other option, please refer to the <a href="tools/pontoon/adding_new_project.html">new project documentation</a>.</li>
</ul>
<p>Click <strong>SAVE PROJECT</strong> at the bottom of the page, and you’re done!</p>
<h2 id="create-the-project-in-pontoon-prod-instance"><a class="header" href="#create-the-project-in-pontoon-prod-instance">Create the project in Pontoon PROD instance</a></h2>
<p>At this point you need to repeat the same steps on the <strong>production server</strong>.</p>
<p>Access Pontoon’s <a href="https://pontoon.mozilla.org/admin/">admin console</a>, add the same information you used on the staging server and make sure to select all supported locales for this project.</p>
<p>The new project will immediately appear in the <a href="https://pontoon.mozilla.org/projects/">public list of Projects</a>.</p>
<h2 id="managing-strings"><a class="header" href="#managing-strings">Managing strings</a></h2>
<p>After you have created your project, you will be able to manage its source strings. On the admin project page (that you can find from the <a href="https://pontoon.mozilla.org/admin/">admin console</a>), under the <em>Strings</em> section, you will find two links. The one called <strong>MANAGE STRINGS</strong> will lead you to a page where all strings are listed. There you can edit the string content, edit the string comment, add new strings (use the <strong>NEW STRING</strong> button) or remove existing strings (use the trashbin icon under the comment input). Once you’re done editing, click the <strong>SAVE STRINGS</strong> button to save your changes.</p>
<h2 id="downloading-translations"><a class="header" href="#downloading-translations">Downloading translations</a></h2>
<p>On the project’s admin page and on the Manage Strings page, you’ll find a <strong>DOWNLOAD STRINGS</strong> link. Clicking it will download a CSV file that contains all the translations in all enabled locales. The file format looks as follow:</p>
<pre><code class="language-CSV">Source, fr, de
Hello, Salut, Hallo
World, Monde, Welt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-a-new-locale-on-pontoon"><a class="header" href="#adding-a-new-locale-on-pontoon">Adding a new locale on Pontoon</a></h1>
<h2 id="verify-if-the-locale-is-already-available"><a class="header" href="#verify-if-the-locale-is-already-available">Verify if the locale is already available</a></h2>
<p>Access Django’s admin interface at <code>https://pontoon.mozilla.org/a/</code> (note that this is not the usual admin interface), then click <code>Locales</code>. In the next page search for the locale you want to add (safer to search for the locale code).</p>
<p>Before moving forward:</p>
<ul>
<li>If the locale is going to work on Firefox, it requires an <a href="https://hg.mozilla.org/l10n-central/">official Mercurial repository</a>.</li>
</ul>
<h2 id="add-the-new-locale"><a class="header" href="#add-the-new-locale">Add the new locale</a></h2>
<p>If the locale you need is not available, click the <strong>ADD LOCALE+</strong> button in the top right corner. For this example, let’s consider that the task is to add Amharic (am).</p>
<p>You will need to complete the following fields in the next page.</p>
<h3 id="code"><a class="header" href="#code">Code</a></h3>
<p>It’s the locale code, in this case <code>am</code>.</p>
<h3 id="google-translate-code"><a class="header" href="#google-translate-code">Google Translate code</a></h3>
<p>Google Translate maintains a list of supported locales in its own format. Choose one that matches the locale from <a href="https://translate.google.com/intl/en/about/languages/">a list of supported locales</a> or leave it blank to disable support for Google Translate for this locale.</p>
<h3 id="google-automl-model"><a class="header" href="#google-automl-model">Google AutoML model</a></h3>
<p>Set your <a href="https://cloud.google.com/translate/">Google Cloud AutoML Translation</a> model ID to use the custom translation engine with a trained model. You can find the model ID in <a href="https://console.cloud.google.com/translation/models/list">Google Cloud management console</a>. If the value is not set, Google’s generic machine translation technology is used instead.</p>
<h3 id="ms-translator-code"><a class="header" href="#ms-translator-code">MS translator code</a></h3>
<p>Microsoft Translator maintains a list of supported locales in its own format. Choose one that matches the locale from <a href="https://docs.microsoft.com/azure/cognitive-services/Translator/language-support">a list of supported locales</a> or leave it blank to disable support for Microsoft Translator for this locale.</p>
<h3 id="ms-terminology-code"><a class="header" href="#ms-terminology-code">MS terminology code</a></h3>
<p>Microsoft Terminology maintains a list of supported locales in its own format. Choose one that matches the locale from a list provided below the field or leave it blank to disable support for Microsoft Terminology for this locale.</p>
<h3 id="name"><a class="header" href="#name">Name</a></h3>
<p>It’s the language name, in this case <code>Amharic</code>.</p>
<h3 id="plural-rule"><a class="header" href="#plural-rule">Plural rule</a></h3>
<p>It’s the GetText plural rule. This <a href="http://docs.translatehouse.org/projects/localization-guide/en/latest/l10n/pluralforms.html">document</a> has plural rules for several languages. For example, for Amharic it would be:</p>
<pre><code>nplurals=2; plural=(n &gt; 1);
</code></pre>
<p>As explained in the note below the field, you only need to put the last part in the field:</p>
<pre><code>(n &gt; 1)
</code></pre>
<h3 id="cldr-plurals"><a class="header" href="#cldr-plurals">CLDR Plurals</a></h3>
<p>You need to find the locale on <a href="https://unicode-org.github.io/cldr-staging/charts/latest/supplemental/language_plural_rules.html">CLDR</a>. For Amharic, there are only two <strong>cardinal</strong> plural forms listed: one, other.</p>
<p>The mapping is:</p>
<pre><code>0 -&gt; zero
1 -&gt; one
2 -&gt; two
3 -&gt; few
4 -&gt; many
5 -&gt; other
</code></pre>
<p>For Amharic you will need to set the field as <code>1,5</code>, separating the available forms with a comma (no spaces).</p>
<p>Irish (ga-IE), for example, has all of them except for 0, so it will be <code>1,2,3,4,5</code>.</p>
<h3 id="script"><a class="header" href="#script">Script</a></h3>
<p>The script used by this locale. Find it in <a href="http://www.unicode.org/cldr/charts/latest/supplemental/languages_and_scripts.html">CLDR Languages and Scripts</a>.</p>
<h3 id="direction"><a class="header" href="#direction">Direction</a></h3>
<p>Writing direction of the script. Set to <code>right-to-left</code> if <code>rtl</code> value for the locale script is set to <code>YES</code> in <a href="https://github.com/unicode-cldr/cldr-core/blob/master/scriptMetadata.json">CLDR scriptMetadata.json</a>.</p>
<h3 id="population"><a class="header" href="#population">Population</a></h3>
<p>This represents the number of native speakers. There are two ways to get this information from CLDR.</p>
<h4 id="using-a-script"><a class="header" href="#using-a-script">Using a script</a></h4>
<p>Python needs to be available on the method to use this system: save <a href="https://raw.githubusercontent.com/mozilla-l10n/documentation/main/scripts/cldr_population.py">this file</a> on your computer as <code>cldr_population.py</code> and run it as <code>python cldr_population.py LOCALE_CODE</code>.</p>
<p>For example, this is the output of the script when checking data for <code>sl</code>:</p>
<pre><code>$ python scripts/cldr_population.py sl

Adding HU: 4937 (0.05% of 9874780)
Adding IT: 105412 (0.17% of 62007500)
Adding SI: 1720886 (87% of 1978030)
Adding AT: 32233 (0.37% of 8711770)
--------
Territories: AT, HU, IT, SI
Population: 1863468
--------
</code></pre>
<h4 id="manual-process"><a class="header" href="#manual-process">Manual process</a></h4>
<p>Find the locale code in <a href="https://github.com/unicode-cldr/cldr-core/blob/master/supplemental/territoryInfo.json">CLDR territoryInfo.json</a> and multiply its <code>_populationPercent</code> with the territory <code>_population</code>. Repeat if multiple occurrences of locale code exist and sum products.</p>
<p>At this point click <strong>SAVE</strong> in the bottom right corner to save and create the new locale. The &quot;Terminology&quot; project should appear automatically under the new team’s page — in this case at https://pontoon.mozilla.org/am/</p>
<h3 id="access-key-localization"><a class="header" href="#access-key-localization">Access key localization</a></h3>
<p>In software, access keys allow users to activate a menu command using their keyboard, and they’re displayed as an underlined character in the menu label. Some locales, especially those using a script different than Latin (Chinese, Japanese, etc.), don’t localize access keys, and use the same character as English. In this case, the access key will be appended to the label as an underlined character between parentheses.</p>
<p>Pontoon can recognize an access key attribute in Fluent strings, and provide translators with a dynamic UI to select one of the characters available in the localized label.</p>
<p>When the checkbox is selected (default), Pontoon will leave the access key field empty, and show the dynamic UI when translating. For pretranslation, it will use the first character from the pretranslated label.</p>
<p>When the checkbox is deselected, Pontoon will automatically use the same access key as the source string, for both manual translation and pretranslation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-pretranslation"><a class="header" href="#managing-pretranslation">Managing Pretranslation</a></h1>
<h2 id="opt-in-guidelines-to-enable-new-locales"><a class="header" href="#opt-in-guidelines-to-enable-new-locales">Opt-in guidelines to enable new locales</a></h2>
<p>It’s important to note that <strong>these are not strict criteria</strong>: members of staff will evaluate each request to opt in individually, based on their knowledge of the project and direct experience with the locale.</p>
<p><strong>Criteria for enabling pretranslation for a new locale</strong></p>
<ul>
<li>Request needs to come from translators or managers active within the last month (translating or reviewing).</li>
<li>There is an active manager for the locale (last activity within 2 months).</li>
</ul>
<p><strong>Criteria for enabling pretranslation for a new project</strong></p>
<ul>
<li>Less than 400 missing strings, except for projects or locales where existing pretranslation statistics provide high-confidence.</li>
<li>Average review time for pretranslations in existing projects is faster than 3 weeks.</li>
</ul>
<p><strong>Criteria for disabling the feature for a locale or a project</strong></p>
<ul>
<li>Approval rate drops below 40%.</li>
<li>Average review time for pretranslations is slower than 6 weeks.</li>
</ul>
<p>Note that disabling a project would always involve a conversation with reviewers for the locale.</p>
<h2 id="enabling-pretranslation-in-a-project"><a class="header" href="#enabling-pretranslation-in-a-project">Enabling pretranslation in a project</a></h2>
<p>Access Pontoon’s <a href="https://pontoon.mozilla.org/admin/">admin console</a>, and select the project: at the bottom of the page there is a section dedicated to <em>Pretranslation</em>.</p>
<p><strong>IMPORTANT</strong>: if this is the first project for a locale, the first step is to <a href="tools/pontoon/managing_pretranslation.html#train-and-set-up-a-custom-machine-translation-model">train and set up the custom machine translation model</a> in Google AutoML Translation.</p>
<p>Use the checkbox <code>PRETRANSLATION ENABLED</code> to enable the feature for the project, then move the requested locales from the <code>Available</code> list to <code>Chosen</code>. Clicking the <code>PRETRANSLATE</code> button will pretranslate immediately all missing strings in enabled locales, otherwise pretranslation will run automatically as soon as new strings are added to the project.</p>
<h2 id="train-and-set-up-a-custom-machine-translation-model"><a class="header" href="#train-and-set-up-a-custom-machine-translation-model">Train and set up a custom machine translation model</a></h2>
<p>To improve performance of the machine translation engine powering the pretranslation feature, custom machine translation models are trained for each locale using Pontoon’s translation memory. That results in better translation quality than what’s provided by the generic machine translation engine.</p>
<p>To create a custom translation model, first go to the <a href="https://mozilla-l10n.github.io/localizer-documentation/tools/pontoon/teams_projects.html#team-page">team page</a> of the locale you are creating a custom translation model for and download its <a href="https://mozilla-l10n.github.io/localizer-documentation/tools/pontoon/translate.html#downloading-and-uploading-translations">translation memory file</a>. Next, go to the <a href="https://console.cloud.google.com/translation/datasets?project=moz-fx-pontoon-prod">Google Cloud console</a> (requires permission) and follow these instructions — in case of doubt, consult the <a href="https://cloud.google.com/translate/automl/docs/create-machine-translation-model">official instructions</a>.</p>
<p>The first step is to create a translation dataset. In the <code>Datasets</code> panel, select <code>CREATE DATASET</code>:</p>
<ul>
<li>For the <code>Dataset name</code>, follow the pattern used by existing datasets: <code>dataset_LOCALE_YYYY_MM_DD</code> (e.g. <code>dataset_pt-BR_2023_09_20</code>).</li>
<li>Select the <code>Translate from…</code> language (<code>English (EN)</code>) and the <code>Translate to…</code> language (e.g. <code>Portuguese (PT)</code> for <code>pt-BR</code>).</li>
<li>Click <code>CREATE</code>.</li>
</ul>
<p>This operation will take a few seconds. At the end, an empty dataset with the selected name will be available in the list, with <code>0</code> in the <code>Total pairs</code> column. It’s now time to import Pontoon’s translation memory and train the model:</p>
<ul>
<li>Click the dataset, then navigate to the <code>IMPORT</code> tab.</li>
<li>Use <code>SELECT FILES</code> to select the downloaded TMX file from your device.</li>
<li>Click <code>BROWSE</code> in the <code>Destination on Cloud Storage</code> field and select <code>pontoon-prod-model-data-c1107144</code>.</li>
<li>Click <code>CONTINUE</code> to start the import process. The import process will take a few minutes (it’s possible to close this window and return later to the list of datasets, when completed the <code>Status</code> column will say <code>Success: ImportData</code>).</li>
<li>Once the import is completed, navigate to the <code>TRAIN</code> tab and click <code>START TRAINING</code>.</li>
</ul>
<p>Note that creating the model is a background job which takes a few hours (when completed the <code>Status</code> column will say <code>Success: CreateModel</code>), and models for at most 4 locales can be trained concurrently. When the model is created, store its name (usually starting with <code>NM</code>, followed by a series of alphanumeric characters) under <em>Google automl model</em> in the <a href="https://pontoon.mozilla.org/a/">Django’s admin interface</a> of the locale.</p>
<p>From that point on, Machinery will start using the custom machine translation model instead of the generic one and you’ll be set to enable pretranslation for the locale.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sending-notifications-in-pontoon"><a class="header" href="#sending-notifications-in-pontoon">Sending notifications in Pontoon</a></h1>
<p>Pontoon allows you to send in-app notifications to contributors of a specific project. To do so, go to your project dashboard and select the <a href="https://pontoon.mozilla.org/projects/pontoon-intro/notifications/">Notifications</a> tab.</p>
<h2 id="choose-recipient-teams"><a class="header" href="#choose-recipient-teams">Choose recipient teams</a></h2>
<p>First you need to select project teams to send the notification to. You can select them manually or by using one of the available shortcuts:</p>
<ul>
<li><strong>All:</strong> all teams translating the project.</li>
<li><strong>Complete:</strong> teams with all strings translated in the project.</li>
<li><strong>Incomplete:</strong> teams that have untranslated strings in the project.</li>
</ul>
<p>All project contributors from selected teams will receive the notification.</p>
<p>You need to select at least one team.</p>
<h3 id="enter-notification-message"><a class="header" href="#enter-notification-message">Enter notification message</a></h3>
<p>Next, enter the message you’d like to send. You can use HTML tags. Try to be concise and use HTML wisely.</p>
<h3 id="send"><a class="header" href="#send">Send</a></h3>
<p>To send the notification, simply click the <strong>Send</strong> button and wait for the confirmation message to appear. It might take a moment. Once notifications are sent, you’ll be redirected to the Sent notifications panel.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="renaming-a-localization-file-in-a-project-without-losing-data"><a class="header" href="#renaming-a-localization-file-in-a-project-without-losing-data">Renaming a localization file in a project without losing data</a></h1>
<p>In some cases, project owners will want to rename a file for clarity, or for technical reasons. If it’s only done in the VCS repository, the file will be imported again and you will lose attribution, pending suggestions and history. Since this is a special case, we can work around this and rename the file in Pontoon while keeping existing data (translations, suggestions, attribution, history). The process is not complicated, but it has to be highly coordinated.</p>
<h2 id="get-a-pull-request-ready"><a class="header" href="#get-a-pull-request-ready">Get a Pull Request ready</a></h2>
<p>Either you or the project owners will get a Pull Request ready that renames the file for all locales. Using a script is recommended as you will need to generate the patch not too long before the next steps to avoid conflicts.</p>
<h2 id="rename-the-resource-in-pontoon-admin-panel"><a class="header" href="#rename-the-resource-in-pontoon-admin-panel">Rename the resource in Pontoon admin panel</a></h2>
<p>Wait for the current Pontoon sync cycle to end, and make sure you are already logged into Pontoon admin, then merge the Pull Request.</p>
<p>As soon as the Pull Request is merged, go to the <a href="https://pontoon.mozilla.org/a/base/resource/">resource section</a> of the admin panel, then type the name of your project (e.g. <code>thimble</code>) and hit <code>Enter</code>. All the resources for your project should appear. Click on the one you want to rename, and in the <code>path</code> field, for instance rename <code>messages.properties</code> into <code>server.properties</code> then click <code>SAVE</code>.</p>
<p>It is crucial to do this step <strong>before</strong> the next sync cycle, otherwise the process won’t be effective.</p>
<p>After the next sync, open the file for one of the locales, you should be able to see all the existing data.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deactivating-pontoon-users"><a class="header" href="#deactivating-pontoon-users">Deactivating Pontoon users</a></h1>
<p>Access Django’s admin interface at <code>https://pontoon.mozilla.org/a/</code> (note that this is not the usual admin interface), then click <code>Users</code>. In the next page search for the user you want to deactivate (safer to search by email address):</p>
<ul>
<li>Click on the user among the results displayed under the search field.</li>
<li>In the <em>Permissions</em> section, deselect the <code>Active</code> checkbox and click <code>SAVE</code> at the bottom of the page.</li>
</ul>
<p>This will prevent them from logging into Pontoon, and will log them out of the system immediately.</p>
<p>It’s possible to safely remove users with all the associated data. Refer to <a href="tools/pontoon/removing_users.html">Removing users</a> for more details.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="removing-pontoon-users"><a class="header" href="#removing-pontoon-users">Removing Pontoon users</a></h1>
<p>Access Django’s admin interface at <code>https://pontoon.mozilla.org/a/</code> (note that this is not the usual admin interface), then click <code>Users</code>. In the next page search for the user you want to remove (safer to search by email address):</p>
<ul>
<li>Click on the user among the results displayed under the search field.</li>
<li>Click <code>Delete</code> at the bottom of the page.</li>
<li>A confirmation page will appear with the list of user data to be deleted. We make sure the relevant data like translations and comments are kept. Click <code>Yes</code> to proceed.</li>
</ul>
<p>Note that you can also delete multiple users at once by selecting the checkboxes and choosing the <code>Delete selected users</code> action from the dropdown.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-new-terms-to-terminology-on-pontoon"><a class="header" href="#adding-new-terms-to-terminology-on-pontoon">Adding new terms to terminology on Pontoon</a></h1>
<p>To add new terms to Pontoon, access Django’s admin interface at <code>https://pontoon.mozilla.org/a/</code> (note that this is not the usual admin interface), then follow the steps below.</p>
<p>Find and click <code>Terms</code> on the navigation pane on the left. Check on the following page to make sure a term does not already exist by searching in the search field near the top.</p>
<p>To add a new term, click <code>ADD TERM +</code>. The next page will have the following fields:</p>
<ul>
<li>Text (required): Term you wish to register.</li>
<li>Part of speech (required): Select the part of speech that applies to your term. In some cases the same string can be registered twice with different parts of speech, e.g. bookmark as a noun (“open your bookmarks”) or as a verb (“bookmark this website”).</li>
<li>Definition: Meaning of the term, or explanation of what the term is.</li>
<li>Usage: Example usage of the term.</li>
<li>Notes: Any other notes or context that could be relevant.</li>
<li>Case sensitive: Select if the term should only match when case matches.</li>
<li>Do not translate: Select if the term should not be translated (example brand names like Firefox).</li>
<li>Forbidden: Select if this term should not be used.</li>
</ul>
<p>Once the necessary information has been filled out, click one of the three save options <code>Save and add another</code>, <code>Save and continue editing</code>, or <code>SAVE</code> to register the term to Pontoon.</p>
<p>This term will automatically populate in the terminology projects for all locales for translation, and will also appear in the <code>TERMS</code> pane of the translation UI when it appears in a string.</p>
<p>Note that only the following fields are displayed in Pontoon as a localization comment for the term: part of speech, definition, usage.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-mercurial"><a class="header" href="#working-with-mercurial">Working with Mercurial</a></h1>
<p>How to set up and work with Mercurial:</p>
<ul>
<li><a href="tools/mercurial/setting_mercurial_environment.html">Set up the environment</a>.</li>
<li><a href="tools/mercurial/creating_mercurial_patch.html">Create a patch</a>.</li>
<li><a href="tools/mercurial/useful_mercurial_commands.html">Useful Mercurial commands</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-up-the-environment-for-mercurial"><a class="header" href="#set-up-the-environment-for-mercurial">Set up the environment for Mercurial</a></h1>
<p><strong>IMPORTANT:</strong> This configuration has to be done only once on the computer. After that you will simply need to keep Mercurial up to date (a new version is released every month).</p>
<h2 id="mercurial"><a class="header" href="#mercurial">Mercurial</a></h2>
<p>Most of the work needs to be done in <a href="https://www.mercurial-scm.org/downloads">Mercurial</a>, so you need to install if first. An alternative way to install it on macOS is via <a href="https://brew.sh/">homebrew</a> with <code>brew install hg</code> (<code>brew upgrade hg</code> to update it later).</p>
<p>To check if Mercurial is available and up to date, run in the terminal <code>hg --version</code>, the output should look like this:</p>
<pre><code class="language-BASH">$ hg --version
Mercurial Distributed SCM (version 4.0.1)
(see https://mercurial-scm.org for more information)

Copyright (C) 2005-2016 Matt Mackall and others
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre>
<p>Unless you’re familiar with <code>vi</code>, you also want to setup <code>nano</code> as the default editor in the system.</p>
<pre><code class="language-BASH">$ export EDITOR=/usr/bin/nano
</code></pre>
<h2 id="mercurial-configuration"><a class="header" href="#mercurial-configuration">Mercurial configuration</a></h2>
<p>Mercurial’s configuration is stored in a hidden file called <code>.hgrc</code> inside your user folder (<code>~/.hgrc</code>). You will need to create it if it’s not available on the system.</p>
<p>It’s divided into sections, with section names between square parentheses. For example:</p>
<pre><code class="language-INI">[ui]
username = something@example.com
</code></pre>
<h2 id="set-up-ssh-access-for-l10n-repositories"><a class="header" href="#set-up-ssh-access-for-l10n-repositories">Set up SSH access for l10n repositories</a></h2>
<p>In order to be able to commit directly to l10n repositories, you need SSH access via your LDAP account (both obtained through a bug, where you also provide your SSH key).</p>
<p>Assuming your SSH key is stored in <code>~/.ssh/id_rsa</code>, your <code>.ssh/config</code> file should have a line that looks like this</p>
<pre><code>Host hg.mozilla.org
User YOUR_LDAP_EMAIL_ADDRESS
IdentityFile ~/.ssh/id_rsa
</code></pre>
<h2 id="set-up-mozphab-for-phabricator"><a class="header" href="#set-up-mozphab-for-phabricator">Set up MozPhab for Phabricator</a></h2>
<p>Detailed instructions and explanations are available in <a href="https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html#setting-up-mozphab">the official documentation</a>.</p>
<p>You also need to <a href="https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html">create an account</a> on Phabricator and <a href="https://phabricator.services.mozilla.com/">log in</a>.</p>
<p>The configuration will be completed after cloning <code>mozilla-unified</code>.</p>
<h2 id="cloning-and-updating-mozilla-unified"><a class="header" href="#cloning-and-updating-mozilla-unified">Cloning and updating mozilla-unified</a></h2>
<p>Since searchplugins are stored in mozilla-central, you will also need a clone of it on your computer. Using the <a href="https://mozilla-version-control-tools.readthedocs.io/en/latest/hgmozilla/unifiedrepo.html">mozilla-unified repository</a> repository is a better solution, especially if you need to work on more than just mozilla-central.</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/
$ hg clone https://hg.mozilla.org/mozilla-unified
</code></pre>
<p>To update the existing repository:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/mozilla-unified
$ hg pull -u
$ hg up central
</code></pre>
<p>The last command makes sure you’re working against central (to be more precise, it moves you to the <code>central</code> bookmark).</p>
<p>Now you can complete the setup for MozPhab. Follow the instructions on screen to complete, it will require you to connect to Phabricator and generate an API key to copy in the terminal:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/mozilla-unified
$ moz-phab install-certificate
</code></pre>
<h2 id="mercurial-configuration-1"><a class="header" href="#mercurial-configuration-1">Mercurial configuration</a></h2>
<p>Mercurial configuration is stored in the <code>.hgrc</code> file in the user’s home directory.</p>
<p>Useful extensions are <code>Mercurial Queues Extension</code> (queues), <code>color</code> (colorize output, for example diffs) and <code>purge</code> (to remove untracked files from the repository). If the <code>.hgrc</code> file doesn’t have an <code>[extensions]</code> section create one and add the following lines:</p>
<pre><code class="language-INI">[extensions]
mq =
color =
purge =
</code></pre>
<p>Some aliases are also useful to work with bookmarks:</p>
<pre><code class="language-INI">[alias]
shortlog = log --template &quot;{node|short} | {date|isodatesec} | {author|user}: {desc|strip|firstline}\n&quot;
wip = log --graph --rev=wip --template=wip

[revsetalias]
wip = (parents(not public()) or not public() or . or (head() and branch(default))) and (not obsolete() or orphan()^) and not closed()
# If firefoxtree is enabled
# wip = (parents(not public()) or not public() or . or (head() and branch(default))) and (not obsolete() or orphan()^) and not closed() and not (fxheads() - date(-90))

[templates]
wip = '{label(&quot;log.branch&quot;, branches)} {label(&quot;changeset.{phase}&quot;, rev)}{label(&quot;changeset.{phase}&quot;, &quot;:&quot;)}{label(&quot;changeset.{phase}&quot;, short(node))} {label(&quot;grep.user&quot;, author|user)}{label(&quot;log.tag&quot;, if(tags,&quot; {tags}&quot;))}{label(&quot;log.tag&quot;, if(fxheads,&quot; {fxheads}&quot;))} {label(&quot;log.bookmark&quot;, if(bookmarks,&quot; {bookmarks}&quot;))}\n{label(ifcontains(rev, revset(&quot;.&quot;), &quot;desc.here&quot;),desc|firstline)}'
</code></pre>
<h2 id="text-editor"><a class="header" href="#text-editor">Text editor</a></h2>
<p>The suggestion is to use <a href="https://code.visualstudio.com/download">Visual Studio Code</a>.</p>
<p>If you don’t like to use <code>nano</code> to edit commit messages, you can also use a graphical editor. A possible alternative on macOS is to use <a href="https://macromates.com/">TextMate</a>: after installing it, open Preferences and install the <em>Shell support</em> (<em>Terminal</em> tab), then add a <code>editor</code> preference to <code>.hgrc</code>.</p>
<pre><code class="language-INI">[ui]
username = YOUR NAME &lt;YOUR EMAIL&gt;
ignore.other = ~/.hgignore
editor = mate -w
</code></pre>
<p>You can also use Visual Studio Code, but it’s definitely slower.</p>
<pre><code class="language-INI">[ui]
username = YOUR NAME &lt;YOUR EMAIL&gt;
ignore.other = ~/.hgignore
editor = code --wait
</code></pre>
<p>In general, in order to be able to use it for commit messages, you’ll need a text editor available from the command line, and with a <code>wait</code> option.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-a-patch-in-mercurial"><a class="header" href="#create-a-patch-in-mercurial">Create a patch in Mercurial</a></h1>
<ul>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch-using-phabricator">Creating a patch using Phabricator</a>
<ul>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch">Creating a patch</a></li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#updating-an-existing-patch">Updating an existing patch</a>
<ul>
<li><a href="tools/mercurial/creating_mercurial_patch.html#amend-the-last-commit">Amend the last commit</a></li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#create-a-new-commit-and-squash-history">Create a new commit and squash history</a></li>
</ul>
</li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#landing-the-patch">Landing the patch</a></li>
</ul>
</li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch-using-queues">Creating a patch using Queues</a>
<ul>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch-1">Creating a patch</a></li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#updating-an-existing-patch-1">Updating an existing patch</a></li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#landing-the-patch-1">Landing the patch</a></li>
</ul>
</li>
</ul>
<p>There are currently two different methods available to create a patch for Mercurial repositories:</p>
<ul>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch-using-phabricator">Using <strong>Phabricator</strong></a>.</li>
<li><a href="tools/mercurial/creating_mercurial_patch.html#creating-a-patch-using-queues">Using <strong>Mercurial Queues</strong></a> (<code>mq</code> extension).</li>
</ul>
<p>Phabricator is the preferred method for patches to main code repositories, like <code>mozilla-central</code>. On the other hand, Queues is the only tool available for patches to l10n repositories.</p>
<p>As a general rule, before creating a patch, make sure that your environment is <a href="tools/mercurial/../../tools/mercurial/setting_mercurial_environment.html">correctly set up</a>, and update your local clones.</p>
<h2 id="creating-a-patch-using-phabricator"><a class="header" href="#creating-a-patch-using-phabricator">Creating a patch using Phabricator</a></h2>
<h3 id="creating-a-patch"><a class="header" href="#creating-a-patch">Creating a patch</a></h3>
<p>Consider the following example: setting up productization for Urdu (ur) on Firefox desktop. After you’ve created or edited all the files you need, check the status of the repository.</p>
<pre><code class="language-BASH">$ hg status
M browser/locales/search/list.json
? browser/locales/searchplugins/amazon-in.xml
? browser/locales/searchplugins/wikipedia-ur.xml
</code></pre>
<p>These are all status codes relevant for working with patches:</p>
<ul>
<li>M = modified. File was already tracked but has been modified.</li>
<li>A = added. File is new and was already added with <code>hg add</code>.</li>
<li>R = removed. File has been removed with <code>hg remove</code>.</li>
<li>! = missing. File has been removed from the filesystem but it’s still tracked. Use <code>hg remove</code> to stop tracking it.</li>
<li>? = not tracked. File is not tracked yet. You can start tracking it by using <code>hg add</code>.</li>
</ul>
<p>Note that the file status will change once you commit, <code>hg status</code> only shows information about pending changes.</p>
<p>Now you need to add the new files. You can add them using the full path, or a parent folder, just make sure you’re not adding unnecessary files.</p>
<pre><code class="language-BASH">$ hg add browser/locales/searchplugins
$ hg status
M browser/locales/search/list.json
A browser/locales/searchplugins/amazon-in.xml
A browser/locales/searchplugins/wikipedia-ur.xml
</code></pre>
<p>Let’s create a bookmark for this pending work, for example <code>bug1304757</code>.</p>
<pre><code class="language-BASH">$ hg bookmark bug1304757
</code></pre>
<p>Commit the changes. In the commit message:</p>
<ul>
<li>Don’t forget to start with the bug number, i.e. <code>Bug XXXXXX -</code></li>
<li>At the end of the commit message, add the reviewer with the format <code>r=phab_user</code>. <code>phab_user</code> is the reviewer’s username on Phabricator, e.g. <code>flod</code>. You can add an exclamation mark at the end to set it as blocking reviewer, i.e. <code>r=phab_user!</code>.</li>
</ul>
<pre><code class="language-BASH">$ hg commit -m &quot;Bug 1304757 - [ur] Search engine setup for Firefox for Urdu, r=flod!&quot;
</code></pre>
<p>At this point you can check the status of the tree:</p>
<pre><code class="language-BASH">$ hg wip
</code></pre>
<p>And you should be able to identify your work and bookmark (press <code>q</code> to leave this view):</p>
<pre><code>@   358728:c0b04112d4e6 flod tip  bug1304757
|  Bug 1304757 - [ur] Search engine setup for Firefox for Urdu, r?flod
| o   358726:f7834b7b4050 aosmond  inbound
|/:  Bug 1299498 - Keep a main thread only pointer to the underlying nsIURI for ImageURL. r=tnikkel
| : o   358715:6f79cece26e9 ffxbld  beta
| : |  No bug, Automated blocklist update from host bld-linux64-spot-245 - a=blocklist-update
| : ~
| : o   358714:f5f73390f439 ffxbld  release
| : |  No bug, Automated blocklist update from host bld-linux64-spot-246 - a=blocklist-update
| : ~
o :   358709:f8107cf96144 cbook  central
:/   merge mozilla-inbound to mozilla-central a=merge
</code></pre>
<p>To push to Phabricator use:</p>
<pre><code>$ moz-phab
</code></pre>
<p>You can add <code>-s</code> to only push a single commit, i.e. <code>moz-phab -s</code>.</p>
<p>Once published, the review request will be attached automatically to the bug, and the reviewer will be flagged. Note that you can also update information about the patch, like reviewer or bug, directly in Phrabricator after pushing with MozPhab.</p>
<h3 id="updating-an-existing-patch"><a class="header" href="#updating-an-existing-patch">Updating an existing patch</a></h3>
<p>If you need to address review comments, you can restore your branch by switching to your bookmark, and start working on it again.</p>
<pre><code class="language-BASH">$ hg up bug1304757
</code></pre>
<p>You can check which bookmark is currently active with <code>hg bookmarks</code>:</p>
<pre><code class="language-BASH">$ hg bookmarks
   aurora                    359014:96503957841c
   beta                      359025:34c73c520f93
 * bug1304757                359034:bde380bc54ff
   central                   358999:a69583d2dbc6
</code></pre>
<p>After addressing the review comments and editing your local files, you have two choices to save your work:</p>
<ul>
<li>Amend the last commit.</li>
<li>Create a new commit and squash history.</li>
</ul>
<h4 id="amend-the-last-commit"><a class="header" href="#amend-the-last-commit">Amend the last commit</a></h4>
<p>To amend the last commit, simply execute:</p>
<pre><code class="language-BASH">$ hg commit --amend
</code></pre>
<p>Then confirm (or edit) the commit message by saving with <code>CTRL+O</code> and exiting with <code>CTRL+X</code> (assuming the default editor is nano). Finally, update Phabricator (don’t make changes to the metadata in the commit):</p>
<pre><code class="language-BASH">$ moz-phab
</code></pre>
<h4 id="create-a-new-commit-and-squash-history"><a class="header" href="#create-a-new-commit-and-squash-history">Create a new commit and squash history</a></h4>
<p>If you prefer to have a separate commit, execute:</p>
<pre><code class="language-BASH">$ hg commit -m &quot;Address review comments&quot;
</code></pre>
<p>Then squash the commits together by editing history:</p>
<pre><code class="language-BASH">$ hg histedit
</code></pre>
<p>The following screen will look like this:</p>
<pre><code>pick f6f70f6de69c 358597 Bug 123456 - [ur] Search engine setup for Firefox fo...
pick 8088fd8658fd 358598 Fix searchplugin name

# Edit history between f6f70f6de69c and 8088fd8658fd
#
# Commits are listed from least to most recent
#
# You can reorder changesets by reordering the lines
#
# Commands:
#
#  e, edit = use commit, but stop for amending
#  m, mess = edit commit message without changing commit content
#  p, pick = use commit
#  d, drop = remove commit from history
#  f, fold = use commit, but combine it with the one above
#  r, roll = like fold, but discard this commit's description
#
</code></pre>
<p>In this case you want to <em>roll</em> the second commit into the first one, so replace <code>pick</code> with <code>roll</code> (or <code>r</code>), save with <code>CTRL+O</code> and exit with <code>CTRL+X</code> (assuming the default editor is nano).</p>
<pre><code>pick f6f70f6de69c 358597 Bug 123456 - [ur] Search engine setup for Firefox fo...
roll 8088fd8658fd 358598 Fix searchplugin name

...
</code></pre>
<p>Update Phabricator (you will need to provide a commit message):</p>
<pre><code class="language-BASH">$ moz-phab
</code></pre>
<p>You can also use <code>hg histedit</code> to reword a commit message (set the commit line to <code>edit</code>). Just remember to complete the <code>histedit</code> after commit.</p>
<pre><code class="language-BASH">$ hg commit -m &quot;Some changes&quot;
$ hg histedit --continue
</code></pre>
<p>If necessary, you can rebase against another bookmark, like <code>central</code> or <code>inbound</code></p>
<pre><code class="language-BASH">$ hg rebase -d central
</code></pre>
<p>More information about this workflow are available in the following pages:</p>
<ul>
<li>https://mozilla-version-control-tools.readthedocs.io/en/latest/hgmozilla/firefoxworkflow.html</li>
<li>https://www.mercurial-scm.org/wiki/Bookmarks</li>
</ul>
<h3 id="landing-the-patch"><a class="header" href="#landing-the-patch">Landing the patch</a></h3>
<p>Once the patch has been reviewed, you have two options:</p>
<ul>
<li>If you have L3 access to the repository, you can use <a href="https://moz-conduit.readthedocs.io/en/latest/lando-user.html">Lando</a> to land your commit directly. If your reviewer has it, you can ask them to land.</li>
</ul>
<h2 id="creating-a-patch-using-queues"><a class="header" href="#creating-a-patch-using-queues">Creating a patch using Queues</a></h2>
<h3 id="creating-a-patch-1"><a class="header" href="#creating-a-patch-1">Creating a patch</a></h3>
<p>Consider the following example: setting up productization for Urdu (ur) on Firefox desktop (l10n repository). The first step is to create a <code>region.properties</code> file. Move into the repository folder and check its status:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg status
? browser/chrome/browser-region/region.properties
</code></pre>
<p>File is brand new and needs to be added:</p>
<pre><code class="language-BASH">$ hg add browser

$ hg status
A browser/chrome/browser-region/region.properties
</code></pre>
<p>You need to assign a name to this patch, it’s easy to use a reference to the bug number: for example, if the bug number is 123456, the file could be called <code>bug123456.patch</code> (note the added extension <code>.patch</code>).</p>
<pre><code class="language-BASH">$ hg qnew bug123456.patch
</code></pre>
<p>At this point you will be asked to provide a commit message for your patch (in <code>nano</code> if you followed the instructions to set up the environment): write your commit message, then press <code>CTRL+O</code> to save the file, <code>enter</code> to confirm the proposed filename, and finally <code>CTRL+X</code> to exit the editor.</p>
<p>The commit message should be the same as the bug, for example <code>Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox desktop</code>.</p>
<p>You are ready to <em>pop</em> the patch out of the queue. Since it’s likely that there are no other patches, you can pop them all with <code>-a</code>.</p>
<pre><code class="language-BASH">$ hg qpop -a
popping bug123456.patch
patch queue now empty
</code></pre>
<p>The patch is stored inside the <code>.hg/patches</code> folder in the root of the repository (in the suggested setup, the full path would be <code>~/mozilla/mercurial/l10n-central/.hg/patches</code>). You can copy the file through the command line or the file explorer. For example, on macOS you can open the folder in Finder by typing:</p>
<pre><code class="language-BASH">$ open ~/mozilla/mercurial/l10n/ur/l10n-central/.hg/patches
</code></pre>
<p>Or you can copy the file on the Desktop with</p>
<pre><code class="language-BASH">$ cp ~/mozilla/mercurial/l10n/ur/l10n-central/.hg/patches/bug123456.patch ~/Desktop
</code></pre>
<p>Now you need to attach the file to Bugzilla and set an appropriate reviewer for it.</p>
<h3 id="updating-an-existing-patch-1"><a class="header" href="#updating-an-existing-patch-1">Updating an existing patch</a></h3>
<p>Let’s assume that the review found some issues with the patch and you need to update it. The fastest way is to import the .patch file without committing, update the files as needed, and create a new patch using the same process explained above.</p>
<p>Assuming the file is called <code>bug123456.patch</code> and it’s in your desktop, you can move in the repository folder and import the file like this:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg import --no-commit ~/Desktop/bug123456.patch
</code></pre>
<p>Don’t forget the <code>--no-commit</code> part. If you do, the patch will be added to your repository and you’ll need to clone the original repository again.</p>
<!-- markdownlint-disable MD038 -->
<p><strong>Note:</strong> You can drag and drop the patch file on the terminal on macOS to get its full path instead of typing it. In other words, type <code>hg import --no-commit </code> (leave an empty space at the end), then drag the icon of the patch on the Terminal’s window: its full path will appear automatically.</p>
<!-- markdownlint-enable MD038 -->
<p>At this point you’re ready to modify the files, and create a new patch. The only difference is that you will need to use a different filename, for example <code>bug123456v1.patch</code>.</p>
<h3 id="landing-the-patch-1"><a class="header" href="#landing-the-patch-1">Landing the patch</a></h3>
<p>Your patch got a <code>r+</code>, so you need to update the commit message to reference the review, import the patch and push it to the remote server.</p>
<p><strong>Note:</strong> If the patch is for a repository where you don’t have write access, you don’t need to follow these instructions, only to set the <code>checkin-needed</code> flag in Bugzilla.</p>
<p>Open the .patch file in your editor, find the line with the commit message, and add <code>r=NICKNAME</code> to the commit message. For example, the last line in</p>
<pre><code># HG changeset patch
# User SOMENAME &lt;SOME EMAIL&gt;
# Parent  b45d23bc53df9227aa262acb2a5c6b0ab903b76e
Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox for Android
</code></pre>
<p>Should become like this, assuming flod is the reviewer.</p>
<pre><code>Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox for Android, r=flod
</code></pre>
<p>Then you need to import the patch, this time without the <code>no-commit</code> parameter.</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg import ~/Desktop/bug123456.patch
</code></pre>
<p>The patch has been imported and committed. If you get an error while applying the patch, check if the editor you’re using hasn’t modified other lines of the patch, for example removing trailing whitespaces. In that case, using <code>nano</code> to edit the patch is probably your faster option.</p>
<p>Now you’re ready to push to the remote repository</p>
<pre><code class="language-BASH">$ hg push
</code></pre>
<p>The reply from the server will contain the URL to your changeset: copy and paste that URL in the bug. If the bug only contains a patch to region.properties, you can close the bug after landing; if it also contains a patch stored in MozReview, the bug will be automatically closed when the patch is merged to mozilla-central.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="useful-mercurial-commands"><a class="header" href="#useful-mercurial-commands">Useful Mercurial commands</a></h1>
<h2 id="display-log"><a class="header" href="#display-log">Display log</a></h2>
<p>To display the log you can use <code>hg log -l NUMBER</code>, where <em>NUMBER</em> is the number of commits. Note that Mercurial uses <code>l</code> instead of Git’s <code>n</code>. Use the space bar to move to the next page if the results don’t fit in the screen.</p>
<p>You can also browse the history by running <code>hg serve</code> within the repository folder, then opening http://localhost:8000</p>
<h2 id="display-content-of-the-last-commit"><a class="header" href="#display-content-of-the-last-commit">Display content of the last commit</a></h2>
<p>To display the content of the last commit you can use:</p>
<pre><code class="language-BASH">$ hg log --patch --rev tip
</code></pre>
<p>Press the space bar to move to the next page, <code>q</code> to quit.</p>
<h2 id="revert-staged-changes"><a class="header" href="#revert-staged-changes">Revert staged changes</a></h2>
<p>Let’s assume that you have staged (uncommitted) changes in your repositories but you want to go back to a clean state:</p>
<ul>
<li>If you only want to reset one file, you can use <code>hg revert FILENAME</code>. Note that this will leave a <code>FILENAME.orig</code> in the repository, in case you decide to change your mind. To avoid that, use the <code>-C</code> option: <code>hg revert -C FILENAME</code>. You can use this command also to restore a file marked as <code>!</code> (missing in the filesystem, but still tracked).</li>
<li><code>hg up -C</code> will reset all changed files to the last commit. Note that it won’t remove untracked files.</li>
<li>To remove all untracked files, you can use the <code>purge</code> extension and run <code>hg purge</code>. It won’t remove staged changes, like modified files still uncommitted.</li>
</ul>
<h2 id="revert-changes-already-committed"><a class="header" href="#revert-changes-already-committed">Revert changes already committed</a></h2>
<p>If you want to revert changes already committed:</p>
<ul>
<li>To backout a specific changeset use <code>hg backout -r CHANGESET</code>. This will prompt you directly with a request for the commit message to use in the backout.</li>
<li>To revert a file to a specific changeset, use <code>hg revert -r CHANGESET FILENAME</code>. This will revert the file without committing it.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="miscellaneous-documentation"><a class="header" href="#miscellaneous-documentation">Miscellaneous documentation</a></h1>
<ul>
<li><a href="misc/creating_new_repository.html">How to create a new repository for localization projects</a>.</li>
<li><a href="misc/working_w_l10n_agency.html">How to work with a Localization Agency</a>.</li>
<li><a href="misc/documentation_styleguide.html">Documentation styleguide</a>.</li>
<li><a href="misc/stock_emails.html">Stock email for interaction with localizers and vendors</a>.</li>
<li><a href="misc/terminology_export.html">Exporting terminology from Pontoon to Smartling</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-new-repository-for-projects"><a class="header" href="#creating-a-new-repository-for-projects">Creating a new repository for projects</a></h1>
<p>Creating a new repository in the <a href="https://github.com/mozilla-l10n">mozilla-l10n</a> organization provides the advantage of letting l10n-drivers manage this repository directly, reducing delays when dealing with permissions. It also allows localizers to work directly on GitHub with pull requests.</p>
<p>Note that you need to be a manager of the organization in order to create a new repository.</p>
<h2 id="create-the-new-repository"><a class="header" href="#create-the-new-repository">Create the new repository</a></h2>
<p>A new repository can be created in <a href="https://github.com/organizations/mozilla-l10n/repositories/new">this page</a>, or using the <strong>New</strong> button in the organization’s landing page.</p>
<p><strong>Name</strong>: always include the <code>-l10n</code> suffix for localization repositories, to differentiate them from other repositories used for tools.</p>
<p>For example, if the project is <em>Focus for Android</em>, a good repository name is <code>focus-android-l10n</code>.</p>
<p><strong>Description</strong>: add a short description, e.g. <code>Strings for the Focus (Android) project</code>.</p>
<p>Set the project as <strong>Public</strong> and don’t initialize it with a README.</p>
<p><img src="misc/../assets/images/new_repository/new_repo.png" alt="New repository" /></p>
<h2 id="add-collaborators"><a class="header" href="#add-collaborators">Add collaborators</a></h2>
<p>Go into the project settings:</p>
<ul>
<li>Add the relevant l10n-drivers as Admin (<a href="https://docs.github.com/en/github/setting-up-and-managing-your-github-user-account/managing-access-to-your-personal-repositories/inviting-collaborators-to-a-personal-repository">see GitHub documentation</a>). You can either pick individuals or one of the pre-existing groups.</li>
<li>Add the <strong>Tool-bots</strong> group with <strong>Write</strong> permissions to give Pontoon write access. If localizers need direct access, you can use the <strong>Localizers</strong> group.</li>
<li>Add relevant developers as contributors if they need to make commits to the repository (that’s usually the case, in order to update strings).</li>
</ul>
<h2 id="add-a-readmemd-to-the-project"><a class="header" href="#add-a-readmemd-to-the-project">Add a README.md to the project</a></h2>
<p>Add a README with some useful information about the project. For example, for Focus for Android:</p>
<pre><code># Focus by Firefox localization
Localization for the Focus by Firefox project for Android.

The application code with build instructions can be found
at &lt;https://github.com/mozilla-mobile/focus-android&gt;.

# License
Translations in this repository are available under the
terms of the [Mozilla Public License v2.0](https://www.mozilla.org/MPL/2.0/).
</code></pre>
<h2 id="add-a-codeowners-file"><a class="header" href="#add-a-codeowners-file">Add a CODEOWNERS file</a></h2>
<p>It’s possible to add a <em>CODEOWNERS</em> file to automatically ping the owner of the project in case of pull requests. File can be placed in the root of the repository or specific subfolders (<a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-code-owners">see GitHub documentation</a>), it’s called <code>CODEOWNERS</code> and uses the following format:</p>
<pre><code>path/to/files/to/monitor @nickname_of_owner
</code></pre>
<p>For example, this is the content of the <a href="https://github.com/mozilla-l10n/focus-android-l10n/blob/master/CODEOWNERS">CODEOWNERS</a> file for Focus for Android:</p>
<pre><code>locales/templates/*.pot @delphine
</code></pre>
<p>Pull requests to update strings always modify <code>locales/templates/app.pot</code>, while <code>delphine</code> is the nickname of the PM in charge of this product. Any pull request trying to modify files matching that path will automatically send a review request to the code owner.</p>
<h2 id="add-topics-to-the-repository-optional"><a class="header" href="#add-topics-to-the-repository-optional">Add topics to the repository (optional)</a></h2>
<p>In the main repository page you can add <a href="https://github.com/blog/2309-introducing-topics">topics</a> to make the repository more discoverable by potential contributors. For example, all localization projects have the following topics: mozilla-l10n, localization, translation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-with-a-localization-agency"><a class="header" href="#working-with-a-localization-agency">Working with a Localization Agency</a></h1>
<p>This document is a guideline for project manager who interacts with a localization agency that already successfully went through our <a href="https://docs.google.com/document/d/1Y0xfGo-24ZJI_uYFLtJFcuxCi20FNIqaeEc7v_FlaY4/edit">vetting process</a>. Our vetting process helps us ensure the vendors we work with are able to deliver translations in a timely manner, with the required level of quality and following our localization processes. We are also assessing their flexibility to work efficiently with our communities and our tools when it’s required.</p>
<h2 id="initial-set-up-before-sending-localization-requests"><a class="header" href="#initial-set-up-before-sending-localization-requests">Initial set up before sending localization requests</a></h2>
<h3 id="ask-for-a-rate-sheet"><a class="header" href="#ask-for-a-rate-sheet">Ask for a rate sheet</a></h3>
<ul>
<li>Make sure you have received a rate sheet customized for Mozilla needs. This should have been sent as part of the vetting process, and it can be updated annually. An example of the official <a href="https://drive.google.com/a/mozilla.com/file/d/0B7u_NzvpgGcgTDhoVFBsN3dMc0E/view?usp=sharing">rate sheet</a> that includes the following but not limited to:
<ul>
<li>Word rate for each of the interested locales as in new words, 100% match, fuzzy match for translation, review, proofreading.</li>
<li>Hourly rate: engineering, QA and testing, PM rate.</li>
<li>Minimum charge for a project and the thresholds by number of words per locale.</li>
<li>Rush rate, and its threshold.</li>
</ul>
</li>
</ul>
<h3 id="do-the-initial-paperwork"><a class="header" href="#do-the-initial-paperwork">Do the initial paperwork</a></h3>
<p>A series of activities need to happen before an l10n project can start. The first step is doing the paperwork to be able to receive quotes for projects and pay bills for requests.</p>
<p>Unless there are changes in the signed document, this step is done once, for the whole organization, and only at the beginning of relationship engagement.</p>
<ul>
<li>A master service agreement (or MSA) has to be signed between Mozilla and the vendor. The person signing on Mozilla side could be the PM or PM’s manager. This document shows the conditions that the contract is operated in between the service provider and Mozilla. Without this agreement, a service can’t start. Here is an example of <a href="https://drive.google.com/a/mozilla.com/file/d/0B7u_NzvpgGcgSW5Jend3TlpyRlE/view?usp=sharing">MSA</a>. Note that two separate MSA must be signed, one for Mozilla Corporation and another one for Mozilla Foundation.</li>
<li>An Account Payable (or AP) form has to be filled. It contains banking information, billing cycle (monthly, quarterly, or “as soon as”) and payment due terms (within 30 or 45 days), billing email address. Here is an example of <a href="https://drive.google.com/a/mozilla.com/file/d/0B7u_NzvpgGcgYmN6c0tJc2IwUzA/view?usp=sharing">AP form</a>.</li>
</ul>
<p>PO, or Purchase Order, may or may not be necessary in order to get vendor service. Some teams have ongoing need for l10n service and have a budget set aside annually. This is a good reason to have a PO established. For most projects that are one time need, or sporadic, it’s best to go without a PO, and bill to the serviced department as needed.</p>
<h3 id="set-up-accounts"><a class="header" href="#set-up-accounts">Set up accounts</a></h3>
<p>Depending on the needs and where the source file can be accessed, it’s good to have an account set up for the vendor’s project manager in the following places:</p>
<ul>
<li>Pontoon: set up a “translator” account when there is no community; or a basic “contributor” account when a community exists so that the vendor provides suggestions and the community can review them.</li>
<li>Bugzilla: so that the vendor’s project manager can interact in bugs. Bugzilla will allow us to have a central place to post project details and updates. Communication is generally handled via email with the vendor, but it’s useful to have a bug number to reference to, and the vendor can use the bug to quickly access all the details.</li>
<li>Google Drive: create a shared folder for the vendor to view, review, and translate directly spreadsheets or Google Docs.</li>
<li>GitHub: give commit permission if they need to commit directly in a repository (e.g. <a href="https://github.com/mozilla/legal-docs/">Legal docs</a>).</li>
</ul>
<p>Note: additional account setup may be needed if the project does not support our localization process (e.g. WordPress).</p>
<p>Once accounts are set up, allow the agency to explore the tools, flows and the product features to familiarize itself before actual work starts. Make sure to provide links to documentation as needed on how to use Pontoon and explain how to perform queries on Transvision. Setting up a meeting to share your screen might be a good idea, and use this opportunity to answer their questions about the project or the tools.</p>
<h2 id="localizing-a-project"><a class="header" href="#localizing-a-project">Localizing a project</a></h2>
<h3 id="planning-the-request"><a class="header" href="#planning-the-request">Planning the request</a></h3>
<p>Once outsourcing is a necessity for a project, before reaching out to the l10n agency to make an official request, make sure to check the following:</p>
<ul>
<li>Required locales.</li>
<li>Scope of work: is the request asking for anything other than translation, review and testing?</li>
<li>Milestones and Deadlines: negotiate it so the agency has sufficient time to finish each of the required tasks, and the community has enough time to review and sign off.</li>
<li>Check with communities if they want to fully handle the request, handle only some parts (e.g. initial translation or QA), or can’t work on it at all and let the agency do the work.</li>
</ul>
<h3 id="quotation"><a class="header" href="#quotation">Quotation</a></h3>
<p>Now that you have all the initial info you need, you are good to go ahead and reach out to the vendor and provide what they need to generate a quote. Get a quote from the agency by communicating volume, locales, deadline, level of service needed, and type of content.</p>
<h3 id="setting-everything-up-for-the-request"><a class="header" href="#setting-everything-up-for-the-request">Setting everything up for the request</a></h3>
<p>Now that you got a quote, you need to get it approved, send content to the vendor, and check permission.</p>
<ul>
<li>Provide a quote/estimate to the project requestor for approval.</li>
<li>For all the target locales, make sure both agency and the community have the proper access to the l10n tool or platform where the localizable content is staged and roles properly assigned per agreement.</li>
<li>Information to share with both the vendor and the community:
<ul>
<li>Scope: volume, type of content being localized, list of locales and type of service.</li>
<li>Plan: schedule with milestones.</li>
<li>Expectations: how you want the translations to be delivered (as a single batch or as each locale is ready), the file format you want the translations to be delivered into, and any additional service you would need, like following a specific test plan.</li>
</ul>
</li>
<li>Communicate the plan and the finalized schedule with the project stakeholders.</li>
<li>File a bug to track project progress. It can be a good idea to remind project specifics (repositories, deadline(s), locales…).</li>
</ul>
<h3 id="executing-the-request"><a class="header" href="#executing-the-request">Executing the request</a></h3>
<p>The initial quote has been approved, roles and permission are set accordingly to the request. You can now execute it, receive translations and deliver them to the project stakeholders.</p>
<ul>
<li>Share the content with the agency:
<ul>
<li>Strings (whether it’s text files, a link to Pontoon, a link to a repository, a spreadsheet, a Google Doc…).</li>
<li>Locale specific style guides and product specific term list.</li>
<li>Terminology: Ask them to always refer to <a href="https://transvision.mozfr.org/">Transvision</a> to check terminology.</li>
</ul>
</li>
<li>Confirm with the vendor the following: word count, schedule and cost of the service.</li>
<li>Run testing/QA once you’ve received the translations, either by the community or the vendor, depending on the project agreement.</li>
<li>Communicate with communities for a chance to review and sign off on the project before releasing to the internal customer.</li>
</ul>
<h3 id="post-mortem"><a class="header" href="#post-mortem">Post mortem</a></h3>
<p>After the project is delivered, you need to handle payment with the vendor and feedback with the community.
At the end of a calendar year, you would review the vendor working model and quality of paid service. You then provide feedback and evaluate if the service should be continued.</p>
<h4 id="steps-to-go-through-with-the-agency"><a class="header" href="#steps-to-go-through-with-the-agency">Steps to go through with the agency</a></h4>
<ul>
<li>Have the agency send an updated quote, in case there is a change of scope in the project.</li>
<li>PM reviews the quote and checks for discrepancies and then approves the quote.</li>
<li>The agency’s account payable contact sends invoice to mozilla@bill.com and accounting@mozilla.com.</li>
<li>In a few days, PM will be notified and asked to approve the invoice in bill.com system.</li>
<li>PM reviews the bill one more time, updates the Cost Center to the one corresponding the internal customer’s.</li>
</ul>
<h4 id="steps-to-go-through-with-the-community"><a class="header" href="#steps-to-go-through-with-the-community">Steps to go through with the community</a></h4>
<ul>
<li>PM should check with community periodically to gather input on translation quality if needed but it’s not necessary to do it every time. A necessary case could be if the community wants to replace the translator for their language because there are quality concerns.</li>
<li>Gather feedback in a spreadsheet, with summary in category of the type of issues reported, and detailed examples to support the summary.</li>
<li>Mozilla localizers give an overall quality rating and suggest to keep using the same translator(s) or ask for a replacement. The PM then shares the feedback with the agency for rebuttal and further feedback if needed.</li>
</ul>
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<dl>
  <dt>Account Manager</dt>
  <dd>Relationship, escalation of issues; handles complaints about quality or deadlines.</dd>
<dt>Project Manager</dt>
  <dd>Handles day-to-day operations. Coordinates resources on the agency side; provides estimate of a project’s deadline and cost.</dd>
<dt>Account Payable Manager</dt>
  <dd>Sends the bill to Mozilla Account Payable.</dd>
</dl>
<div style="break-before: page; page-break-before: always;"></div><h1 id="documentation-style-guide"><a class="header" href="#documentation-style-guide">Documentation style guide</a></h1>
<h2 id="general-rules"><a class="header" href="#general-rules">General rules</a></h2>
<p>These are some of the general rules to follow when writing and reviewing documentation for this repository:</p>
<ul>
<li>Address the reader as <strong>you</strong>, avoid using <strong>we</strong>.</li>
<li>Avoid using generic terms.</li>
<li>Avoid unnecessary empty lines in the document.</li>
</ul>
<h2 id="typography"><a class="header" href="#typography">Typography</a></h2>
<ul>
<li>Lists: each list item should start with an uppercase letter, and end with a period (only exception when the item ends with a URL). Use the <code>*</code> markdown notation for each item.</li>
<li>Use lowercase after colons, only one space after a period.</li>
<li>Use proper quotes, like <code>“example”</code>, instead of straight double quotes.</li>
<li>Use typographical apostrophes <code>’</code> instead of straight single quotes <code>'</code> (code fragments are the only exception).</li>
<li>Use backticks `, <strong>bold</strong>, or <em>italic</em> to highlight text in a sentence, not quotes.</li>
<li>Use <code>*</code> instead of <code>_</code> for bold and italic.</li>
<li>Try to use links instead of putting URLs directly in the text. For example, <code>visit [this page](http://example.com)</code> should be preferred to <code>visit http://example.com</code>.</li>
<li>Leave an empty line before and after code fragments, specify the language where possible. For example:</li>
</ul>
<pre>
This is some text.

```PHP
$test = 'test';
```

This is some other text.
</pre>
<h2 id="titles"><a class="header" href="#titles">Titles</a></h2>
<ul>
<li>Use the hash syntax, leave one space after the hash, e.g. <code># This is a title</code>.</li>
<li>Use sentence case, avoid title case.</li>
<li>Documents should always start with a 1st level title. There should be <strong>only one</strong> 1st level title across the document.</li>
<li>Leave an empty line before and after each title. The only exception is the 1st level title at the beginning of the page.</li>
<li>Make sure to follow a logic when using titles, e.g. a 3rd level title should be in a section starting with a 2nd level title of its own.</li>
</ul>
<p>This is an example of a good structure:</p>
<pre><code># This is the main title for this document

## This is a section

This is some text.

### This is a subsection

This is some text.

## This is another section

This is some more text.
</code></pre>
<h2 id="bullet-and-numbered-items"><a class="header" href="#bullet-and-numbered-items">Bullet and numbered items</a></h2>
<p>The first level has no indentation, and it’s completely aligned to the left. Sub levels should be indented using 4 spaces. Use <code>*</code> instead of <code>-</code> to create items. Example:</p>
<pre><code>* The first level bullet point
    * A second level bullet point
        * A third level bullet point
</code></pre>
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<p>There are three kind of links when cross referencing a document: within a document, within a project group, and outside a project group. The <code>[displayed text]</code> should be to the point and within a pair of square brackets. The displayed text must be followed by <code>(the link)</code> enclosed in a pair of parenthesis. Follow these formats for each case:</p>
<ul>
<li>Reference within the same document: link directly to the anchor, e.g. <code>[General rules](#general-rules)</code>. Note that GitHub automatically creates anchors for titles: if the title is <em>Title Example</em>, the anchor will be lowercase, with spaces replaced by dashes, i.e. <code>#title-example</code>.</li>
<li>Reference within a project group: use relative links, instead of absolute links (starting with <code>/</code>) or full GitHub URLs. For example, to link to a document in the parent folder, use <code>[other document](../other.md)</code>.</li>
<li>Reference outside the current repository: use the full GitHub URL, e.g. <code>[OpenDesign GitHub repository](https://github.com/mozilla/OpenDesign/tree/master/2017)</code>.</li>
</ul>
<h2 id="images"><a class="header" href="#images">Images</a></h2>
<p>When adding images to a repository, make sure that the size is not too big for the content displayed on GitHub. In case of PNG files, make also sure to optimize files through online services like <a href="https://tinypng.com/">TinyPNG</a>.</p>
<ul>
<li>Create a folder that maps to the main folder in which your documented is stored.</li>
<li>Naming convention: if only a couple of images are needed, make the file name easily identifiable, e.g.: product_feature_type.png.</li>
<li>File name must not contain spaces and uppercase, and must use underscore to separate words as needed.</li>
<li>Image size: keep it under 800px. If necessary, create two versions: a small one and a bigger one to open when clicked.</li>
<li>Image format: <code>![Encoding bug](../assets/images/l10n_testing/encoding_bug.png)</code>.</li>
<li>When images contain personal information, such as email addresses, try to blur it out.</li>
</ul>
<h2 id="tools"><a class="header" href="#tools">Tools</a></h2>
<p><a href="https://atom.io/">Atom</a> is the best tool for editing Markdown files:</p>
<ul>
<li>You can preview the content with <code>CTRL+SHIFT+M</code>. If you forget the shortcut, you can always use <code>CMD+SHIFT+P</code> to display the list of available commands, and search for <code>Markdown Preview: Toggle</code>.</li>
<li>You can install a package called <a href="https://atom.io/packages/smart-quotes-plus">smart-quotes-plus</a>, which lets you swap straight quotes with curly ones. Once the package is installed, press <code>CTRL+ALT+'</code> to swap quotes on the entire document, or the text currently selected. Again, you can use <code>CMD+SHIFT+P</code> and search for <code>Smart Quote Plus: Smartreplace</code>. Only make sure to not swap <code>&quot;</code> or <code>'</code> in code fragments where these characters are wanted.</li>
</ul>
<p>To install packages in Atom, open the Preferences, select the <em>Install</em> panel on the left and search for the package you’re interested in.</p>
<p><a href="https://github.com/DavidAnson/markdownlint">markdownlint</a>, a Markdown linter, is run on automation for each pull request. If you want to use this tool on your system, make sure to install <a href="https://nodejs.org/en/">Node.js</a>, then run the following commands from the root of your repository (only once):</p>
<pre><code class="language-BASH">$ git clone https://github.com/flodolo/l10ndocs-linter
$ npm --prefix ./l10ndocs-linter install ./l10ndocs-linter
</code></pre>
<p>At this point you can launch the linter with this command:</p>
<pre><code class="language-BASH">$ node l10ndocs-linter/linter/markdownlint.js
Using config file: /your_path/documentation/l10ndocs-linter/linter/markdownlint.json
Searching path: /your_path/documentation

There are no linter errors.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inquiries-about-joining-mozilla-l10n"><a class="header" href="#inquiries-about-joining-mozilla-l10n">Inquiries about joining Mozilla L10n</a></h1>
<p>Here you’ll find a stockpile of templated responses to inquiries we frequently receive about Mozilla L10n. They’ve been centralized here so that you can simply copy and paste them into emails. While there is value to having these stock responses for common inquiries, we strongly feel that there is equal value to making them as personalized as possible. Take time to adjust the template in your email to include personalized information.</p>
<h2 id="general-inquiry"><a class="header" href="#general-inquiry">General inquiry</a></h2>
<p>Hi [inquiree],</p>
<p>Thank you for your email and welcome to the Mozilla Community! We’re excited that you’re interested in joining our localization (L10n) effort.</p>
<p>Joining our L10n effort is easy. Within five easy steps you can start contributing to the project! We have a wiki page specially designed to help you get started. Please visit https://wiki.mozilla.org/L10n:Contribute and follow the five steps to get involved.</p>
<p>Could you also please provide me with some additional information about yourself, such as languages you speak, country you live in, and technical background?</p>
<p>You can also visit the following wiki pages to learn the details of how we localize:</p>
<ul>
<li><a href="https://wiki.mozilla.org/L10n:Localization_Process">L10n:Localization Process:</a> A good description of the whole process.</li>
</ul>
<p>Looking forward to hearing from you,</p>
<p>[name]</p>
<h2 id="follow-up-to-general-inquiry"><a class="header" href="#follow-up-to-general-inquiry">Follow up to general inquiry</a></h2>
<p>We’re very excited to have you join the Mozilla localization (l10n) effort! Your skills and dedication will be very valuable to your l10n team.</p>
<p>Next step, follow the steps outlined on https://wiki.mozilla.org/L10n:Contribute. When you contact your l10n team, please CC me on that email so that I can help to make sure you receive a prompt response.</p>
<p>If you have any questions or difficulties, please let me know.</p>
<p>Welcome!</p>
<h2 id="starting-a-new-localization"><a class="header" href="#starting-a-new-localization">Starting a new localization</a></h2>
<p>Thank you for your email and welcome to the Mozilla Community! We’re excited that you’re interested in joining our localization effort.</p>
<p>Since you have stated that you would like to start a new localization effort, will be your mentor and point of contact.</p>
<p>Here’s how you can get started:</p>
<ul>
<li>Check our list of existing <a href="https://pontoon.mozilla.org/teams">localization communities</a> to see if an effort for your language already exists. If an effort exists, contact the community to join the team and help drive the effort. If it doesn’t exist, introduce your new l10n community on the <a href="https://groups.google.com/group/mozilla.dev.l10n">Mozilla localization mailing list</a>.</li>
<li>Introduce yourself to the L10n community on the <a href="https://groups.google.com/group/mozilla.dev.l10n">Mozilla localization mailing list</a> by subscribing and posting an introduction. In your introduction, please add some brief information about yourself (e.g., professional background, interests, etc.) and what you hope to work on (e.g., &quot;I saw that there was a xx-XX community and I’d like to help them out.&quot;).</li>
<li>Visit [L10n process doc needed] to become familiar with how we localize.</li>
</ul>
<p>For general information on the Mozilla localization program, visit our [GitBook link]. You’re also welcome to read through and post to  <a href="https://groups.google.com/group/mozilla.dev.l10n/topics">the localization discussion newsgroup</a>.
Hope to see more from you soon!</p>
<h2 id="localizing-thunderbird"><a class="header" href="#localizing-thunderbird">Localizing Thunderbird</a></h2>
<p>We’re glad to see you’re interested in localizing Thunderbird. Please get in touch with <a href="mailto:mozilla@kewis.ch">the Thunderbird community</a> to learn how to contribute to localization.</p>
<h2 id="having-problems-with-pontoon"><a class="header" href="#having-problems-with-pontoon">Having problems with Pontoon</a></h2>
<p>Sorry to hear that you’re having problems with Pontoon. Please do the following to allow us to troubleshoot your problem(s):</p>
<ul>
<li>Search <a href="https://bugzilla.mozilla.org">Bugzilla</a> to see if a bug has already been filed for your problem(s).</li>
<li>Check the <a href="http://groups.google.com/group/mozilla.dev.l10n">l10n mailing list</a> to see if anyone else has had the same problem.</li>
<li>If you can’t find a discussion thread about your problem, begin a discussion topic in those newsgroups asking for help. Include as much detail as possible.</li>
<li>If no one in the discussion group can offer a solution and there are no bugs currently filed, <a href="https://mzl.la/2tp26Ag">file a new bug</a> providing as many details about the problem as possible.</li>
</ul>
<p>If the first three steps don’t solve your problem and you have to file a bug, rest assured that the l10n-drivers will respond promptly.</p>
<h2 id="having-problems-with-mercurial-hg"><a class="header" href="#having-problems-with-mercurial-hg">Having problems with Mercurial (hg)</a></h2>
<p>Sorry to hear that you’re having problems with hg. Please do the following to allow us to troubleshoot your problem(s):</p>
<ul>
<li>Search <a href="https://bugzilla.mozilla.org">Bugzilla</a> to see if a bug has already been filed for your problem(s).</li>
<li>Check the <a href="http://groups.google.com/group/mozilla.dev.l10n">l10n mailing list</a> to see if anyone else has had the same problem.</li>
<li>If you can’t find a discussion thread about your problem, begin a discussion topic in those newsgroups asking for help. Include as much detail as possible.</li>
<li>If no one in the discussion group can offer a solution and there are no bugs currently filed, file a new bug providing as many details about the  problem as possible.</li>
</ul>
<p>If the first three steps don’t solve your problem and you have to file a bug, rest assured that the l10n-drivers will respond promptly.</p>
<h2 id="update-your-team-wiki-page"><a class="header" href="#update-your-team-wiki-page">Update your team wiki page</a></h2>
<p>Subject: [locale code]Please update [locale name] wiki page</p>
<p>I’m writing you to verify that your L10n team’s information on your wiki page (https://wiki.mozilla.org/L10n:Teams:[your-locale-here]) is up-to-date and accurate. Please take a look at your page and update it as needed.</p>
<p>Please follow the format outlined in <a href="https://wiki.mozilla.org/Template:L10n:Teams">this wiki template</a>.</p>
<p>If you have any questions, please feel free to contact me.</p>
<p>Thank you for your help!</p>
<h2 id="translationl10n-vendor-sales-pitches"><a class="header" href="#translationl10n-vendor-sales-pitches">Translation/l10n vendor sales pitches</a></h2>
<p>It is a pleasure to meet you.</p>
<p>Mozilla is a non-profit, open source project. As such, all of our work, from development to marketing to localization, is performed by a dedicated, global community of volunteers. Our community is so thorough that it is very rare that we use vendors for translation, but when we do, we have a set of qualified vendors we rely on.</p>
<p>Of course, if you are interested in discussing a form of collaboration that fits with our volunteer, open source framework, I would be happy to arrange a meeting.</p>
<p>Thank you for your interest.</p>
<h2 id="responses-to-add"><a class="header" href="#responses-to-add">Responses to add</a></h2>
<ul>
<li>Cold Call Inquiry: Would you to contribute to XX localization?</li>
<li>Reactivation: Are you still interested in contributing to L10n? Here’s where we need your help.</li>
<li>Assigning first tasks based on user profiles/interests</li>
<li>Phasing out a locale</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exporting-terminology"><a class="header" href="#exporting-terminology">Exporting terminology</a></h1>
<p>When new terminology is added to Pontoon, we may want to ensure that those latest terms are added to our vendor platform Smartling. The <a href="https://github.com/mozilla-l10n/terminology_management/tree/main/scripts/tbx_merge">TBX Merge tool</a> can be used to export all terminology for a defined set of locales and merged into a single .tbx file for import into Smartling.</p>
<h2 id="tbx-merge-tool-documentation"><a class="header" href="#tbx-merge-tool-documentation">TBX Merge tool documentation</a></h2>
<p>The tbx_merge tool exports, merges, and prepares terminology for import into Smartling via a tbx (v2) file.</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<p>To run the script you will need the following:</p>
<ul>
<li>Python (tested working on version 3.10)</li>
<li>requests module</li>
<li>List of locales you wish to extract from Pontoon (see &quot;locales.txt&quot; for example)</li>
</ul>
<p><em><strong>If importing terms into an existing glossary on Smartling</strong></em></p>
<ul>
<li>A tbx format glossary export from Smartling</li>
</ul>
<h2 id="syntax"><a class="header" href="#syntax">Syntax</a></h2>
<p>Call tbx_merge.py from your command line, with the following arguments:</p>
<p>--locales <em>filepath</em><br />
(<em><strong>Required</strong></em>) Designate the filepath of a .txt file that contains the list of Pontoon locale codes (separated by newline) you would like to extract from Pontoon and merge.</p>
<p>--id-format (<em>smartling, new, pontoon</em>)<br />
Select from one of three strategies for dealing with termEntry IDs.</p>
<p><em>smartling</em>: This will apply the UID Smartling uses to manage glossary terms to any Pontoon terms that match. Any terms not in Smartling will have their Pontoon ID removed for import into Smartling as a new term. This requires a tbx file exported from Smartling to match and assign IDs. The file will need to be identified by the separate argument --smartling.
<strong>Note:</strong> This script uses the term and definition to match between Pontoon and Smartling. Any manual changes made to either a term or definition in either Pontoon or Smartling will cause the script to flag it as a new term.<br />
Outputs: smartling_merge_glossary.tbx</p>
<p><em>new</em>: This will remove all Pontoon IDs for all termEntry elements, causing all terminology to be treated as a new term upon import into Smartling. Typically this would be used if creating a new glossary from scratch.<br />
Outputs: smartling_new_glossary.tbx</p>
<p><em>pontoon</em>: This will preserve all Pontoon IDs. Smartling will not be able to import the resulting file as Smartling requires the UIDs to be assigned by its platform.<br />
Outputs: pontoon_glossary_multilingual.tbx</p>
<p>--smartling <em>filepath</em><br />
(<em><strong>Required if --id-format smartling argument selected</strong></em>) Designate the filepath of a .tbx file exported from Smartling.</p>
<h2 id="importing-terminology-into-smartling"><a class="header" href="#importing-terminology-into-smartling">Importing terminology into Smartling</a></h2>
<p>Terminology is managed in within Linguistic Assets section of Account Settings. After logging in select <code>Account Settings</code> &gt; <code>Linguistic Assets</code>, from there on the left hand menu select <code>Glossaries</code>.</p>
<p>From there select a glossary you would like to update, or create a new one, then import terminology by selecting <code>...</code> &gt; <code>Import Glossary</code>.</p>
<h3 id="importing-into-a-new-glossary"><a class="header" href="#importing-into-a-new-glossary">Importing into a new glossary</a></h3>
<p>Use the following steps to import into a new glossary (or a glossary that does not contain any registered terms).</p>
<ol>
<li>Create a locales.txt file with your desired locales separated on newlines, saved to <em>path</em>.</li>
<li>Run tbx_merge from the commandline (ensure you have the requests module installed):</li>
</ol>
<pre><code>$ python tbx_merge.py --locales path/locales.txt --id-format new
</code></pre>
<ol start="3">
<li>Within Smartling, select the glossary you wish to import terms into and choose <code>...</code> &gt; <code>Import Glossary</code>.</li>
<li>Choose the file exported by tbx_merge. In this case it will be named: <code>smartling_new_glossary.tbx</code></li>
<li>Smartling will display which languages and the number of terms that will be updated. Click <code>Import</code> to finish the import.<br />
<strong>Note</strong>: Even the Smartling shows all languages in the import file on import, only terms from languages specified in Current Glossary Languages will actually be imported. You can add more languages to the glossary in Smartling by choosing <code>...</code> &gt; <code>Add Language</code>.</li>
</ol>
<h3 id="updating-an-existing-glossary"><a class="header" href="#updating-an-existing-glossary">Updating an existing glossary</a></h3>
<p>The steps are mostly the same, as before, but you will need to first export the target glossary from Smartling as a tbx file.</p>
<ol>
<li>Within Smartling, select the glossary you wish to import terms into and choose <code>...</code> &gt; <code>Export Glossary</code>. For Download File Type choose <code>TBX V2 Core</code> and from the Languages dropdown select <code>Select displayed results (n)</code> to choose all target languages in the glossary. Save <em>glossary</em> file to <em>path</em>. Note: You must always include the source &quot;en-US&quot; locale when exporting from Smartling.</li>
<li>Create a locales.txt file with your desired locales separated on newlines, saved to <em>path</em>.</li>
<li>Run tbx_merge from the commandline (ensure you have the requests module installed):</li>
</ol>
<pre><code>$ python tbx_merge.py --locales path/locales.txt --id-format smartling --smartling path/glossary.tbx
</code></pre>
<ol start="4">
<li>Within Smartling, select the glossary you wish to import terms into and choose <code>...</code> &gt; <code>Import Glossary</code>.</li>
<li>Choose the file exported by tbx_merge. In this case it will be named: <code>smartling_merge_glossary.tbx</code></li>
<li>Smartling will display which languages and the number of terms that will be updated. Click <code>Import</code> to finish the import.<br />
<strong>Note</strong>: Even the Smartling shows all languages in the import file on import, only terms from languages specified in Current Glossary Languages will actually be imported. You can add more languages to the glossary in Smartling by choosing <code>...</code> &gt; <code>Add Language</code>.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>

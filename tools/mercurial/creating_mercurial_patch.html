<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Create a patch - Localization at Mozilla - Internal Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../products/android-l10n/index.html"><strong aria-hidden="true">2.</strong> Android-l10n</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../products/android-l10n/adding_projects.html"><strong aria-hidden="true">2.1.</strong> Adding projects</a></li><li class="chapter-item expanded "><a href="../../products/android-l10n/updating_locales.html"><strong aria-hidden="true">2.2.</strong> Updating locales</a></li><li class="chapter-item expanded "><a href="../../products/android-l10n/review_android_strings.html"><strong aria-hidden="true">2.3.</strong> Reviewing new strings</a></li><li class="chapter-item expanded "><a href="../../products/android-l10n/removing_projects.html"><strong aria-hidden="true">2.4.</strong> Removing projects</a></li></ol></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/index.html"><strong aria-hidden="true">3.</strong> Firefox Desktop</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../products/firefox_desktop/adding_pontoon.html"><strong aria-hidden="true">3.1.</strong> Add to Pontoon</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/adding_nightly.html"><strong aria-hidden="true">3.2.</strong> Nightly builds</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/adding_release.html"><strong aria-hidden="true">3.3.</strong> Beta/Release builds</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/setup_searchplugins.html"><strong aria-hidden="true">3.4.</strong> Searchplugins</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/removing_locales.html"><strong aria-hidden="true">3.5.</strong> Removing locales</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/review.html"><strong aria-hidden="true">3.6.</strong> Review strings</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/fluent_migrations.html"><strong aria-hidden="true">3.7.</strong> Fluent migrations</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/build_system.html"><strong aria-hidden="true">3.8.</strong> Build system</a></li><li class="chapter-item expanded "><a href="../../products/firefox_desktop/firefox_l10n_faqs.html"><strong aria-hidden="true">3.9.</strong> L10N FAQs</a></li></ol></li><li class="chapter-item expanded "><a href="../../localization/index.html"><strong aria-hidden="true">4.</strong> Localization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../localization/making_string_changes.html"><strong aria-hidden="true">4.1.</strong> Change existing strings</a></li><li class="chapter-item expanded "><a href="../../localization/dev_best_practices.html"><strong aria-hidden="true">4.2.</strong> Best practices for developers</a></li><li class="chapter-item expanded "><a href="../../localization/globalization_best_practices.html"><strong aria-hidden="true">4.3.</strong> Globalization best practices for product managers</a></li></ol></li><li class="chapter-item expanded "><a href="../../products/iOS_products/index.html"><strong aria-hidden="true">5.</strong> iOS Products</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../products/iOS_products/updating_locales.html"><strong aria-hidden="true">5.1.</strong> Updating locales</a></li><li class="chapter-item expanded "><a href="../../products/iOS_products/review_iOSstrings.html"><strong aria-hidden="true">5.2.</strong> Reviewing new strings</a></li></ol></li><li class="chapter-item expanded "><a href="../../products/other/index.html"><strong aria-hidden="true">6.</strong> Other Projects</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/index.html"><strong aria-hidden="true">7.</strong> Pontoon</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tools/pontoon/adding_new_project.html"><strong aria-hidden="true">7.1.</strong> New project</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/renaming_a_project.html"><strong aria-hidden="true">7.2.</strong> Renaming a project</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/adding_new_short_term_project.html"><strong aria-hidden="true">7.3.</strong> New short-term project</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/adding_new_locale.html"><strong aria-hidden="true">7.4.</strong> New locale</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/managing_pretranslation.html"><strong aria-hidden="true">7.5.</strong> Pretranslation</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/sending_notifications.html"><strong aria-hidden="true">7.6.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/renaming_a_file.html"><strong aria-hidden="true">7.7.</strong> Renaming a localization file</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/deactivating_users.html"><strong aria-hidden="true">7.8.</strong> Deactivating users</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/removing_users.html"><strong aria-hidden="true">7.9.</strong> Removing users</a></li><li class="chapter-item expanded "><a href="../../tools/pontoon/adding_new_terminology.html"><strong aria-hidden="true">7.10.</strong> New terminology</a></li></ol></li><li class="chapter-item expanded "><a href="../../tools/mercurial/index.html"><strong aria-hidden="true">8.</strong> Mercurial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tools/mercurial/setting_mercurial_environment.html"><strong aria-hidden="true">8.1.</strong> Set up the environment</a></li><li class="chapter-item expanded "><a href="../../tools/mercurial/creating_mercurial_patch.html" class="active"><strong aria-hidden="true">8.2.</strong> Create a patch</a></li><li class="chapter-item expanded "><a href="../../tools/mercurial/useful_mercurial_commands.html"><strong aria-hidden="true">8.3.</strong> Useful Mercurial commands</a></li></ol></li><li class="chapter-item expanded "><a href="../../misc/index.html"><strong aria-hidden="true">9.</strong> Other docs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../misc/creating_new_repository.html"><strong aria-hidden="true">9.1.</strong> New l10n repository</a></li><li class="chapter-item expanded "><a href="../../misc/working_w_l10n_agency.html"><strong aria-hidden="true">9.2.</strong> How to work with a Localization Agency</a></li><li class="chapter-item expanded "><a href="../../misc/documentation_styleguide.html"><strong aria-hidden="true">9.3.</strong> Documentation styleguide</a></li><li class="chapter-item expanded "><a href="../../misc/stock_emails.html"><strong aria-hidden="true">9.4.</strong> Stock emails</a></li><li class="chapter-item expanded "><a href="../../misc/terminology_export.html"><strong aria-hidden="true">9.5.</strong> Exporting terminology</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Localization at Mozilla - Internal Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/mozilla-l10n/documentation/edit/main/src/tools/mercurial/creating_mercurial_patch.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="create-a-patch-in-mercurial"><a class="header" href="#create-a-patch-in-mercurial">Create a patch in Mercurial</a></h1>
<ul>
<li><a href="#creating-a-patch-using-phabricator">Creating a patch using Phabricator</a>
<ul>
<li><a href="#creating-a-patch">Creating a patch</a></li>
<li><a href="#updating-an-existing-patch">Updating an existing patch</a>
<ul>
<li><a href="#amend-the-last-commit">Amend the last commit</a></li>
<li><a href="#create-a-new-commit-and-squash-history">Create a new commit and squash history</a></li>
</ul>
</li>
<li><a href="#landing-the-patch">Landing the patch</a></li>
</ul>
</li>
<li><a href="#creating-a-patch-using-queues">Creating a patch using Queues</a>
<ul>
<li><a href="#creating-a-patch-1">Creating a patch</a></li>
<li><a href="#updating-an-existing-patch-1">Updating an existing patch</a></li>
<li><a href="#landing-the-patch-1">Landing the patch</a></li>
</ul>
</li>
</ul>
<p>There are currently two different methods available to create a patch for Mercurial repositories:</p>
<ul>
<li><a href="#creating-a-patch-using-phabricator">Using <strong>Phabricator</strong></a>.</li>
<li><a href="#creating-a-patch-using-queues">Using <strong>Mercurial Queues</strong></a> (<code>mq</code> extension).</li>
</ul>
<p>Phabricator is the preferred method for patches to main code repositories, like <code>mozilla-central</code>. On the other hand, Queues is the only tool available for patches to l10n repositories.</p>
<p>As a general rule, before creating a patch, make sure that your environment is <a href="../../tools/mercurial/setting_mercurial_environment.html">correctly set up</a>, and update your local clones.</p>
<h2 id="creating-a-patch-using-phabricator"><a class="header" href="#creating-a-patch-using-phabricator">Creating a patch using Phabricator</a></h2>
<h3 id="creating-a-patch"><a class="header" href="#creating-a-patch">Creating a patch</a></h3>
<p>Consider the following example: setting up productization for Urdu (ur) on Firefox desktop. After you’ve created or edited all the files you need, check the status of the repository.</p>
<pre><code class="language-BASH">$ hg status
M browser/locales/search/list.json
? browser/locales/searchplugins/amazon-in.xml
? browser/locales/searchplugins/wikipedia-ur.xml
</code></pre>
<p>These are all status codes relevant for working with patches:</p>
<ul>
<li>M = modified. File was already tracked but has been modified.</li>
<li>A = added. File is new and was already added with <code>hg add</code>.</li>
<li>R = removed. File has been removed with <code>hg remove</code>.</li>
<li>! = missing. File has been removed from the filesystem but it’s still tracked. Use <code>hg remove</code> to stop tracking it.</li>
<li>? = not tracked. File is not tracked yet. You can start tracking it by using <code>hg add</code>.</li>
</ul>
<p>Note that the file status will change once you commit, <code>hg status</code> only shows information about pending changes.</p>
<p>Now you need to add the new files. You can add them using the full path, or a parent folder, just make sure you’re not adding unnecessary files.</p>
<pre><code class="language-BASH">$ hg add browser/locales/searchplugins
$ hg status
M browser/locales/search/list.json
A browser/locales/searchplugins/amazon-in.xml
A browser/locales/searchplugins/wikipedia-ur.xml
</code></pre>
<p>Let’s create a bookmark for this pending work, for example <code>bug1304757</code>.</p>
<pre><code class="language-BASH">$ hg bookmark bug1304757
</code></pre>
<p>Commit the changes. In the commit message:</p>
<ul>
<li>Don’t forget to start with the bug number, i.e. <code>Bug XXXXXX -</code></li>
<li>At the end of the commit message, add the reviewer with the format <code>r=phab_user</code>. <code>phab_user</code> is the reviewer’s username on Phabricator, e.g. <code>flod</code>. You can add an exclamation mark at the end to set it as blocking reviewer, i.e. <code>r=phab_user!</code>.</li>
</ul>
<pre><code class="language-BASH">$ hg commit -m &quot;Bug 1304757 - [ur] Search engine setup for Firefox for Urdu, r=flod!&quot;
</code></pre>
<p>At this point you can check the status of the tree:</p>
<pre><code class="language-BASH">$ hg wip
</code></pre>
<p>And you should be able to identify your work and bookmark (press <code>q</code> to leave this view):</p>
<pre><code>@   358728:c0b04112d4e6 flod tip  bug1304757
|  Bug 1304757 - [ur] Search engine setup for Firefox for Urdu, r?flod
| o   358726:f7834b7b4050 aosmond  inbound
|/:  Bug 1299498 - Keep a main thread only pointer to the underlying nsIURI for ImageURL. r=tnikkel
| : o   358715:6f79cece26e9 ffxbld  beta
| : |  No bug, Automated blocklist update from host bld-linux64-spot-245 - a=blocklist-update
| : ~
| : o   358714:f5f73390f439 ffxbld  release
| : |  No bug, Automated blocklist update from host bld-linux64-spot-246 - a=blocklist-update
| : ~
o :   358709:f8107cf96144 cbook  central
:/   merge mozilla-inbound to mozilla-central a=merge
</code></pre>
<p>To push to Phabricator use:</p>
<pre><code>$ moz-phab
</code></pre>
<p>You can add <code>-s</code> to only push a single commit, i.e. <code>moz-phab -s</code>.</p>
<p>Once published, the review request will be attached automatically to the bug, and the reviewer will be flagged. Note that you can also update information about the patch, like reviewer or bug, directly in Phrabricator after pushing with MozPhab.</p>
<h3 id="updating-an-existing-patch"><a class="header" href="#updating-an-existing-patch">Updating an existing patch</a></h3>
<p>If you need to address review comments, you can restore your branch by switching to your bookmark, and start working on it again.</p>
<pre><code class="language-BASH">$ hg up bug1304757
</code></pre>
<p>You can check which bookmark is currently active with <code>hg bookmarks</code>:</p>
<pre><code class="language-BASH">$ hg bookmarks
   aurora                    359014:96503957841c
   beta                      359025:34c73c520f93
 * bug1304757                359034:bde380bc54ff
   central                   358999:a69583d2dbc6
</code></pre>
<p>After addressing the review comments and editing your local files, you have two choices to save your work:</p>
<ul>
<li>Amend the last commit.</li>
<li>Create a new commit and squash history.</li>
</ul>
<h4 id="amend-the-last-commit"><a class="header" href="#amend-the-last-commit">Amend the last commit</a></h4>
<p>To amend the last commit, simply execute:</p>
<pre><code class="language-BASH">$ hg commit --amend
</code></pre>
<p>Then confirm (or edit) the commit message by saving with <code>CTRL+O</code> and exiting with <code>CTRL+X</code> (assuming the default editor is nano). Finally, update Phabricator (don’t make changes to the metadata in the commit):</p>
<pre><code class="language-BASH">$ moz-phab
</code></pre>
<h4 id="create-a-new-commit-and-squash-history"><a class="header" href="#create-a-new-commit-and-squash-history">Create a new commit and squash history</a></h4>
<p>If you prefer to have a separate commit, execute:</p>
<pre><code class="language-BASH">$ hg commit -m &quot;Address review comments&quot;
</code></pre>
<p>Then squash the commits together by editing history:</p>
<pre><code class="language-BASH">$ hg histedit
</code></pre>
<p>The following screen will look like this:</p>
<pre><code>pick f6f70f6de69c 358597 Bug 123456 - [ur] Search engine setup for Firefox fo...
pick 8088fd8658fd 358598 Fix searchplugin name

# Edit history between f6f70f6de69c and 8088fd8658fd
#
# Commits are listed from least to most recent
#
# You can reorder changesets by reordering the lines
#
# Commands:
#
#  e, edit = use commit, but stop for amending
#  m, mess = edit commit message without changing commit content
#  p, pick = use commit
#  d, drop = remove commit from history
#  f, fold = use commit, but combine it with the one above
#  r, roll = like fold, but discard this commit's description
#
</code></pre>
<p>In this case you want to <em>roll</em> the second commit into the first one, so replace <code>pick</code> with <code>roll</code> (or <code>r</code>), save with <code>CTRL+O</code> and exit with <code>CTRL+X</code> (assuming the default editor is nano).</p>
<pre><code>pick f6f70f6de69c 358597 Bug 123456 - [ur] Search engine setup for Firefox fo...
roll 8088fd8658fd 358598 Fix searchplugin name

...
</code></pre>
<p>Update Phabricator (you will need to provide a commit message):</p>
<pre><code class="language-BASH">$ moz-phab
</code></pre>
<p>You can also use <code>hg histedit</code> to reword a commit message (set the commit line to <code>edit</code>). Just remember to complete the <code>histedit</code> after commit.</p>
<pre><code class="language-BASH">$ hg commit -m &quot;Some changes&quot;
$ hg histedit --continue
</code></pre>
<p>If necessary, you can rebase against another bookmark, like <code>central</code> or <code>inbound</code></p>
<pre><code class="language-BASH">$ hg rebase -d central
</code></pre>
<p>More information about this workflow are available in the following pages:</p>
<ul>
<li>https://mozilla-version-control-tools.readthedocs.io/en/latest/hgmozilla/firefoxworkflow.html</li>
<li>https://www.mercurial-scm.org/wiki/Bookmarks</li>
</ul>
<h3 id="landing-the-patch"><a class="header" href="#landing-the-patch">Landing the patch</a></h3>
<p>Once the patch has been reviewed, you have two options:</p>
<ul>
<li>If you have L3 access to the repository, you can use <a href="https://moz-conduit.readthedocs.io/en/latest/lando-user.html">Lando</a> to land your commit directly. If your reviewer has it, you can ask them to land.</li>
</ul>
<h2 id="creating-a-patch-using-queues"><a class="header" href="#creating-a-patch-using-queues">Creating a patch using Queues</a></h2>
<h3 id="creating-a-patch-1"><a class="header" href="#creating-a-patch-1">Creating a patch</a></h3>
<p>Consider the following example: setting up productization for Urdu (ur) on Firefox desktop (l10n repository). The first step is to create a <code>region.properties</code> file. Move into the repository folder and check its status:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg status
? browser/chrome/browser-region/region.properties
</code></pre>
<p>File is brand new and needs to be added:</p>
<pre><code class="language-BASH">$ hg add browser

$ hg status
A browser/chrome/browser-region/region.properties
</code></pre>
<p>You need to assign a name to this patch, it’s easy to use a reference to the bug number: for example, if the bug number is 123456, the file could be called <code>bug123456.patch</code> (note the added extension <code>.patch</code>).</p>
<pre><code class="language-BASH">$ hg qnew bug123456.patch
</code></pre>
<p>At this point you will be asked to provide a commit message for your patch (in <code>nano</code> if you followed the instructions to set up the environment): write your commit message, then press <code>CTRL+O</code> to save the file, <code>enter</code> to confirm the proposed filename, and finally <code>CTRL+X</code> to exit the editor.</p>
<p>The commit message should be the same as the bug, for example <code>Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox desktop</code>.</p>
<p>You are ready to <em>pop</em> the patch out of the queue. Since it’s likely that there are no other patches, you can pop them all with <code>-a</code>.</p>
<pre><code class="language-BASH">$ hg qpop -a
popping bug123456.patch
patch queue now empty
</code></pre>
<p>The patch is stored inside the <code>.hg/patches</code> folder in the root of the repository (in the suggested setup, the full path would be <code>~/mozilla/mercurial/l10n-central/.hg/patches</code>). You can copy the file through the command line or the file explorer. For example, on macOS you can open the folder in Finder by typing:</p>
<pre><code class="language-BASH">$ open ~/mozilla/mercurial/l10n/ur/l10n-central/.hg/patches
</code></pre>
<p>Or you can copy the file on the Desktop with</p>
<pre><code class="language-BASH">$ cp ~/mozilla/mercurial/l10n/ur/l10n-central/.hg/patches/bug123456.patch ~/Desktop
</code></pre>
<p>Now you need to attach the file to Bugzilla and set an appropriate reviewer for it.</p>
<h3 id="updating-an-existing-patch-1"><a class="header" href="#updating-an-existing-patch-1">Updating an existing patch</a></h3>
<p>Let’s assume that the review found some issues with the patch and you need to update it. The fastest way is to import the .patch file without committing, update the files as needed, and create a new patch using the same process explained above.</p>
<p>Assuming the file is called <code>bug123456.patch</code> and it’s in your desktop, you can move in the repository folder and import the file like this:</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg import --no-commit ~/Desktop/bug123456.patch
</code></pre>
<p>Don’t forget the <code>--no-commit</code> part. If you do, the patch will be added to your repository and you’ll need to clone the original repository again.</p>
<!-- markdownlint-disable MD038 -->
<p><strong>Note:</strong> You can drag and drop the patch file on the terminal on macOS to get its full path instead of typing it. In other words, type <code>hg import --no-commit </code> (leave an empty space at the end), then drag the icon of the patch on the Terminal’s window: its full path will appear automatically.</p>
<!-- markdownlint-enable MD038 -->
<p>At this point you’re ready to modify the files, and create a new patch. The only difference is that you will need to use a different filename, for example <code>bug123456v1.patch</code>.</p>
<h3 id="landing-the-patch-1"><a class="header" href="#landing-the-patch-1">Landing the patch</a></h3>
<p>Your patch got a <code>r+</code>, so you need to update the commit message to reference the review, import the patch and push it to the remote server.</p>
<p><strong>Note:</strong> If the patch is for a repository where you don’t have write access, you don’t need to follow these instructions, only to set the <code>checkin-needed</code> flag in Bugzilla.</p>
<p>Open the .patch file in your editor, find the line with the commit message, and add <code>r=NICKNAME</code> to the commit message. For example, the last line in</p>
<pre><code># HG changeset patch
# User SOMENAME &lt;SOME EMAIL&gt;
# Parent  b45d23bc53df9227aa262acb2a5c6b0ab903b76e
Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox for Android
</code></pre>
<p>Should become like this, assuming flod is the reviewer.</p>
<pre><code>Bug 123456 - Set up searchplugins for &quot;ur&quot; and Firefox for Android, r=flod
</code></pre>
<p>Then you need to import the patch, this time without the <code>no-commit</code> parameter.</p>
<pre><code class="language-BASH">$ cd ~/mozilla/mercurial/l10n/ur/l10n-central

$ hg import ~/Desktop/bug123456.patch
</code></pre>
<p>The patch has been imported and committed. If you get an error while applying the patch, check if the editor you’re using hasn’t modified other lines of the patch, for example removing trailing whitespaces. In that case, using <code>nano</code> to edit the patch is probably your faster option.</p>
<p>Now you’re ready to push to the remote repository</p>
<pre><code class="language-BASH">$ hg push
</code></pre>
<p>The reply from the server will contain the URL to your changeset: copy and paste that URL in the bug. If the bug only contains a patch to region.properties, you can close the bug after landing; if it also contains a patch stored in MozReview, the bug will be automatically closed when the patch is merged to mozilla-central.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../tools/mercurial/setting_mercurial_environment.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../tools/mercurial/useful_mercurial_commands.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../tools/mercurial/setting_mercurial_environment.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../tools/mercurial/useful_mercurial_commands.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
